<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Albumentations provides a comprehensive, high-performance framework for augmenting images to improve machine learning models. Ideal for computer vision applications, supporting a wide range of augmentations."><link href=https://albumentations.ai/docs/api_reference/augmentations/geometric/rotate/ rel=canonical><link href=../resize/ rel=prev><link href=../transforms/ rel=next><link rel=icon href=../../../../images/logo.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.3"><title>Rotation transforms (augmentations.geometric.functional) - Albumentations Documentation</title><link rel=stylesheet href=../../../../assets/stylesheets/main.d7758b05.min.css><link rel=stylesheet href=../../../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../../assets/_mkdocstrings.css><link rel=stylesheet href=../../../../css/extra.css><script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-DCXRDR9HJ0"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-DCXRDR9HJ0",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-DCXRDR9HJ0",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script><meta charset=utf-8><meta name=viewport content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta property=og:title content="Albumentations Documentation - Rotation transforms (augmentations.geometric.functional)"><meta property=og:description content="Albumentations provides a comprehensive, high-performance framework for augmenting images to improve machine learning models. Ideal for computer vision applications, supporting a wide range of augmentations."><meta property=og:image content=https://albumentations.ai/docs/images/albumentations_card.png><meta property=og:image:type content=image/png><meta property=og:type content=website><meta content=https://albumentations.ai/docs/api_reference/augmentations/geometric/rotate/ property=og:url><meta name=twitter:card content=summary_large_image><meta name=twitter:site content=@albumentations><meta name=twitter:creator content=@viglovikov><meta name=twitter:title content="Albumentations Documentation - Rotation transforms (augmentations.geometric.functional)"><meta name=twitter:description content="Albumentations provides a comprehensive, high-performance framework for augmenting images to improve machine learning models. Ideal for computer vision applications, supporting a wide range of augmentations."><meta name=twitter:image content=https://albumentations.ai/docs/images/albumentations_card.png><meta name=description content="Albumentations provides a comprehensive, high-performance framework for augmenting images to improve machine learning models. Ideal for computer vision applications, supporting a wide range of augmentations."><meta name=keywords content="Albumentations, image augmentation, machine learning, computer vision, data augmentation, image processing, deep learning, AI, artificial intelligence, Python"></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=white> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#rotation-transforms-augmentationsgeometricfunctional class=md-skip> Skip to content </a> </div> <div data-md-component=announce> <aside class=md-banner> <div class="md-banner__inner md-grid md-typeset"> <div class=announce-wrapper> <div id=announce-left> <div class=item> <a class=announce-link target=_blank href=https://github.com/sponsors/albumentations-team> <span class="twemoji twitter"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </span> You can now sponsor <strong>Albumentations</strong> </a> </div> <div class=item> <a class=announce-link href=https://twitter.com/albumentations target=_blank> <span class="twemoji twitter"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253"/></svg> </span> Follow <strong>@albumentations</strong> on <strong>Twitter</strong> to stay updated </a> </div> <div class=item> <a class=announce-link href=https://www.linkedin.com/company/100504475 target=_blank> <span class="twemoji linkedin"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg> </span> Follow <strong>@albumentations</strong> on <strong>LinkedIn</strong> to stay updated </a> </div> </div> </div> </div> </aside> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=header.title> <a href=../../../.. title="Albumentations Documentation" class="md-header__button md-logo" aria-label="Albumentations Documentation" data-md-component=logo> <img src=../../../../images/logo.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> </div> <div class=md-header-nav__title> <div class=header-menu-item> <a href=https://albumentations.ai>Home</a> </div> <div class="header-menu-item header-menu-item-selected"> <a href=https://albumentations.ai/docs/ >Documentation</a> </div> <div class="header-menu-item header-large-menu-item"> <a href=https://explore.albumentations.ai target=_blank>Explore</a> </div> <div class="header-menu-item header-large-menu-item"> <a href=https://albumentations.ai/people>People</a> </div> </div> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/albumentations-team/albumentations title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> albumentations </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--integrated" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../../.. title="Albumentations Documentation" class="md-nav__button md-logo" aria-label="Albumentations Documentation" data-md-component=logo> <img src=../../../../images/logo.png alt=logo> </a> Albumentations Documentation </label> <div class=md-nav__source> <a href=https://github.com/albumentations-team/albumentations title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> albumentations </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../.. class=md-nav__link> <span class=md-ellipsis> Documentation </span> </a> </li> <li class=md-nav__item> <a href=../../../../benchmarking_results/ class=md-nav__link> <span class=md-ellipsis> Benchmarking Results </span> </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex> <span class=md-ellipsis> Introduction </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Introduction </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../introduction/image_augmentation/ class=md-nav__link> <span class=md-ellipsis> What is image augmentation </span> </a> </li> <li class=md-nav__item> <a href=../../../../introduction/why_you_need_a_dedicated_library_for_image_augmentation/ class=md-nav__link> <span class=md-ellipsis> Why you need a dedicated library </span> </a> </li> <li class=md-nav__item> <a href=../../../../introduction/why_albumentations/ class=md-nav__link> <span class=md-ellipsis> Why Albumentations </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex> <span class=md-ellipsis> Getting started </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Getting started </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../getting_started/installation/ class=md-nav__link> <span class=md-ellipsis> Installation </span> </a> </li> <li class=md-nav__item> <a href=../../../../getting_started/image_augmentation/ class=md-nav__link> <span class=md-ellipsis> Image augmentation for classification </span> </a> </li> <li class=md-nav__item> <a href=../../../../getting_started/mask_augmentation/ class=md-nav__link> <span class=md-ellipsis> Mask augmentation for segmentation </span> </a> </li> <li class=md-nav__item> <a href=../../../../getting_started/bounding_boxes_augmentation/ class=md-nav__link> <span class=md-ellipsis> Bounding boxes augmentation for object detection </span> </a> </li> <li class=md-nav__item> <a href=../../../../getting_started/keypoints_augmentation/ class=md-nav__link> <span class=md-ellipsis> Keypoints augmentation </span> </a> </li> <li class=md-nav__item> <a href=../../../../getting_started/simultaneous_augmentation/ class=md-nav__link> <span class=md-ellipsis> Simultaneous augmentation of multiple targets: masks, bounding boxes, keypoints </span> </a> </li> <li class=md-nav__item> <a href=../../../../getting_started/transforms_and_targets/ class=md-nav__link> <span class=md-ellipsis> A list of transforms and their supported targets </span> </a> </li> <li class=md-nav__item> <a href=../../../../getting_started/augmentation_mapping/ class=md-nav__link> <span class=md-ellipsis> Transform Library Comparison Guide </span> </a> </li> <li class=md-nav__item> <a href=../../../../getting_started/setting_probabilities/ class=md-nav__link> <span class=md-ellipsis> Setting probabilities for transforms </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <div class="md-nav__link md-nav__container"> <a href=../../../../examples/ class="md-nav__link "> <span class=md-ellipsis> Examples </span> </a> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Examples </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../../faq/ class=md-nav__link> <span class=md-ellipsis> FAQ </span> </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex> <span class=md-ellipsis> External resources </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> External resources </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../external_resources/online_courses/ class=md-nav__link> <span class=md-ellipsis> Online classes that cover Albumentations </span> </a> </li> <li class=md-nav__item> <a href=../../../../external_resources/blog_posts_podcasts_talks/ class=md-nav__link> <span class=md-ellipsis> Blog posts, podcasts, talks, and videos about Albumentations </span> </a> </li> <li class=md-nav__item> <a href=../../../../external_resources/books/ class=md-nav__link> <span class=md-ellipsis> Books that mention Albumentations </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_8> <label class=md-nav__link for=__nav_8 id=__nav_8_label tabindex> <span class=md-ellipsis> Integrations </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_8_label aria-expanded=false> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> Integrations </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../../integrations/huggingface/ class=md-nav__link> <span class=md-ellipsis> HuggingFace </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../../integrations/roboflow/train-rt-detr-on-custom-dataset-with-transformers/ class=md-nav__link> <span class=md-ellipsis> Roboflow </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class=md-nav__item> <a href=../../../../integrations/fiftyone/ class=md-nav__link> <span class=md-ellipsis> Voxel51 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../../frameworks_and_libraries/ class=md-nav__link> <span class=md-ellipsis> Frameworks and libraries that use Albumentations </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_10 checked> <div class="md-nav__link md-nav__container"> <a href=../../../ class="md-nav__link "> <span class=md-ellipsis> API Reference </span> </a> <label class="md-nav__link " for=__nav_10 id=__nav_10_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_10_label aria-expanded=true> <label class=md-nav__title for=__nav_10> <span class="md-nav__icon md-icon"></span> API Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../full_reference/ class=md-nav__link> <span class=md-ellipsis> Full API Reference </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../core/ class=md-nav__link> <span class=md-ellipsis> Core API </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_10_4 checked> <div class="md-nav__link md-nav__container"> <a href=../../ class="md-nav__link "> <span class=md-ellipsis> Augmentations </span> </a> <label class="md-nav__link " for=__nav_10_4 id=__nav_10_4_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_10_4_label aria-expanded=true> <label class=md-nav__title for=__nav_10_4> <span class="md-nav__icon md-icon"></span> Augmentations </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../transforms/ class=md-nav__link> <span class=md-ellipsis> Transforms (augmentations.transforms) </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../blur/ class=md-nav__link> <span class=md-ellipsis> Blur transforms </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../crops/ class=md-nav__link> <span class=md-ellipsis> Crop transforms </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../dropout/ class=md-nav__link> <span class=md-ellipsis> Dropout transforms </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_10_4_6 checked> <div class="md-nav__link md-nav__container"> <a href=../ class="md-nav__link "> <span class=md-ellipsis> Geometric transforms </span> </a> <label class="md-nav__link " for=__nav_10_4_6 id=__nav_10_4_6_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_10_4_6_label aria-expanded=true> <label class=md-nav__title for=__nav_10_4_6> <span class="md-nav__icon md-icon"></span> Geometric transforms </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../functional/ class=md-nav__link> <span class=md-ellipsis> Geometric functional transforms (augmentations.geometric.functional) </span> </a> </li> <li class=md-nav__item> <a href=../resize/ class=md-nav__link> <span class=md-ellipsis> Resizing transforms (augmentations.geometric.resize) </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Rotation transforms (augmentations.geometric.functional) </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Rotation transforms (augmentations.geometric.functional) </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#albumentations.augmentations.geometric.rotate class=md-nav__link> <span class=md-ellipsis> albumentations.augmentations.geometric.rotate </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../transforms/ class=md-nav__link> <span class=md-ellipsis> Geometric transforms (augmentations.geometric.transforms) </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../domain_adaptation/ class=md-nav__link> <span class=md-ellipsis> Domain Adaptation transforms </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class=md-nav__item> <a href=../../functional/ class=md-nav__link> <span class=md-ellipsis> Functional transforms (augmentations.functional) </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../pytorch/ class=md-nav__link> <span class=md-ellipsis> PyTorch Helpers </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../../CONTRIBUTING/ class=md-nav__link> <span class=md-ellipsis> Contributing </span> </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_12> <label class=md-nav__link for=__nav_12 id=__nav_12_label tabindex> <span class=md-ellipsis> Contributing </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_12_label aria-expanded=false> <label class=md-nav__title for=__nav_12> <span class="md-nav__icon md-icon"></span> Contributing </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../contributing/coding_guidelines/ class=md-nav__link> <span class=md-ellipsis> Coding Guidelines </span> </a> </li> <li class=md-nav__item> <a href=../../../../contributing/environment_setup/ class=md-nav__link> <span class=md-ellipsis> Environment Setup </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_13> <div class="md-nav__link md-nav__container"> <a href=../../../../autoalbument/ class="md-nav__link "> <span class=md-ellipsis> AutoAlbument </span> </a> <label class="md-nav__link " for=__nav_13 id=__nav_13_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_13_label aria-expanded=false> <label class=md-nav__title for=__nav_13> <span class="md-nav__icon md-icon"></span> AutoAlbument </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../autoalbument/benchmarks/ class=md-nav__link> <span class=md-ellipsis> Benchmarks and a comparison with baseline augmentation strategies </span> </a> </li> <li class=md-nav__item> <a href=../../../../autoalbument/installation/ class=md-nav__link> <span class=md-ellipsis> Installation </span> </a> </li> <li class=md-nav__item> <a href=../../../../autoalbument/how_to_use/ class=md-nav__link> <span class=md-ellipsis> How to use AutoAlbument </span> </a> </li> <li class=md-nav__item> <a href=../../../../autoalbument/docker/ class=md-nav__link> <span class=md-ellipsis> How to use an AutoAlbument Docker image </span> </a> </li> <li class=md-nav__item> <a href=../../../../autoalbument/custom_model/ class=md-nav__link> <span class=md-ellipsis> How to use a custom classification or semantic segmentation model </span> </a> </li> <li class=md-nav__item> <a href=../../../../autoalbument/metrics/ class=md-nav__link> <span class=md-ellipsis> Metrics and their meaning </span> </a> </li> <li class=md-nav__item> <a href=../../../../autoalbument/tuning_parameters/ class=md-nav__link> <span class=md-ellipsis> Tuning the search parameters </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../../autoalbument/examples/list/ class=md-nav__link> <span class=md-ellipsis> Examples </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class=md-nav__item> <a href=../../../../autoalbument/search_algorithms/ class=md-nav__link> <span class=md-ellipsis> Search algorithms </span> </a> </li> <li class=md-nav__item> <a href=../../../../autoalbument/faq/ class=md-nav__link> <span class=md-ellipsis> FAQ </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <style>
  .highlight-ipynb {
    font-size: 0.7rem;
  }

  .jupyter-wrapper .jp-MarkdownOutput.jp-RenderedHTMLCommon {
    font-size: 0.8rem;
  }
</style> <a href=https://github.com/albumentations-team/albumentations/edit/master/docs/src/docs/api_reference/augmentations/geometric/rotate.md title=edit.link.title class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75z"/></svg> </a> <h1 id=rotation-transforms-augmentationsgeometricfunctional>Rotation transforms (augmentations.geometric.functional)<a class=headerlink href=#rotation-transforms-augmentationsgeometricfunctional title="Permanent link">&para;</a></h1> <div class="doc doc-object doc-module"> <a id=albumentations.augmentations.geometric.rotate></a> <div class="doc doc-contents first"> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h2 id=albumentations.augmentations.geometric.rotate.RandomRotate90 class="doc doc-heading" data-toc-label=RandomRotate90> <code>class <strong> RandomRotate90</strong></code> <code> (p=1) </code> <span class=doc-github-link> <a href=https://github.com/albumentations-team/albumentations/blob/main/albumentations/augmentations/geometric/rotate.py#L75 target=_blank>[view source on GitHub]</a> </span><a class=headerlink href=#albumentations.augmentations.geometric.rotate.RandomRotate90 title="Permanent link">¶</a> </h2> <div class=class-signature> </div> <div class="doc doc-contents "> <p>Randomly rotate the input by 90 degrees zero or more times.</p> <p>Even with p=1.0, the transform has a 1/4 probability of being identity: - With probability p * 1/4: no rotation (0 degrees) - With probability p * 1/4: rotate 90 degrees - With probability p * 1/4: rotate 180 degrees - With probability p * 1/4: rotate 270 degrees</p> <p>For example: - With p=1.0: Each rotation angle (including 0°) has 0.25 probability - With p=0.8: Each rotation angle has 0.2 probability, and no transform has 0.2 probability - With p=0.5: Each rotation angle has 0.125 probability, and no transform has 0.5 probability</p> <p>Common applications: - Aerial/satellite imagery: Objects can appear in any orientation - Medical imaging: Scans/slides may not have a consistent orientation - Document analysis: Pages or symbols might be rotated - Microscopy: Cell orientation is often arbitrary - Game development: Sprites/textures that should work in multiple orientations</p> <p>Not recommended for: - Natural scene images where gravity matters (e.g., landscape photography) - Face detection/recognition tasks - Text recognition (unless text can appear rotated) - Tasks where object orientation is important for classification</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>If your domain has both 90-degree rotation AND flip symmetries (e.g., satellite imagery, microscopy), consider using <code>D4</code> transform instead. <code>D4</code> is more efficient and mathematically correct as it: - Samples uniformly from all 8 possible combinations of rotations and flips - Properly represents the dihedral group D4 symmetries - Avoids potential correlation between separate rotation and flip augmentations</p> </div> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>p</code></td> <td><code>float</code></td> <td><p>probability of applying the transform. Default: 1.0. Note that even with p=1.0, there's still a 0.25 probability of getting a 0-degree rotation (identity transform).</p></td> </tr> </tbody> </table> <div class="admonition targets"> <p class=admonition-title>Targets</p> <p>image, mask, bboxes, keypoints, volume, mask3d</p> </div> <p>Image types: uint8, float32</p> <div class="admonition info"> <p class=admonition-title><strong>Interactive Tool Available!</strong></p> <p> <strong>Explore this transform visually and adjust parameters interactively using this tool:</strong> </p> <p> <a class="md-button md-button--primary" href=https://explore.albumentations.ai/transform/RandomRotate90 target=_blank>Open Tool</a> </p> </div> <details class=quote> <summary>Source code in <code>albumentations/augmentations/geometric/rotate.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1></a><a href=#__codelineno-0-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>class</span><span class=w> </span><span class=nc>RandomRotate90</span><span class=p>(</span><span class=n>DualTransform</span><span class=p>):</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2></a><a href=#__codelineno-0-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Randomly rotate the input by 90 degrees zero or more times.</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3></a><a href=#__codelineno-0-3><span class=linenos data-linenos=" 3 "></span></a>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4></a><a href=#__codelineno-0-4><span class=linenos data-linenos=" 4 "></span></a><span class=sd>    Even with p=1.0, the transform has a 1/4 probability of being identity:</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5></a><a href=#__codelineno-0-5><span class=linenos data-linenos=" 5 "></span></a><span class=sd>    - With probability p * 1/4: no rotation (0 degrees)</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6></a><a href=#__codelineno-0-6><span class=linenos data-linenos=" 6 "></span></a><span class=sd>    - With probability p * 1/4: rotate 90 degrees</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7></a><a href=#__codelineno-0-7><span class=linenos data-linenos=" 7 "></span></a><span class=sd>    - With probability p * 1/4: rotate 180 degrees</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8></a><a href=#__codelineno-0-8><span class=linenos data-linenos=" 8 "></span></a><span class=sd>    - With probability p * 1/4: rotate 270 degrees</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9></a><a href=#__codelineno-0-9><span class=linenos data-linenos=" 9 "></span></a>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10></a><a href=#__codelineno-0-10><span class=linenos data-linenos="10 "></span></a><span class=sd>    For example:</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11></a><a href=#__codelineno-0-11><span class=linenos data-linenos="11 "></span></a><span class=sd>    - With p=1.0: Each rotation angle (including 0°) has 0.25 probability</span>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12></a><a href=#__codelineno-0-12><span class=linenos data-linenos="12 "></span></a><span class=sd>    - With p=0.8: Each rotation angle has 0.2 probability, and no transform has 0.2 probability</span>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13></a><a href=#__codelineno-0-13><span class=linenos data-linenos="13 "></span></a><span class=sd>    - With p=0.5: Each rotation angle has 0.125 probability, and no transform has 0.5 probability</span>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14></a><a href=#__codelineno-0-14><span class=linenos data-linenos="14 "></span></a>
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15></a><a href=#__codelineno-0-15><span class=linenos data-linenos="15 "></span></a><span class=sd>    Common applications:</span>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16></a><a href=#__codelineno-0-16><span class=linenos data-linenos="16 "></span></a><span class=sd>    - Aerial/satellite imagery: Objects can appear in any orientation</span>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17></a><a href=#__codelineno-0-17><span class=linenos data-linenos="17 "></span></a><span class=sd>    - Medical imaging: Scans/slides may not have a consistent orientation</span>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18></a><a href=#__codelineno-0-18><span class=linenos data-linenos="18 "></span></a><span class=sd>    - Document analysis: Pages or symbols might be rotated</span>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19></a><a href=#__codelineno-0-19><span class=linenos data-linenos="19 "></span></a><span class=sd>    - Microscopy: Cell orientation is often arbitrary</span>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20></a><a href=#__codelineno-0-20><span class=linenos data-linenos="20 "></span></a><span class=sd>    - Game development: Sprites/textures that should work in multiple orientations</span>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21></a><a href=#__codelineno-0-21><span class=linenos data-linenos="21 "></span></a>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22></a><a href=#__codelineno-0-22><span class=linenos data-linenos="22 "></span></a><span class=sd>    Not recommended for:</span>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23></a><a href=#__codelineno-0-23><span class=linenos data-linenos="23 "></span></a><span class=sd>    - Natural scene images where gravity matters (e.g., landscape photography)</span>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a><a href=#__codelineno-0-24><span class=linenos data-linenos="24 "></span></a><span class=sd>    - Face detection/recognition tasks</span>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a><a href=#__codelineno-0-25><span class=linenos data-linenos="25 "></span></a><span class=sd>    - Text recognition (unless text can appear rotated)</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a><a href=#__codelineno-0-26><span class=linenos data-linenos="26 "></span></a><span class=sd>    - Tasks where object orientation is important for classification</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a><a href=#__codelineno-0-27><span class=linenos data-linenos="27 "></span></a>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a><a href=#__codelineno-0-28><span class=linenos data-linenos="28 "></span></a><span class=sd>    Note:</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a><a href=#__codelineno-0-29><span class=linenos data-linenos="29 "></span></a><span class=sd>        If your domain has both 90-degree rotation AND flip symmetries</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a><a href=#__codelineno-0-30><span class=linenos data-linenos="30 "></span></a><span class=sd>        (e.g., satellite imagery, microscopy), consider using `D4` transform instead.</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a><a href=#__codelineno-0-31><span class=linenos data-linenos="31 "></span></a><span class=sd>        `D4` is more efficient and mathematically correct as it:</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a><a href=#__codelineno-0-32><span class=linenos data-linenos="32 "></span></a><span class=sd>        - Samples uniformly from all 8 possible combinations of rotations and flips</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a><a href=#__codelineno-0-33><span class=linenos data-linenos="33 "></span></a><span class=sd>        - Properly represents the dihedral group D4 symmetries</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a><a href=#__codelineno-0-34><span class=linenos data-linenos="34 "></span></a><span class=sd>        - Avoids potential correlation between separate rotation and flip augmentations</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a><a href=#__codelineno-0-35><span class=linenos data-linenos="35 "></span></a>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a><a href=#__codelineno-0-36><span class=linenos data-linenos="36 "></span></a><span class=sd>    Args:</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a><a href=#__codelineno-0-37><span class=linenos data-linenos="37 "></span></a><span class=sd>        p (float): probability of applying the transform. Default: 1.0.</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a><a href=#__codelineno-0-38><span class=linenos data-linenos="38 "></span></a><span class=sd>            Note that even with p=1.0, there&#39;s still a 0.25 probability</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a><a href=#__codelineno-0-39><span class=linenos data-linenos="39 "></span></a><span class=sd>            of getting a 0-degree rotation (identity transform).</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a><a href=#__codelineno-0-40><span class=linenos data-linenos="40 "></span></a>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a><a href=#__codelineno-0-41><span class=linenos data-linenos="41 "></span></a><span class=sd>    Targets:</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><a href=#__codelineno-0-42><span class=linenos data-linenos="42 "></span></a><span class=sd>        image, mask, bboxes, keypoints, volume, mask3d</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos="43 "></span></a>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos="44 "></span></a><span class=sd>    Image types:</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos="45 "></span></a><span class=sd>        uint8, float32</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos="46 "></span></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos="47 "></span></a>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos="48 "></span></a>    <span class=n>_targets</span> <span class=o>=</span> <span class=n>ALL_TARGETS</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos="49 "></span></a>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos="50 "></span></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos="51 "></span></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos="52 "></span></a>        <span class=n>p</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos="53 "></span></a>    <span class=p>):</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos="54 "></span></a>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=n>p</span><span class=o>=</span><span class=n>p</span><span class=p>)</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos="55 "></span></a>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos="56 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>apply</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>img</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>factor</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span> <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos="57 "></span></a>        <span class=k>return</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>rot90</span><span class=p>(</span><span class=n>img</span><span class=p>,</span> <span class=n>factor</span><span class=p>)</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos="58 "></span></a>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos="59 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>get_params</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>int</span><span class=p>]:</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos="60 "></span></a>        <span class=c1># Random int in the range [0, 3]</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos="61 "></span></a>        <span class=k>return</span> <span class=p>{</span><span class=s2>&quot;factor&quot;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>py_random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>3</span><span class=p>)}</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos="62 "></span></a>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos="63 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>apply_to_bboxes</span><span class=p>(</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos="64 "></span></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos="65 "></span></a>        <span class=n>bboxes</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos="66 "></span></a>        <span class=n>factor</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos="67 "></span></a>        <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>,</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos="68 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos="69 "></span></a>        <span class=k>return</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>bboxes_rot90</span><span class=p>(</span><span class=n>bboxes</span><span class=p>,</span> <span class=n>factor</span><span class=p>)</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos="70 "></span></a>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos="71 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>apply_to_keypoints</span><span class=p>(</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos="72 "></span></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos="73 "></span></a>        <span class=n>keypoints</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos="74 "></span></a>        <span class=n>factor</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos="75 "></span></a>        <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>,</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos="76 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos="77 "></span></a>        <span class=k>return</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>keypoints_rot90</span><span class=p>(</span><span class=n>keypoints</span><span class=p>,</span> <span class=n>factor</span><span class=p>,</span> <span class=n>params</span><span class=p>[</span><span class=s2>&quot;shape&quot;</span><span class=p>])</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos="78 "></span></a>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos="79 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>get_transform_init_args_names</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>tuple</span><span class=p>[()]:</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos="80 "></span></a>        <span class=k>return</span> <span class=p>()</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-class"> <h2 id=albumentations.augmentations.geometric.rotate.Rotate class="doc doc-heading" data-toc-label=Rotate> <code>class <strong> Rotate</strong></code> <code> (limit=(-90, 90), interpolation=1, border_mode=0, rotate_method=&#39;largest_box&#39;, crop_border=False, mask_interpolation=0, fill=0, fill_mask=0, p=0.5) </code> <span class=doc-github-link> <a href=https://github.com/albumentations-team/albumentations/blob/main/albumentations/augmentations/geometric/rotate.py#L20 target=_blank>[view source on GitHub]</a> </span><a class=headerlink href=#albumentations.augmentations.geometric.rotate.Rotate title="Permanent link">¶</a> </h2> <div class=class-signature> </div> <div class="doc doc-contents "> <p>Rotate the input by an angle selected randomly from the uniform distribution.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>limit</code></td> <td><code>float | tuple[float, float]</code></td> <td><p>Range from which a random angle is picked. If limit is a single float, an angle is picked from (-limit, limit). Default: (-90, 90)</p></td> </tr> <tr> <td><code>interpolation</code></td> <td><code>OpenCV flag</code></td> <td><p>Flag that is used to specify the interpolation algorithm. Should be one of: cv2.INTER_NEAREST, cv2.INTER_LINEAR, cv2.INTER_CUBIC, cv2.INTER_AREA, cv2.INTER_LANCZOS4. Default: cv2.INTER_LINEAR.</p></td> </tr> <tr> <td><code>border_mode</code></td> <td><code>OpenCV flag</code></td> <td><p>Flag that is used to specify the pixel extrapolation method. Should be one of: cv2.BORDER_CONSTANT, cv2.BORDER_REPLICATE, cv2.BORDER_REFLECT, cv2.BORDER_WRAP, cv2.BORDER_REFLECT_101. Default: cv2.BORDER_CONSTANT</p></td> </tr> <tr> <td><code>fill</code></td> <td><code>tuple[float, ...] | float</code></td> <td><p>Padding value if border_mode is cv2.BORDER_CONSTANT.</p></td> </tr> <tr> <td><code>fill_mask</code></td> <td><code>tuple[float, ...] | float</code></td> <td><p>Padding value if border_mode is cv2.BORDER_CONSTANT applied for masks.</p></td> </tr> <tr> <td><code>rotate_method</code></td> <td><code>Literal[&#34;largest_box&#34;, &#34;ellipse&#34;]</code></td> <td><p>Method to rotate bounding boxes. Should be 'largest_box' or 'ellipse'. Default: 'largest_box'</p></td> </tr> <tr> <td><code>crop_border</code></td> <td><code>bool</code></td> <td><p>Whether to crop border after rotation. If True, the output image size might differ from the input. Default: False</p></td> </tr> <tr> <td><code>mask_interpolation</code></td> <td><code>OpenCV flag</code></td> <td><p>flag that is used to specify the interpolation algorithm for mask. Should be one of: cv2.INTER_NEAREST, cv2.INTER_LINEAR, cv2.INTER_CUBIC, cv2.INTER_AREA, cv2.INTER_LANCZOS4. Default: cv2.INTER_NEAREST.</p></td> </tr> <tr> <td><code>p</code></td> <td><code>float</code></td> <td><p>Probability of applying the transform. Default: 0.5.</p></td> </tr> </tbody> </table> <div class="admonition targets"> <p class=admonition-title>Targets</p> <p>image, mask, bboxes, keypoints, volume, mask3d</p> </div> <p>Image types: uint8, float32</p> <div class="admonition note"> <p class=admonition-title>Note</p> <ul> <li>The rotation angle is randomly selected for each execution within the range specified by 'limit'.</li> <li>When 'crop_border' is False, the output image will have the same size as the input, potentially introducing black triangles in the corners.</li> <li>When 'crop_border' is True, the output image is cropped to remove black triangles, which may result in a smaller image.</li> <li>Bounding boxes are rotated and may change size or shape.</li> <li>Keypoints are rotated around the center of the image.</li> </ul> </div> <p>Mathematical Details: 1. An angle θ is randomly sampled from the range specified by 'limit'. 2. The image is rotated around its center by θ degrees. 3. The rotation matrix R is: R = [cos(θ) -sin(θ)] [sin(θ) cos(θ)] 4. Each point (x, y) in the image is transformed to (x', y') by: [x'] [cos(θ) -sin(θ)][x - cx] [cx] [y'] = [sin(θ) cos(θ)][y - cy] + [cy] where (cx, cy) is the center of the image. 5. If 'crop_border' is True, the image is cropped to the largest rectangle that fits inside the rotated image.</p> <p><strong>Examples:</strong></p> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=o>&gt;&gt;&gt;</span> <span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=o>&gt;&gt;&gt;</span> <span class=kn>import</span><span class=w> </span><span class=nn>albumentations</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>A</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=o>&gt;&gt;&gt;</span> <span class=n>image</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>256</span><span class=p>,</span> <span class=p>(</span><span class=mi>100</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>3</span><span class=p>),</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>uint8</span><span class=p>)</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=o>&gt;&gt;&gt;</span> <span class=n>transform</span> <span class=o>=</span> <span class=n>A</span><span class=o>.</span><span class=n>Rotate</span><span class=p>(</span><span class=n>limit</span><span class=o>=</span><span class=mi>45</span><span class=p>,</span> <span class=n>p</span><span class=o>=</span><span class=mf>1.0</span><span class=p>)</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=o>&gt;&gt;&gt;</span> <span class=n>result</span> <span class=o>=</span> <span class=n>transform</span><span class=p>(</span><span class=n>image</span><span class=o>=</span><span class=n>image</span><span class=p>)</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=o>&gt;&gt;&gt;</span> <span class=n>rotated_image</span> <span class=o>=</span> <span class=n>result</span><span class=p>[</span><span class=s1>&#39;image&#39;</span><span class=p>]</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=c1># rotated_image will be the input image rotated by a random angle between -45 and 45 degrees</span>
</span></code></pre></div> <div class="admonition info"> <p class=admonition-title><strong>Interactive Tool Available!</strong></p> <p> <strong>Explore this transform visually and adjust parameters interactively using this tool:</strong> </p> <p> <a class="md-button md-button--primary" href=https://explore.albumentations.ai/transform/Rotate target=_blank>Open Tool</a> </p> </div> <details class=quote> <summary>Source code in <code>albumentations/augmentations/geometric/rotate.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1></a><a href=#__codelineno-0-1><span class=linenos data-linenos="  1 "></span></a><span class=k>class</span><span class=w> </span><span class=nc>Rotate</span><span class=p>(</span><span class=n>DualTransform</span><span class=p>):</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2></a><a href=#__codelineno-0-2><span class=linenos data-linenos="  2 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Rotate the input by an angle selected randomly from the uniform distribution.</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3></a><a href=#__codelineno-0-3><span class=linenos data-linenos="  3 "></span></a>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4></a><a href=#__codelineno-0-4><span class=linenos data-linenos="  4 "></span></a><span class=sd>    Args:</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5></a><a href=#__codelineno-0-5><span class=linenos data-linenos="  5 "></span></a><span class=sd>        limit (float | tuple[float, float]): Range from which a random angle is picked. If limit is a single float,</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6></a><a href=#__codelineno-0-6><span class=linenos data-linenos="  6 "></span></a><span class=sd>            an angle is picked from (-limit, limit). Default: (-90, 90)</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7></a><a href=#__codelineno-0-7><span class=linenos data-linenos="  7 "></span></a><span class=sd>        interpolation (OpenCV flag): Flag that is used to specify the interpolation algorithm. Should be one of:</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8></a><a href=#__codelineno-0-8><span class=linenos data-linenos="  8 "></span></a><span class=sd>            cv2.INTER_NEAREST, cv2.INTER_LINEAR, cv2.INTER_CUBIC, cv2.INTER_AREA, cv2.INTER_LANCZOS4.</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9></a><a href=#__codelineno-0-9><span class=linenos data-linenos="  9 "></span></a><span class=sd>            Default: cv2.INTER_LINEAR.</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10></a><a href=#__codelineno-0-10><span class=linenos data-linenos=" 10 "></span></a><span class=sd>        border_mode (OpenCV flag): Flag that is used to specify the pixel extrapolation method. Should be one of:</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11></a><a href=#__codelineno-0-11><span class=linenos data-linenos=" 11 "></span></a><span class=sd>            cv2.BORDER_CONSTANT, cv2.BORDER_REPLICATE, cv2.BORDER_REFLECT, cv2.BORDER_WRAP, cv2.BORDER_REFLECT_101.</span>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12></a><a href=#__codelineno-0-12><span class=linenos data-linenos=" 12 "></span></a><span class=sd>            Default: cv2.BORDER_CONSTANT</span>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13></a><a href=#__codelineno-0-13><span class=linenos data-linenos=" 13 "></span></a><span class=sd>        fill (tuple[float, ...] | float): Padding value if border_mode is cv2.BORDER_CONSTANT.</span>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14></a><a href=#__codelineno-0-14><span class=linenos data-linenos=" 14 "></span></a><span class=sd>        fill_mask (tuple[float, ...] | float): Padding value if border_mode is cv2.BORDER_CONSTANT applied for masks.</span>
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15></a><a href=#__codelineno-0-15><span class=linenos data-linenos=" 15 "></span></a><span class=sd>        rotate_method (Literal[&quot;largest_box&quot;, &quot;ellipse&quot;]): Method to rotate bounding boxes.</span>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16></a><a href=#__codelineno-0-16><span class=linenos data-linenos=" 16 "></span></a><span class=sd>            Should be &#39;largest_box&#39; or &#39;ellipse&#39;. Default: &#39;largest_box&#39;</span>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17></a><a href=#__codelineno-0-17><span class=linenos data-linenos=" 17 "></span></a><span class=sd>        crop_border (bool): Whether to crop border after rotation. If True, the output image size might differ</span>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18></a><a href=#__codelineno-0-18><span class=linenos data-linenos=" 18 "></span></a><span class=sd>            from the input. Default: False</span>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19></a><a href=#__codelineno-0-19><span class=linenos data-linenos=" 19 "></span></a><span class=sd>        mask_interpolation (OpenCV flag): flag that is used to specify the interpolation algorithm for mask.</span>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20></a><a href=#__codelineno-0-20><span class=linenos data-linenos=" 20 "></span></a><span class=sd>            Should be one of: cv2.INTER_NEAREST, cv2.INTER_LINEAR, cv2.INTER_CUBIC, cv2.INTER_AREA, cv2.INTER_LANCZOS4.</span>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21></a><a href=#__codelineno-0-21><span class=linenos data-linenos=" 21 "></span></a><span class=sd>            Default: cv2.INTER_NEAREST.</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22></a><a href=#__codelineno-0-22><span class=linenos data-linenos=" 22 "></span></a><span class=sd>        p (float): Probability of applying the transform. Default: 0.5.</span>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23></a><a href=#__codelineno-0-23><span class=linenos data-linenos=" 23 "></span></a>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a><a href=#__codelineno-0-24><span class=linenos data-linenos=" 24 "></span></a><span class=sd>    Targets:</span>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a><a href=#__codelineno-0-25><span class=linenos data-linenos=" 25 "></span></a><span class=sd>        image, mask, bboxes, keypoints, volume, mask3d</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a><a href=#__codelineno-0-26><span class=linenos data-linenos=" 26 "></span></a>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a><a href=#__codelineno-0-27><span class=linenos data-linenos=" 27 "></span></a><span class=sd>    Image types:</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a><a href=#__codelineno-0-28><span class=linenos data-linenos=" 28 "></span></a><span class=sd>        uint8, float32</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a><a href=#__codelineno-0-29><span class=linenos data-linenos=" 29 "></span></a>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a><a href=#__codelineno-0-30><span class=linenos data-linenos=" 30 "></span></a><span class=sd>    Note:</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a><a href=#__codelineno-0-31><span class=linenos data-linenos=" 31 "></span></a><span class=sd>        - The rotation angle is randomly selected for each execution within the range specified by &#39;limit&#39;.</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a><a href=#__codelineno-0-32><span class=linenos data-linenos=" 32 "></span></a><span class=sd>        - When &#39;crop_border&#39; is False, the output image will have the same size as the input, potentially</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a><a href=#__codelineno-0-33><span class=linenos data-linenos=" 33 "></span></a><span class=sd>          introducing black triangles in the corners.</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a><a href=#__codelineno-0-34><span class=linenos data-linenos=" 34 "></span></a><span class=sd>        - When &#39;crop_border&#39; is True, the output image is cropped to remove black triangles, which may result</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a><a href=#__codelineno-0-35><span class=linenos data-linenos=" 35 "></span></a><span class=sd>          in a smaller image.</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a><a href=#__codelineno-0-36><span class=linenos data-linenos=" 36 "></span></a><span class=sd>        - Bounding boxes are rotated and may change size or shape.</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a><a href=#__codelineno-0-37><span class=linenos data-linenos=" 37 "></span></a><span class=sd>        - Keypoints are rotated around the center of the image.</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a><a href=#__codelineno-0-38><span class=linenos data-linenos=" 38 "></span></a>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a><a href=#__codelineno-0-39><span class=linenos data-linenos=" 39 "></span></a><span class=sd>    Mathematical Details:</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a><a href=#__codelineno-0-40><span class=linenos data-linenos=" 40 "></span></a><span class=sd>        1. An angle θ is randomly sampled from the range specified by &#39;limit&#39;.</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a><a href=#__codelineno-0-41><span class=linenos data-linenos=" 41 "></span></a><span class=sd>        2. The image is rotated around its center by θ degrees.</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><a href=#__codelineno-0-42><span class=linenos data-linenos=" 42 "></span></a><span class=sd>        3. The rotation matrix R is:</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos=" 43 "></span></a><span class=sd>           R = [cos(θ)  -sin(θ)]</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos=" 44 "></span></a><span class=sd>               [sin(θ)   cos(θ)]</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos=" 45 "></span></a><span class=sd>        4. Each point (x, y) in the image is transformed to (x&#39;, y&#39;) by:</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos=" 46 "></span></a><span class=sd>           [x&#39;]   [cos(θ)  -sin(θ)] [x - cx]   [cx]</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos=" 47 "></span></a><span class=sd>           [y&#39;] = [sin(θ)   cos(θ)] [y - cy] + [cy]</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos=" 48 "></span></a><span class=sd>           where (cx, cy) is the center of the image.</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos=" 49 "></span></a><span class=sd>        5. If &#39;crop_border&#39; is True, the image is cropped to the largest rectangle that fits inside the rotated image.</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos=" 50 "></span></a>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos=" 51 "></span></a><span class=sd>    Example:</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos=" 52 "></span></a><span class=sd>        &gt;&gt;&gt; import numpy as np</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a><span class=sd>        &gt;&gt;&gt; import albumentations as A</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a><span class=sd>        &gt;&gt;&gt; image = np.random.randint(0, 256, (100, 100, 3), dtype=np.uint8)</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a><span class=sd>        &gt;&gt;&gt; transform = A.Rotate(limit=45, p=1.0)</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a><span class=sd>        &gt;&gt;&gt; result = transform(image=image)</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a><span class=sd>        &gt;&gt;&gt; rotated_image = result[&#39;image&#39;]</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a><span class=sd>        # rotated_image will be the input image rotated by a random angle between -45 and 45 degrees</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a>    <span class=n>_targets</span> <span class=o>=</span> <span class=n>ALL_TARGETS</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a>    <span class=k>class</span><span class=w> </span><span class=nc>InitSchema</span><span class=p>(</span><span class=n>RotateInitSchema</span><span class=p>):</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a>        <span class=n>rotate_method</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;largest_box&quot;</span><span class=p>,</span> <span class=s2>&quot;ellipse&quot;</span><span class=p>]</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a>        <span class=n>crop_border</span><span class=p>:</span> <span class=nb>bool</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a>        <span class=n>fill</span><span class=p>:</span> <span class=nb>tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=o>...</span><span class=p>]</span> <span class=o>|</span> <span class=nb>float</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a>        <span class=n>fill_mask</span><span class=p>:</span> <span class=nb>tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=o>...</span><span class=p>]</span> <span class=o>|</span> <span class=nb>float</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a>        <span class=n>limit</span><span class=p>:</span> <span class=nb>tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>]</span> <span class=o>|</span> <span class=nb>float</span> <span class=o>=</span> <span class=p>(</span><span class=o>-</span><span class=mi>90</span><span class=p>,</span> <span class=mi>90</span><span class=p>),</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a>        <span class=n>interpolation</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a>            <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_NEAREST</span><span class=p>,</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a>            <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_LINEAR</span><span class=p>,</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a>            <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_CUBIC</span><span class=p>,</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a>            <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_AREA</span><span class=p>,</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a>            <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_LANCZOS4</span><span class=p>,</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a>        <span class=p>]</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_LINEAR</span><span class=p>,</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a>        <span class=n>border_mode</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a>            <span class=n>cv2</span><span class=o>.</span><span class=n>BORDER_CONSTANT</span><span class=p>,</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a>            <span class=n>cv2</span><span class=o>.</span><span class=n>BORDER_REPLICATE</span><span class=p>,</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a>            <span class=n>cv2</span><span class=o>.</span><span class=n>BORDER_REFLECT</span><span class=p>,</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a>            <span class=n>cv2</span><span class=o>.</span><span class=n>BORDER_WRAP</span><span class=p>,</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a>            <span class=n>cv2</span><span class=o>.</span><span class=n>BORDER_REFLECT_101</span><span class=p>,</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a>            <span class=n>cv2</span><span class=o>.</span><span class=n>BORDER_REFLECT101</span><span class=p>,</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a>        <span class=p>]</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>BORDER_CONSTANT</span><span class=p>,</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a>        <span class=n>rotate_method</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;largest_box&quot;</span><span class=p>,</span> <span class=s2>&quot;ellipse&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&quot;largest_box&quot;</span><span class=p>,</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a>        <span class=n>crop_border</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a>        <span class=n>mask_interpolation</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a>            <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_NEAREST</span><span class=p>,</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a>            <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_LINEAR</span><span class=p>,</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a>            <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_CUBIC</span><span class=p>,</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a>            <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_AREA</span><span class=p>,</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a>            <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_LANCZOS4</span><span class=p>,</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a>        <span class=p>]</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_NEAREST</span><span class=p>,</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a>        <span class=n>fill</span><span class=p>:</span> <span class=nb>tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=o>...</span><span class=p>]</span> <span class=o>|</span> <span class=nb>float</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a>        <span class=n>fill_mask</span><span class=p>:</span> <span class=nb>tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=o>...</span><span class=p>]</span> <span class=o>|</span> <span class=nb>float</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a>        <span class=n>p</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.5</span><span class=p>,</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a>    <span class=p>):</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=n>p</span><span class=o>=</span><span class=n>p</span><span class=p>)</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>limit</span> <span class=o>=</span> <span class=n>cast</span><span class=p>(</span><span class=nb>tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>],</span> <span class=n>limit</span><span class=p>)</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>interpolation</span> <span class=o>=</span> <span class=n>interpolation</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>mask_interpolation</span> <span class=o>=</span> <span class=n>mask_interpolation</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>border_mode</span> <span class=o>=</span> <span class=n>border_mode</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>fill</span> <span class=o>=</span> <span class=n>fill</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>fill_mask</span> <span class=o>=</span> <span class=n>fill_mask</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>rotate_method</span> <span class=o>=</span> <span class=n>rotate_method</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>crop_border</span> <span class=o>=</span> <span class=n>crop_border</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>apply</span><span class=p>(</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a>        <span class=n>img</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a>        <span class=n>matrix</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a>        <span class=n>x_min</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a>        <span class=n>x_max</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a>        <span class=n>y_min</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a>        <span class=n>y_max</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a>        <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>,</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a>        <span class=n>img_out</span> <span class=o>=</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>warp_affine</span><span class=p>(</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a>            <span class=n>img</span><span class=p>,</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a>            <span class=n>matrix</span><span class=p>,</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>interpolation</span><span class=p>,</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>fill</span><span class=p>,</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>border_mode</span><span class=p>,</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a>            <span class=n>params</span><span class=p>[</span><span class=s2>&quot;shape&quot;</span><span class=p>][:</span><span class=mi>2</span><span class=p>],</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>crop_border</span><span class=p>:</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a>            <span class=k>return</span> <span class=n>fcrops</span><span class=o>.</span><span class=n>crop</span><span class=p>(</span><span class=n>img_out</span><span class=p>,</span> <span class=n>x_min</span><span class=p>,</span> <span class=n>y_min</span><span class=p>,</span> <span class=n>x_max</span><span class=p>,</span> <span class=n>y_max</span><span class=p>)</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a>        <span class=k>return</span> <span class=n>img_out</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>apply_to_mask</span><span class=p>(</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a>        <span class=n>mask</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a>        <span class=n>matrix</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a>        <span class=n>x_min</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a>        <span class=n>x_max</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a>        <span class=n>y_min</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a>        <span class=n>y_max</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a>        <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>,</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a>        <span class=n>img_out</span> <span class=o>=</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>warp_affine</span><span class=p>(</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a>            <span class=n>mask</span><span class=p>,</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a>            <span class=n>matrix</span><span class=p>,</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>mask_interpolation</span><span class=p>,</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>fill_mask</span><span class=p>,</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>border_mode</span><span class=p>,</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a>            <span class=n>params</span><span class=p>[</span><span class=s2>&quot;shape&quot;</span><span class=p>][:</span><span class=mi>2</span><span class=p>],</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>crop_border</span><span class=p>:</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><a href=#__codelineno-0-152><span class=linenos data-linenos="152 "></span></a>            <span class=k>return</span> <span class=n>fcrops</span><span class=o>.</span><span class=n>crop</span><span class=p>(</span><span class=n>img_out</span><span class=p>,</span> <span class=n>x_min</span><span class=p>,</span> <span class=n>y_min</span><span class=p>,</span> <span class=n>x_max</span><span class=p>,</span> <span class=n>y_max</span><span class=p>)</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><a href=#__codelineno-0-153><span class=linenos data-linenos="153 "></span></a>        <span class=k>return</span> <span class=n>img_out</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><a href=#__codelineno-0-154><span class=linenos data-linenos="154 "></span></a>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><a href=#__codelineno-0-155><span class=linenos data-linenos="155 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>apply_to_bboxes</span><span class=p>(</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><a href=#__codelineno-0-156><span class=linenos data-linenos="156 "></span></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><a href=#__codelineno-0-157><span class=linenos data-linenos="157 "></span></a>        <span class=n>bboxes</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><a href=#__codelineno-0-158><span class=linenos data-linenos="158 "></span></a>        <span class=n>bbox_matrix</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><a href=#__codelineno-0-159><span class=linenos data-linenos="159 "></span></a>        <span class=n>x_min</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><a href=#__codelineno-0-160><span class=linenos data-linenos="160 "></span></a>        <span class=n>x_max</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><a href=#__codelineno-0-161><span class=linenos data-linenos="161 "></span></a>        <span class=n>y_min</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><a href=#__codelineno-0-162><span class=linenos data-linenos="162 "></span></a>        <span class=n>y_max</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><a href=#__codelineno-0-163><span class=linenos data-linenos="163 "></span></a>        <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>,</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><a href=#__codelineno-0-164><span class=linenos data-linenos="164 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><a href=#__codelineno-0-165><span class=linenos data-linenos="165 "></span></a>        <span class=n>image_shape</span> <span class=o>=</span> <span class=n>params</span><span class=p>[</span><span class=s2>&quot;shape&quot;</span><span class=p>][:</span><span class=mi>2</span><span class=p>]</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><a href=#__codelineno-0-166><span class=linenos data-linenos="166 "></span></a>        <span class=n>bboxes_out</span> <span class=o>=</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>bboxes_affine</span><span class=p>(</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><a href=#__codelineno-0-167><span class=linenos data-linenos="167 "></span></a>            <span class=n>bboxes</span><span class=p>,</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><a href=#__codelineno-0-168><span class=linenos data-linenos="168 "></span></a>            <span class=n>bbox_matrix</span><span class=p>,</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a><a href=#__codelineno-0-169><span class=linenos data-linenos="169 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>rotate_method</span><span class=p>,</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a><a href=#__codelineno-0-170><span class=linenos data-linenos="170 "></span></a>            <span class=n>image_shape</span><span class=p>,</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a><a href=#__codelineno-0-171><span class=linenos data-linenos="171 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>border_mode</span><span class=p>,</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a><a href=#__codelineno-0-172><span class=linenos data-linenos="172 "></span></a>            <span class=n>image_shape</span><span class=p>,</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a><a href=#__codelineno-0-173><span class=linenos data-linenos="173 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a><a href=#__codelineno-0-174><span class=linenos data-linenos="174 "></span></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>crop_border</span><span class=p>:</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a><a href=#__codelineno-0-175><span class=linenos data-linenos="175 "></span></a>            <span class=k>return</span> <span class=n>fcrops</span><span class=o>.</span><span class=n>crop_bboxes_by_coords</span><span class=p>(</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a><a href=#__codelineno-0-176><span class=linenos data-linenos="176 "></span></a>                <span class=n>bboxes_out</span><span class=p>,</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a><a href=#__codelineno-0-177><span class=linenos data-linenos="177 "></span></a>                <span class=p>(</span><span class=n>x_min</span><span class=p>,</span> <span class=n>y_min</span><span class=p>,</span> <span class=n>x_max</span><span class=p>,</span> <span class=n>y_max</span><span class=p>),</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a><a href=#__codelineno-0-178><span class=linenos data-linenos="178 "></span></a>                <span class=n>image_shape</span><span class=p>,</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a><a href=#__codelineno-0-179><span class=linenos data-linenos="179 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a><a href=#__codelineno-0-180><span class=linenos data-linenos="180 "></span></a>        <span class=k>return</span> <span class=n>bboxes_out</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a><a href=#__codelineno-0-181><span class=linenos data-linenos="181 "></span></a>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a><a href=#__codelineno-0-182><span class=linenos data-linenos="182 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>apply_to_keypoints</span><span class=p>(</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a><a href=#__codelineno-0-183><span class=linenos data-linenos="183 "></span></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a><a href=#__codelineno-0-184><span class=linenos data-linenos="184 "></span></a>        <span class=n>keypoints</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a><a href=#__codelineno-0-185><span class=linenos data-linenos="185 "></span></a>        <span class=n>matrix</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a><a href=#__codelineno-0-186><span class=linenos data-linenos="186 "></span></a>        <span class=n>x_min</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a><a href=#__codelineno-0-187><span class=linenos data-linenos="187 "></span></a>        <span class=n>x_max</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a><a href=#__codelineno-0-188><span class=linenos data-linenos="188 "></span></a>        <span class=n>y_min</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a><a href=#__codelineno-0-189><span class=linenos data-linenos="189 "></span></a>        <span class=n>y_max</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a><a href=#__codelineno-0-190><span class=linenos data-linenos="190 "></span></a>        <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>,</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a><a href=#__codelineno-0-191><span class=linenos data-linenos="191 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a><a href=#__codelineno-0-192><span class=linenos data-linenos="192 "></span></a>        <span class=n>keypoints_out</span> <span class=o>=</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>keypoints_affine</span><span class=p>(</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a><a href=#__codelineno-0-193><span class=linenos data-linenos="193 "></span></a>            <span class=n>keypoints</span><span class=p>,</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a><a href=#__codelineno-0-194><span class=linenos data-linenos="194 "></span></a>            <span class=n>matrix</span><span class=p>,</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a><a href=#__codelineno-0-195><span class=linenos data-linenos="195 "></span></a>            <span class=n>params</span><span class=p>[</span><span class=s2>&quot;shape&quot;</span><span class=p>][:</span><span class=mi>2</span><span class=p>],</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a><a href=#__codelineno-0-196><span class=linenos data-linenos="196 "></span></a>            <span class=n>scale</span><span class=o>=</span><span class=p>{</span><span class=s2>&quot;x&quot;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span> <span class=s2>&quot;y&quot;</span><span class=p>:</span> <span class=mi>1</span><span class=p>},</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a><a href=#__codelineno-0-197><span class=linenos data-linenos="197 "></span></a>            <span class=n>border_mode</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>border_mode</span><span class=p>,</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a><a href=#__codelineno-0-198><span class=linenos data-linenos="198 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a><a href=#__codelineno-0-199><span class=linenos data-linenos="199 "></span></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>crop_border</span><span class=p>:</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a><a href=#__codelineno-0-200><span class=linenos data-linenos="200 "></span></a>            <span class=k>return</span> <span class=n>fcrops</span><span class=o>.</span><span class=n>crop_keypoints_by_coords</span><span class=p>(</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a><a href=#__codelineno-0-201><span class=linenos data-linenos="201 "></span></a>                <span class=n>keypoints_out</span><span class=p>,</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a><a href=#__codelineno-0-202><span class=linenos data-linenos="202 "></span></a>                <span class=p>(</span><span class=n>x_min</span><span class=p>,</span> <span class=n>y_min</span><span class=p>,</span> <span class=n>x_max</span><span class=p>,</span> <span class=n>y_max</span><span class=p>),</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a><a href=#__codelineno-0-203><span class=linenos data-linenos="203 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a><a href=#__codelineno-0-204><span class=linenos data-linenos="204 "></span></a>        <span class=k>return</span> <span class=n>keypoints_out</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a><a href=#__codelineno-0-205><span class=linenos data-linenos="205 "></span></a>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a><a href=#__codelineno-0-206><span class=linenos data-linenos="206 "></span></a>    <span class=nd>@staticmethod</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a><a href=#__codelineno-0-207><span class=linenos data-linenos="207 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>_rotated_rect_with_max_area</span><span class=p>(</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a><a href=#__codelineno-0-208><span class=linenos data-linenos="208 "></span></a>        <span class=n>height</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a><a href=#__codelineno-0-209><span class=linenos data-linenos="209 "></span></a>        <span class=n>width</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a><a href=#__codelineno-0-210><span class=linenos data-linenos="210 "></span></a>        <span class=n>angle</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a><a href=#__codelineno-0-211><span class=linenos data-linenos="211 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>int</span><span class=p>]:</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a><a href=#__codelineno-0-212><span class=linenos data-linenos="212 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Given a rectangle of size wxh that has been rotated by &#39;angle&#39; (in</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a><a href=#__codelineno-0-213><span class=linenos data-linenos="213 "></span></a><span class=sd>        degrees), computes the width and height of the largest possible</span>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a><a href=#__codelineno-0-214><span class=linenos data-linenos="214 "></span></a><span class=sd>        axis-aligned rectangle (maximal area) within the rotated rectangle.</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a><a href=#__codelineno-0-215><span class=linenos data-linenos="215 "></span></a>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a><a href=#__codelineno-0-216><span class=linenos data-linenos="216 "></span></a><span class=sd>        Reference:</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a><a href=#__codelineno-0-217><span class=linenos data-linenos="217 "></span></a><span class=sd>            https://stackoverflow.com/questions/16702966/rotate-image-and-crop-out-black-borders</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a><a href=#__codelineno-0-218><span class=linenos data-linenos="218 "></span></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a><a href=#__codelineno-0-219><span class=linenos data-linenos="219 "></span></a>        <span class=n>angle</span> <span class=o>=</span> <span class=n>math</span><span class=o>.</span><span class=n>radians</span><span class=p>(</span><span class=n>angle</span><span class=p>)</span>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a><a href=#__codelineno-0-220><span class=linenos data-linenos="220 "></span></a>        <span class=n>width_is_longer</span> <span class=o>=</span> <span class=n>width</span> <span class=o>&gt;=</span> <span class=n>height</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a><a href=#__codelineno-0-221><span class=linenos data-linenos="221 "></span></a>        <span class=n>side_long</span><span class=p>,</span> <span class=n>side_short</span> <span class=o>=</span> <span class=p>(</span><span class=n>width</span><span class=p>,</span> <span class=n>height</span><span class=p>)</span> <span class=k>if</span> <span class=n>width_is_longer</span> <span class=k>else</span> <span class=p>(</span><span class=n>height</span><span class=p>,</span> <span class=n>width</span><span class=p>)</span>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a><a href=#__codelineno-0-222><span class=linenos data-linenos="222 "></span></a>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a><a href=#__codelineno-0-223><span class=linenos data-linenos="223 "></span></a>        <span class=c1># since the solutions for angle, -angle and 180-angle are all the same,</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a><a href=#__codelineno-0-224><span class=linenos data-linenos="224 "></span></a>        <span class=c1># it is sufficient to look at the first quadrant and the absolute values of sin,cos:</span>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a><a href=#__codelineno-0-225><span class=linenos data-linenos="225 "></span></a>        <span class=n>sin_a</span><span class=p>,</span> <span class=n>cos_a</span> <span class=o>=</span> <span class=nb>abs</span><span class=p>(</span><span class=n>math</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>angle</span><span class=p>)),</span> <span class=nb>abs</span><span class=p>(</span><span class=n>math</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>angle</span><span class=p>))</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a><a href=#__codelineno-0-226><span class=linenos data-linenos="226 "></span></a>        <span class=k>if</span> <span class=n>side_short</span> <span class=o>&lt;=</span> <span class=mf>2.0</span> <span class=o>*</span> <span class=n>sin_a</span> <span class=o>*</span> <span class=n>cos_a</span> <span class=o>*</span> <span class=n>side_long</span> <span class=ow>or</span> <span class=nb>abs</span><span class=p>(</span><span class=n>sin_a</span> <span class=o>-</span> <span class=n>cos_a</span><span class=p>)</span> <span class=o>&lt;</span> <span class=n>SMALL_NUMBER</span><span class=p>:</span>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a><a href=#__codelineno-0-227><span class=linenos data-linenos="227 "></span></a>            <span class=c1># half constrained case: two crop corners touch the longer side,</span>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a><a href=#__codelineno-0-228><span class=linenos data-linenos="228 "></span></a>            <span class=c1># the other two corners are on the mid-line parallel to the longer line</span>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a><a href=#__codelineno-0-229><span class=linenos data-linenos="229 "></span></a>            <span class=n>x</span> <span class=o>=</span> <span class=mf>0.5</span> <span class=o>*</span> <span class=n>side_short</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a><a href=#__codelineno-0-230><span class=linenos data-linenos="230 "></span></a>            <span class=n>wr</span><span class=p>,</span> <span class=n>hr</span> <span class=o>=</span> <span class=p>(</span><span class=n>x</span> <span class=o>/</span> <span class=n>sin_a</span><span class=p>,</span> <span class=n>x</span> <span class=o>/</span> <span class=n>cos_a</span><span class=p>)</span> <span class=k>if</span> <span class=n>width_is_longer</span> <span class=k>else</span> <span class=p>(</span><span class=n>x</span> <span class=o>/</span> <span class=n>cos_a</span><span class=p>,</span> <span class=n>x</span> <span class=o>/</span> <span class=n>sin_a</span><span class=p>)</span>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a><a href=#__codelineno-0-231><span class=linenos data-linenos="231 "></span></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a><a href=#__codelineno-0-232><span class=linenos data-linenos="232 "></span></a>            <span class=c1># fully constrained case: crop touches all 4 sides</span>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a><a href=#__codelineno-0-233><span class=linenos data-linenos="233 "></span></a>            <span class=n>cos_2a</span> <span class=o>=</span> <span class=n>cos_a</span> <span class=o>*</span> <span class=n>cos_a</span> <span class=o>-</span> <span class=n>sin_a</span> <span class=o>*</span> <span class=n>sin_a</span>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a><a href=#__codelineno-0-234><span class=linenos data-linenos="234 "></span></a>            <span class=n>wr</span><span class=p>,</span> <span class=n>hr</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a><a href=#__codelineno-0-235><span class=linenos data-linenos="235 "></span></a>                <span class=p>(</span><span class=n>width</span> <span class=o>*</span> <span class=n>cos_a</span> <span class=o>-</span> <span class=n>height</span> <span class=o>*</span> <span class=n>sin_a</span><span class=p>)</span> <span class=o>/</span> <span class=n>cos_2a</span><span class=p>,</span>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a><a href=#__codelineno-0-236><span class=linenos data-linenos="236 "></span></a>                <span class=p>(</span><span class=n>height</span> <span class=o>*</span> <span class=n>cos_a</span> <span class=o>-</span> <span class=n>width</span> <span class=o>*</span> <span class=n>sin_a</span><span class=p>)</span> <span class=o>/</span> <span class=n>cos_2a</span><span class=p>,</span>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a><a href=#__codelineno-0-237><span class=linenos data-linenos="237 "></span></a>            <span class=p>)</span>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a><a href=#__codelineno-0-238><span class=linenos data-linenos="238 "></span></a>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a><a href=#__codelineno-0-239><span class=linenos data-linenos="239 "></span></a>        <span class=k>return</span> <span class=p>{</span>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a><a href=#__codelineno-0-240><span class=linenos data-linenos="240 "></span></a>            <span class=s2>&quot;x_min&quot;</span><span class=p>:</span> <span class=nb>max</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nb>int</span><span class=p>(</span><span class=n>width</span> <span class=o>/</span> <span class=mi>2</span> <span class=o>-</span> <span class=n>wr</span> <span class=o>/</span> <span class=mi>2</span><span class=p>)),</span>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a><a href=#__codelineno-0-241><span class=linenos data-linenos="241 "></span></a>            <span class=s2>&quot;x_max&quot;</span><span class=p>:</span> <span class=nb>min</span><span class=p>(</span><span class=n>width</span><span class=p>,</span> <span class=nb>int</span><span class=p>(</span><span class=n>width</span> <span class=o>/</span> <span class=mi>2</span> <span class=o>+</span> <span class=n>wr</span> <span class=o>/</span> <span class=mi>2</span><span class=p>)),</span>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a><a href=#__codelineno-0-242><span class=linenos data-linenos="242 "></span></a>            <span class=s2>&quot;y_min&quot;</span><span class=p>:</span> <span class=nb>max</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nb>int</span><span class=p>(</span><span class=n>height</span> <span class=o>/</span> <span class=mi>2</span> <span class=o>-</span> <span class=n>hr</span> <span class=o>/</span> <span class=mi>2</span><span class=p>)),</span>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a><a href=#__codelineno-0-243><span class=linenos data-linenos="243 "></span></a>            <span class=s2>&quot;y_max&quot;</span><span class=p>:</span> <span class=nb>min</span><span class=p>(</span><span class=n>height</span><span class=p>,</span> <span class=nb>int</span><span class=p>(</span><span class=n>height</span> <span class=o>/</span> <span class=mi>2</span> <span class=o>+</span> <span class=n>hr</span> <span class=o>/</span> <span class=mi>2</span><span class=p>)),</span>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a><a href=#__codelineno-0-244><span class=linenos data-linenos="244 "></span></a>        <span class=p>}</span>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a><a href=#__codelineno-0-245><span class=linenos data-linenos="245 "></span></a>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a><a href=#__codelineno-0-246><span class=linenos data-linenos="246 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>get_params_dependent_on_data</span><span class=p>(</span>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a><a href=#__codelineno-0-247><span class=linenos data-linenos="247 "></span></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a><a href=#__codelineno-0-248><span class=linenos data-linenos="248 "></span></a>        <span class=n>params</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>],</span>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a><a href=#__codelineno-0-249><span class=linenos data-linenos="249 "></span></a>        <span class=n>data</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>],</span>
</span><span id=__span-0-250><a id=__codelineno-0-250 name=__codelineno-0-250></a><a href=#__codelineno-0-250><span class=linenos data-linenos="250 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
</span><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a><a href=#__codelineno-0-251><span class=linenos data-linenos="251 "></span></a>        <span class=n>angle</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>py_random</span><span class=o>.</span><span class=n>uniform</span><span class=p>(</span><span class=o>*</span><span class=bp>self</span><span class=o>.</span><span class=n>limit</span><span class=p>)</span>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a><a href=#__codelineno-0-252><span class=linenos data-linenos="252 "></span></a>
</span><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a><a href=#__codelineno-0-253><span class=linenos data-linenos="253 "></span></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>crop_border</span><span class=p>:</span>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a><a href=#__codelineno-0-254><span class=linenos data-linenos="254 "></span></a>            <span class=n>height</span><span class=p>,</span> <span class=n>width</span> <span class=o>=</span> <span class=n>params</span><span class=p>[</span><span class=s2>&quot;shape&quot;</span><span class=p>][:</span><span class=mi>2</span><span class=p>]</span>
</span><span id=__span-0-255><a id=__codelineno-0-255 name=__codelineno-0-255></a><a href=#__codelineno-0-255><span class=linenos data-linenos="255 "></span></a>            <span class=n>out_params</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_rotated_rect_with_max_area</span><span class=p>(</span><span class=n>height</span><span class=p>,</span> <span class=n>width</span><span class=p>,</span> <span class=n>angle</span><span class=p>)</span>
</span><span id=__span-0-256><a id=__codelineno-0-256 name=__codelineno-0-256></a><a href=#__codelineno-0-256><span class=linenos data-linenos="256 "></span></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-257><a id=__codelineno-0-257 name=__codelineno-0-257></a><a href=#__codelineno-0-257><span class=linenos data-linenos="257 "></span></a>            <span class=n>out_params</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;x_min&quot;</span><span class=p>:</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=s2>&quot;x_max&quot;</span><span class=p>:</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=s2>&quot;y_min&quot;</span><span class=p>:</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=s2>&quot;y_max&quot;</span><span class=p>:</span> <span class=o>-</span><span class=mi>1</span><span class=p>}</span>
</span><span id=__span-0-258><a id=__codelineno-0-258 name=__codelineno-0-258></a><a href=#__codelineno-0-258><span class=linenos data-linenos="258 "></span></a>
</span><span id=__span-0-259><a id=__codelineno-0-259 name=__codelineno-0-259></a><a href=#__codelineno-0-259><span class=linenos data-linenos="259 "></span></a>        <span class=n>center</span> <span class=o>=</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>center</span><span class=p>(</span><span class=n>params</span><span class=p>[</span><span class=s2>&quot;shape&quot;</span><span class=p>][:</span><span class=mi>2</span><span class=p>])</span>
</span><span id=__span-0-260><a id=__codelineno-0-260 name=__codelineno-0-260></a><a href=#__codelineno-0-260><span class=linenos data-linenos="260 "></span></a>        <span class=n>bbox_center</span> <span class=o>=</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>center_bbox</span><span class=p>(</span><span class=n>params</span><span class=p>[</span><span class=s2>&quot;shape&quot;</span><span class=p>][:</span><span class=mi>2</span><span class=p>])</span>
</span><span id=__span-0-261><a id=__codelineno-0-261 name=__codelineno-0-261></a><a href=#__codelineno-0-261><span class=linenos data-linenos="261 "></span></a>
</span><span id=__span-0-262><a id=__codelineno-0-262 name=__codelineno-0-262></a><a href=#__codelineno-0-262><span class=linenos data-linenos="262 "></span></a>        <span class=n>translate</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>int</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;x&quot;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=s2>&quot;y&quot;</span><span class=p>:</span> <span class=mi>0</span><span class=p>}</span>
</span><span id=__span-0-263><a id=__codelineno-0-263 name=__codelineno-0-263></a><a href=#__codelineno-0-263><span class=linenos data-linenos="263 "></span></a>        <span class=n>shear</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>float</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;x&quot;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=s2>&quot;y&quot;</span><span class=p>:</span> <span class=mi>0</span><span class=p>}</span>
</span><span id=__span-0-264><a id=__codelineno-0-264 name=__codelineno-0-264></a><a href=#__codelineno-0-264><span class=linenos data-linenos="264 "></span></a>        <span class=n>scale</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>float</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;x&quot;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span> <span class=s2>&quot;y&quot;</span><span class=p>:</span> <span class=mi>1</span><span class=p>}</span>
</span><span id=__span-0-265><a id=__codelineno-0-265 name=__codelineno-0-265></a><a href=#__codelineno-0-265><span class=linenos data-linenos="265 "></span></a>        <span class=n>rotate</span> <span class=o>=</span> <span class=n>angle</span>
</span><span id=__span-0-266><a id=__codelineno-0-266 name=__codelineno-0-266></a><a href=#__codelineno-0-266><span class=linenos data-linenos="266 "></span></a>
</span><span id=__span-0-267><a id=__codelineno-0-267 name=__codelineno-0-267></a><a href=#__codelineno-0-267><span class=linenos data-linenos="267 "></span></a>        <span class=n>matrix</span> <span class=o>=</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>create_affine_transformation_matrix</span><span class=p>(</span>
</span><span id=__span-0-268><a id=__codelineno-0-268 name=__codelineno-0-268></a><a href=#__codelineno-0-268><span class=linenos data-linenos="268 "></span></a>            <span class=n>translate</span><span class=p>,</span>
</span><span id=__span-0-269><a id=__codelineno-0-269 name=__codelineno-0-269></a><a href=#__codelineno-0-269><span class=linenos data-linenos="269 "></span></a>            <span class=n>shear</span><span class=p>,</span>
</span><span id=__span-0-270><a id=__codelineno-0-270 name=__codelineno-0-270></a><a href=#__codelineno-0-270><span class=linenos data-linenos="270 "></span></a>            <span class=n>scale</span><span class=p>,</span>
</span><span id=__span-0-271><a id=__codelineno-0-271 name=__codelineno-0-271></a><a href=#__codelineno-0-271><span class=linenos data-linenos="271 "></span></a>            <span class=n>rotate</span><span class=p>,</span>
</span><span id=__span-0-272><a id=__codelineno-0-272 name=__codelineno-0-272></a><a href=#__codelineno-0-272><span class=linenos data-linenos="272 "></span></a>            <span class=n>center</span><span class=p>,</span>
</span><span id=__span-0-273><a id=__codelineno-0-273 name=__codelineno-0-273></a><a href=#__codelineno-0-273><span class=linenos data-linenos="273 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-274><a id=__codelineno-0-274 name=__codelineno-0-274></a><a href=#__codelineno-0-274><span class=linenos data-linenos="274 "></span></a>        <span class=n>bbox_matrix</span> <span class=o>=</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>create_affine_transformation_matrix</span><span class=p>(</span>
</span><span id=__span-0-275><a id=__codelineno-0-275 name=__codelineno-0-275></a><a href=#__codelineno-0-275><span class=linenos data-linenos="275 "></span></a>            <span class=n>translate</span><span class=p>,</span>
</span><span id=__span-0-276><a id=__codelineno-0-276 name=__codelineno-0-276></a><a href=#__codelineno-0-276><span class=linenos data-linenos="276 "></span></a>            <span class=n>shear</span><span class=p>,</span>
</span><span id=__span-0-277><a id=__codelineno-0-277 name=__codelineno-0-277></a><a href=#__codelineno-0-277><span class=linenos data-linenos="277 "></span></a>            <span class=n>scale</span><span class=p>,</span>
</span><span id=__span-0-278><a id=__codelineno-0-278 name=__codelineno-0-278></a><a href=#__codelineno-0-278><span class=linenos data-linenos="278 "></span></a>            <span class=n>rotate</span><span class=p>,</span>
</span><span id=__span-0-279><a id=__codelineno-0-279 name=__codelineno-0-279></a><a href=#__codelineno-0-279><span class=linenos data-linenos="279 "></span></a>            <span class=n>bbox_center</span><span class=p>,</span>
</span><span id=__span-0-280><a id=__codelineno-0-280 name=__codelineno-0-280></a><a href=#__codelineno-0-280><span class=linenos data-linenos="280 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-281><a id=__codelineno-0-281 name=__codelineno-0-281></a><a href=#__codelineno-0-281><span class=linenos data-linenos="281 "></span></a>        <span class=n>out_params</span><span class=p>[</span><span class=s2>&quot;matrix&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>matrix</span>
</span><span id=__span-0-282><a id=__codelineno-0-282 name=__codelineno-0-282></a><a href=#__codelineno-0-282><span class=linenos data-linenos="282 "></span></a>        <span class=n>out_params</span><span class=p>[</span><span class=s2>&quot;bbox_matrix&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>bbox_matrix</span>
</span><span id=__span-0-283><a id=__codelineno-0-283 name=__codelineno-0-283></a><a href=#__codelineno-0-283><span class=linenos data-linenos="283 "></span></a>
</span><span id=__span-0-284><a id=__codelineno-0-284 name=__codelineno-0-284></a><a href=#__codelineno-0-284><span class=linenos data-linenos="284 "></span></a>        <span class=k>return</span> <span class=n>out_params</span>
</span><span id=__span-0-285><a id=__codelineno-0-285 name=__codelineno-0-285></a><a href=#__codelineno-0-285><span class=linenos data-linenos="285 "></span></a>
</span><span id=__span-0-286><a id=__codelineno-0-286 name=__codelineno-0-286></a><a href=#__codelineno-0-286><span class=linenos data-linenos="286 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>get_transform_init_args_names</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>tuple</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=o>...</span><span class=p>]:</span>
</span><span id=__span-0-287><a id=__codelineno-0-287 name=__codelineno-0-287></a><a href=#__codelineno-0-287><span class=linenos data-linenos="287 "></span></a>        <span class=k>return</span> <span class=p>(</span>
</span><span id=__span-0-288><a id=__codelineno-0-288 name=__codelineno-0-288></a><a href=#__codelineno-0-288><span class=linenos data-linenos="288 "></span></a>            <span class=s2>&quot;limit&quot;</span><span class=p>,</span>
</span><span id=__span-0-289><a id=__codelineno-0-289 name=__codelineno-0-289></a><a href=#__codelineno-0-289><span class=linenos data-linenos="289 "></span></a>            <span class=s2>&quot;interpolation&quot;</span><span class=p>,</span>
</span><span id=__span-0-290><a id=__codelineno-0-290 name=__codelineno-0-290></a><a href=#__codelineno-0-290><span class=linenos data-linenos="290 "></span></a>            <span class=s2>&quot;border_mode&quot;</span><span class=p>,</span>
</span><span id=__span-0-291><a id=__codelineno-0-291 name=__codelineno-0-291></a><a href=#__codelineno-0-291><span class=linenos data-linenos="291 "></span></a>            <span class=s2>&quot;fill&quot;</span><span class=p>,</span>
</span><span id=__span-0-292><a id=__codelineno-0-292 name=__codelineno-0-292></a><a href=#__codelineno-0-292><span class=linenos data-linenos="292 "></span></a>            <span class=s2>&quot;fill_mask&quot;</span><span class=p>,</span>
</span><span id=__span-0-293><a id=__codelineno-0-293 name=__codelineno-0-293></a><a href=#__codelineno-0-293><span class=linenos data-linenos="293 "></span></a>            <span class=s2>&quot;rotate_method&quot;</span><span class=p>,</span>
</span><span id=__span-0-294><a id=__codelineno-0-294 name=__codelineno-0-294></a><a href=#__codelineno-0-294><span class=linenos data-linenos="294 "></span></a>            <span class=s2>&quot;crop_border&quot;</span><span class=p>,</span>
</span><span id=__span-0-295><a id=__codelineno-0-295 name=__codelineno-0-295></a><a href=#__codelineno-0-295><span class=linenos data-linenos="295 "></span></a>            <span class=s2>&quot;mask_interpolation&quot;</span><span class=p>,</span>
</span><span id=__span-0-296><a id=__codelineno-0-296 name=__codelineno-0-296></a><a href=#__codelineno-0-296><span class=linenos data-linenos="296 "></span></a>        <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-class"> <h2 id=albumentations.augmentations.geometric.rotate.RotateInitSchema class="doc doc-heading" data-toc-label=RotateInitSchema> <code>class <strong> RotateInitSchema</strong></code> <code> </code> <a class=headerlink href=#albumentations.augmentations.geometric.rotate.RotateInitSchema title="Permanent link">¶</a> </h2> <div class=class-signature> </div> <div class="doc doc-contents "> <div class="admonition info"> <p class=admonition-title><strong>Interactive Tool Available!</strong></p> <p> <strong>Explore this transform visually and adjust parameters interactively using this tool:</strong> </p> <p> <a class="md-button md-button--primary" href=https://explore.albumentations.ai/transform/RotateInitSchema target=_blank>Open Tool</a> </p> </div> <details class=quote> <summary>Source code in <code>albumentations/augmentations/geometric/rotate.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1></a><a href=#__codelineno-0-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>class</span><span class=w> </span><span class=nc>RotateInitSchema</span><span class=p>(</span><span class=n>BaseTransformInitSchema</span><span class=p>):</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2></a><a href=#__codelineno-0-2><span class=linenos data-linenos=" 2 "></span></a>    <span class=n>limit</span><span class=p>:</span> <span class=n>SymmetricRangeType</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3></a><a href=#__codelineno-0-3><span class=linenos data-linenos=" 3 "></span></a>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4></a><a href=#__codelineno-0-4><span class=linenos data-linenos=" 4 "></span></a>    <span class=n>interpolation</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=n>cv2</span><span class=o>.</span><span class=n>INTER_NEAREST</span><span class=p>,</span> <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_LINEAR</span><span class=p>,</span> <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_CUBIC</span><span class=p>,</span> <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_AREA</span><span class=p>,</span> <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_LANCZOS4</span><span class=p>]</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5></a><a href=#__codelineno-0-5><span class=linenos data-linenos=" 5 "></span></a>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6></a><a href=#__codelineno-0-6><span class=linenos data-linenos=" 6 "></span></a>    <span class=n>mask_interpolation</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7></a><a href=#__codelineno-0-7><span class=linenos data-linenos=" 7 "></span></a>        <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_NEAREST</span><span class=p>,</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8></a><a href=#__codelineno-0-8><span class=linenos data-linenos=" 8 "></span></a>        <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_LINEAR</span><span class=p>,</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9></a><a href=#__codelineno-0-9><span class=linenos data-linenos=" 9 "></span></a>        <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_CUBIC</span><span class=p>,</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10></a><a href=#__codelineno-0-10><span class=linenos data-linenos="10 "></span></a>        <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_AREA</span><span class=p>,</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11></a><a href=#__codelineno-0-11><span class=linenos data-linenos="11 "></span></a>        <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_LANCZOS4</span><span class=p>,</span>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12></a><a href=#__codelineno-0-12><span class=linenos data-linenos="12 "></span></a>    <span class=p>]</span>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13></a><a href=#__codelineno-0-13><span class=linenos data-linenos="13 "></span></a>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14></a><a href=#__codelineno-0-14><span class=linenos data-linenos="14 "></span></a>    <span class=n>border_mode</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span>
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15></a><a href=#__codelineno-0-15><span class=linenos data-linenos="15 "></span></a>        <span class=n>cv2</span><span class=o>.</span><span class=n>BORDER_CONSTANT</span><span class=p>,</span>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16></a><a href=#__codelineno-0-16><span class=linenos data-linenos="16 "></span></a>        <span class=n>cv2</span><span class=o>.</span><span class=n>BORDER_REPLICATE</span><span class=p>,</span>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17></a><a href=#__codelineno-0-17><span class=linenos data-linenos="17 "></span></a>        <span class=n>cv2</span><span class=o>.</span><span class=n>BORDER_REFLECT</span><span class=p>,</span>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18></a><a href=#__codelineno-0-18><span class=linenos data-linenos="18 "></span></a>        <span class=n>cv2</span><span class=o>.</span><span class=n>BORDER_WRAP</span><span class=p>,</span>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19></a><a href=#__codelineno-0-19><span class=linenos data-linenos="19 "></span></a>        <span class=n>cv2</span><span class=o>.</span><span class=n>BORDER_REFLECT_101</span><span class=p>,</span>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20></a><a href=#__codelineno-0-20><span class=linenos data-linenos="20 "></span></a>        <span class=n>cv2</span><span class=o>.</span><span class=n>BORDER_REFLECT101</span><span class=p>,</span>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21></a><a href=#__codelineno-0-21><span class=linenos data-linenos="21 "></span></a>    <span class=p>]</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22></a><a href=#__codelineno-0-22><span class=linenos data-linenos="22 "></span></a>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23></a><a href=#__codelineno-0-23><span class=linenos data-linenos="23 "></span></a>    <span class=n>fill</span><span class=p>:</span> <span class=nb>tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=o>...</span><span class=p>]</span> <span class=o>|</span> <span class=nb>float</span>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a><a href=#__codelineno-0-24><span class=linenos data-linenos="24 "></span></a>    <span class=n>fill_mask</span><span class=p>:</span> <span class=nb>tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=o>...</span><span class=p>]</span> <span class=o>|</span> <span class=nb>float</span> <span class=o>|</span> <span class=kc>None</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-class"> <h2 id=albumentations.augmentations.geometric.rotate.SafeRotate class="doc doc-heading" data-toc-label=SafeRotate> <code>class <strong> SafeRotate</strong></code> <code> (limit=(-90, 90), interpolation=1, border_mode=0, rotate_method=&#39;largest_box&#39;, mask_interpolation=0, fill=0, fill_mask=0, p=0.5) </code> <span class=doc-github-link> <a href=https://github.com/albumentations-team/albumentations/blob/main/albumentations/augmentations/geometric/rotate.py#L20 target=_blank>[view source on GitHub]</a> </span><a class=headerlink href=#albumentations.augmentations.geometric.rotate.SafeRotate title="Permanent link">¶</a> </h2> <div class=class-signature> </div> <div class="doc doc-contents "> <p>Rotate the input inside the input's frame by an angle selected randomly from the uniform distribution.</p> <p>This transformation ensures that the entire rotated image fits within the original frame by scaling it down if necessary. The resulting image maintains its original dimensions but may contain artifacts due to the rotation and scaling process.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>limit</code></td> <td><code>float | tuple[float, float]</code></td> <td><p>Range from which a random angle is picked. If limit is a single float, an angle is picked from (-limit, limit). Default: (-90, 90)</p></td> </tr> <tr> <td><code>interpolation</code></td> <td><code>OpenCV flag</code></td> <td><p>Flag that is used to specify the interpolation algorithm. Should be one of: cv2.INTER_NEAREST, cv2.INTER_LINEAR, cv2.INTER_CUBIC, cv2.INTER_AREA, cv2.INTER_LANCZOS4. Default: cv2.INTER_LINEAR.</p></td> </tr> <tr> <td><code>border_mode</code></td> <td><code>OpenCV flag</code></td> <td><p>Flag that is used to specify the pixel extrapolation method. Should be one of: cv2.BORDER_CONSTANT, cv2.BORDER_REPLICATE, cv2.BORDER_REFLECT, cv2.BORDER_WRAP, cv2.BORDER_REFLECT_101. Default: cv2.BORDER_REFLECT_101</p></td> </tr> <tr> <td><code>fill</code></td> <td><code>tuple[float, float] | float</code></td> <td><p>Padding value if border_mode is cv2.BORDER_CONSTANT.</p></td> </tr> <tr> <td><code>fill_mask</code></td> <td><code>tuple[float, float] | float</code></td> <td><p>Padding value if border_mode is cv2.BORDER_CONSTANT applied for masks.</p></td> </tr> <tr> <td><code>rotate_method</code></td> <td><code>Literal[&#34;largest_box&#34;, &#34;ellipse&#34;]</code></td> <td><p>Method to rotate bounding boxes. Should be 'largest_box' or 'ellipse'. Default: 'largest_box'</p></td> </tr> <tr> <td><code>mask_interpolation</code></td> <td><code>OpenCV flag</code></td> <td><p>flag that is used to specify the interpolation algorithm for mask. Should be one of: cv2.INTER_NEAREST, cv2.INTER_LINEAR, cv2.INTER_CUBIC, cv2.INTER_AREA, cv2.INTER_LANCZOS4. Default: cv2.INTER_NEAREST.</p></td> </tr> <tr> <td><code>p</code></td> <td><code>float</code></td> <td><p>Probability of applying the transform. Default: 0.5.</p></td> </tr> </tbody> </table> <div class="admonition targets"> <p class=admonition-title>Targets</p> <p>image, mask, bboxes, keypoints, volume, mask3d</p> </div> <p>Image types: uint8, float32</p> <div class="admonition note"> <p class=admonition-title>Note</p> <ul> <li>The rotation is performed around the center of the image.</li> <li>After rotation, the image is scaled to fit within the original frame, which may cause some distortion.</li> <li>The output image will always have the same dimensions as the input image.</li> <li>Bounding boxes and keypoints are transformed along with the image.</li> </ul> </div> <p>Mathematical Details: 1. An angle θ is randomly sampled from the range specified by 'limit'. 2. The image is rotated around its center by θ degrees. 3. The rotation matrix R is: R = [cos(θ) -sin(θ)] [sin(θ) cos(θ)] 4. The scaling factor s is calculated to ensure the rotated image fits within the original frame: s = min(width / (width * |cos(θ)| + height * |sin(θ)|), height / (width * |sin(θ)| + height * |cos(θ)|)) 5. The combined transformation matrix T is: T = [s<em>cos(θ) -s</em>sin(θ) tx] [s<em>sin(θ) s</em>cos(θ) ty] where tx and ty are translation factors to keep the image centered. 6. Each point (x, y) in the image is transformed to (x', y') by: [x'] [s<em>cos(θ) s</em>sin(θ)][x - cx] [cx] [y'] = [-s<em>sin(θ) s</em>cos(θ)][y - cy] + [cy] where (cx, cy) is the center of the image.</p> <p><strong>Examples:</strong></p> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=o>&gt;&gt;&gt;</span> <span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=o>&gt;&gt;&gt;</span> <span class=kn>import</span><span class=w> </span><span class=nn>albumentations</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>A</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=o>&gt;&gt;&gt;</span> <span class=n>image</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>256</span><span class=p>,</span> <span class=p>(</span><span class=mi>100</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>3</span><span class=p>),</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>uint8</span><span class=p>)</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=o>&gt;&gt;&gt;</span> <span class=n>transform</span> <span class=o>=</span> <span class=n>A</span><span class=o>.</span><span class=n>SafeRotate</span><span class=p>(</span><span class=n>limit</span><span class=o>=</span><span class=mi>45</span><span class=p>,</span> <span class=n>p</span><span class=o>=</span><span class=mf>1.0</span><span class=p>)</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=o>&gt;&gt;&gt;</span> <span class=n>result</span> <span class=o>=</span> <span class=n>transform</span><span class=p>(</span><span class=n>image</span><span class=o>=</span><span class=n>image</span><span class=p>)</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=o>&gt;&gt;&gt;</span> <span class=n>rotated_image</span> <span class=o>=</span> <span class=n>result</span><span class=p>[</span><span class=s1>&#39;image&#39;</span><span class=p>]</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=c1># rotated_image will be the input image rotated by a random angle between -45 and 45 degrees,</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=c1># scaled to fit within the original 100x100 frame</span>
</span></code></pre></div> <div class="admonition info"> <p class=admonition-title><strong>Interactive Tool Available!</strong></p> <p> <strong>Explore this transform visually and adjust parameters interactively using this tool:</strong> </p> <p> <a class="md-button md-button--primary" href=https://explore.albumentations.ai/transform/SafeRotate target=_blank>Open Tool</a> </p> </div> <details class=quote> <summary>Source code in <code>albumentations/augmentations/geometric/rotate.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1></a><a href=#__codelineno-0-1><span class=linenos data-linenos="  1 "></span></a><span class=k>class</span><span class=w> </span><span class=nc>SafeRotate</span><span class=p>(</span><span class=n>Affine</span><span class=p>):</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2></a><a href=#__codelineno-0-2><span class=linenos data-linenos="  2 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Rotate the input inside the input&#39;s frame by an angle selected randomly from the uniform distribution.</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3></a><a href=#__codelineno-0-3><span class=linenos data-linenos="  3 "></span></a>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4></a><a href=#__codelineno-0-4><span class=linenos data-linenos="  4 "></span></a><span class=sd>    This transformation ensures that the entire rotated image fits within the original frame by scaling it</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5></a><a href=#__codelineno-0-5><span class=linenos data-linenos="  5 "></span></a><span class=sd>    down if necessary. The resulting image maintains its original dimensions but may contain artifacts due to the</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6></a><a href=#__codelineno-0-6><span class=linenos data-linenos="  6 "></span></a><span class=sd>    rotation and scaling process.</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7></a><a href=#__codelineno-0-7><span class=linenos data-linenos="  7 "></span></a>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8></a><a href=#__codelineno-0-8><span class=linenos data-linenos="  8 "></span></a><span class=sd>    Args:</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9></a><a href=#__codelineno-0-9><span class=linenos data-linenos="  9 "></span></a><span class=sd>        limit (float | tuple[float, float]): Range from which a random angle is picked. If limit is a single float,</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10></a><a href=#__codelineno-0-10><span class=linenos data-linenos=" 10 "></span></a><span class=sd>            an angle is picked from (-limit, limit). Default: (-90, 90)</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11></a><a href=#__codelineno-0-11><span class=linenos data-linenos=" 11 "></span></a><span class=sd>        interpolation (OpenCV flag): Flag that is used to specify the interpolation algorithm. Should be one of:</span>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12></a><a href=#__codelineno-0-12><span class=linenos data-linenos=" 12 "></span></a><span class=sd>            cv2.INTER_NEAREST, cv2.INTER_LINEAR, cv2.INTER_CUBIC, cv2.INTER_AREA, cv2.INTER_LANCZOS4.</span>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13></a><a href=#__codelineno-0-13><span class=linenos data-linenos=" 13 "></span></a><span class=sd>            Default: cv2.INTER_LINEAR.</span>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14></a><a href=#__codelineno-0-14><span class=linenos data-linenos=" 14 "></span></a><span class=sd>        border_mode (OpenCV flag): Flag that is used to specify the pixel extrapolation method. Should be one of:</span>
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15></a><a href=#__codelineno-0-15><span class=linenos data-linenos=" 15 "></span></a><span class=sd>            cv2.BORDER_CONSTANT, cv2.BORDER_REPLICATE, cv2.BORDER_REFLECT, cv2.BORDER_WRAP, cv2.BORDER_REFLECT_101.</span>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16></a><a href=#__codelineno-0-16><span class=linenos data-linenos=" 16 "></span></a><span class=sd>            Default: cv2.BORDER_REFLECT_101</span>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17></a><a href=#__codelineno-0-17><span class=linenos data-linenos=" 17 "></span></a><span class=sd>        fill (tuple[float, float] | float): Padding value if border_mode is cv2.BORDER_CONSTANT.</span>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18></a><a href=#__codelineno-0-18><span class=linenos data-linenos=" 18 "></span></a><span class=sd>        fill_mask (tuple[float, float] | float): Padding value if border_mode is cv2.BORDER_CONSTANT applied</span>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19></a><a href=#__codelineno-0-19><span class=linenos data-linenos=" 19 "></span></a><span class=sd>            for masks.</span>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20></a><a href=#__codelineno-0-20><span class=linenos data-linenos=" 20 "></span></a><span class=sd>        rotate_method (Literal[&quot;largest_box&quot;, &quot;ellipse&quot;]): Method to rotate bounding boxes.</span>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21></a><a href=#__codelineno-0-21><span class=linenos data-linenos=" 21 "></span></a><span class=sd>            Should be &#39;largest_box&#39; or &#39;ellipse&#39;. Default: &#39;largest_box&#39;</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22></a><a href=#__codelineno-0-22><span class=linenos data-linenos=" 22 "></span></a><span class=sd>        mask_interpolation (OpenCV flag): flag that is used to specify the interpolation algorithm for mask.</span>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23></a><a href=#__codelineno-0-23><span class=linenos data-linenos=" 23 "></span></a><span class=sd>            Should be one of: cv2.INTER_NEAREST, cv2.INTER_LINEAR, cv2.INTER_CUBIC, cv2.INTER_AREA, cv2.INTER_LANCZOS4.</span>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a><a href=#__codelineno-0-24><span class=linenos data-linenos=" 24 "></span></a><span class=sd>            Default: cv2.INTER_NEAREST.</span>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a><a href=#__codelineno-0-25><span class=linenos data-linenos=" 25 "></span></a><span class=sd>        p (float): Probability of applying the transform. Default: 0.5.</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a><a href=#__codelineno-0-26><span class=linenos data-linenos=" 26 "></span></a>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a><a href=#__codelineno-0-27><span class=linenos data-linenos=" 27 "></span></a><span class=sd>    Targets:</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a><a href=#__codelineno-0-28><span class=linenos data-linenos=" 28 "></span></a><span class=sd>        image, mask, bboxes, keypoints, volume, mask3d</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a><a href=#__codelineno-0-29><span class=linenos data-linenos=" 29 "></span></a>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a><a href=#__codelineno-0-30><span class=linenos data-linenos=" 30 "></span></a><span class=sd>    Image types:</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a><a href=#__codelineno-0-31><span class=linenos data-linenos=" 31 "></span></a><span class=sd>        uint8, float32</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a><a href=#__codelineno-0-32><span class=linenos data-linenos=" 32 "></span></a>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a><a href=#__codelineno-0-33><span class=linenos data-linenos=" 33 "></span></a><span class=sd>    Note:</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a><a href=#__codelineno-0-34><span class=linenos data-linenos=" 34 "></span></a><span class=sd>        - The rotation is performed around the center of the image.</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a><a href=#__codelineno-0-35><span class=linenos data-linenos=" 35 "></span></a><span class=sd>        - After rotation, the image is scaled to fit within the original frame, which may cause some distortion.</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a><a href=#__codelineno-0-36><span class=linenos data-linenos=" 36 "></span></a><span class=sd>        - The output image will always have the same dimensions as the input image.</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a><a href=#__codelineno-0-37><span class=linenos data-linenos=" 37 "></span></a><span class=sd>        - Bounding boxes and keypoints are transformed along with the image.</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a><a href=#__codelineno-0-38><span class=linenos data-linenos=" 38 "></span></a>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a><a href=#__codelineno-0-39><span class=linenos data-linenos=" 39 "></span></a><span class=sd>    Mathematical Details:</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a><a href=#__codelineno-0-40><span class=linenos data-linenos=" 40 "></span></a><span class=sd>        1. An angle θ is randomly sampled from the range specified by &#39;limit&#39;.</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a><a href=#__codelineno-0-41><span class=linenos data-linenos=" 41 "></span></a><span class=sd>        2. The image is rotated around its center by θ degrees.</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><a href=#__codelineno-0-42><span class=linenos data-linenos=" 42 "></span></a><span class=sd>        3. The rotation matrix R is:</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos=" 43 "></span></a><span class=sd>           R = [cos(θ)  -sin(θ)]</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos=" 44 "></span></a><span class=sd>               [sin(θ)   cos(θ)]</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos=" 45 "></span></a><span class=sd>        4. The scaling factor s is calculated to ensure the rotated image fits within the original frame:</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos=" 46 "></span></a><span class=sd>           s = min(width / (width * |cos(θ)| + height * |sin(θ)|),</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos=" 47 "></span></a><span class=sd>                   height / (width * |sin(θ)| + height * |cos(θ)|))</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos=" 48 "></span></a><span class=sd>        5. The combined transformation matrix T is:</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos=" 49 "></span></a><span class=sd>           T = [s*cos(θ)  -s*sin(θ)  tx]</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos=" 50 "></span></a><span class=sd>               [s*sin(θ)   s*cos(θ)  ty]</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos=" 51 "></span></a><span class=sd>           where tx and ty are translation factors to keep the image centered.</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos=" 52 "></span></a><span class=sd>        6. Each point (x, y) in the image is transformed to (x&#39;, y&#39;) by:</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a><span class=sd>           [x&#39;]   [s*cos(θ)   s*sin(θ)] [x - cx]   [cx]</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a><span class=sd>           [y&#39;] = [-s*sin(θ)  s*cos(θ)] [y - cy] + [cy]</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a><span class=sd>           where (cx, cy) is the center of the image.</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a><span class=sd>    Example:</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a><span class=sd>        &gt;&gt;&gt; import numpy as np</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a><span class=sd>        &gt;&gt;&gt; import albumentations as A</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a><span class=sd>        &gt;&gt;&gt; image = np.random.randint(0, 256, (100, 100, 3), dtype=np.uint8)</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a><span class=sd>        &gt;&gt;&gt; transform = A.SafeRotate(limit=45, p=1.0)</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a><span class=sd>        &gt;&gt;&gt; result = transform(image=image)</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a><span class=sd>        &gt;&gt;&gt; rotated_image = result[&#39;image&#39;]</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a><span class=sd>        # rotated_image will be the input image rotated by a random angle between -45 and 45 degrees,</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a><span class=sd>        # scaled to fit within the original 100x100 frame</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a>    <span class=n>_targets</span> <span class=o>=</span> <span class=n>ALL_TARGETS</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a>    <span class=k>class</span><span class=w> </span><span class=nc>InitSchema</span><span class=p>(</span><span class=n>RotateInitSchema</span><span class=p>):</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a>        <span class=n>rotate_method</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;largest_box&quot;</span><span class=p>,</span> <span class=s2>&quot;ellipse&quot;</span><span class=p>]</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a>        <span class=n>limit</span><span class=p>:</span> <span class=nb>tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>]</span> <span class=o>|</span> <span class=nb>float</span> <span class=o>=</span> <span class=p>(</span><span class=o>-</span><span class=mi>90</span><span class=p>,</span> <span class=mi>90</span><span class=p>),</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a>        <span class=n>interpolation</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a>            <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_NEAREST</span><span class=p>,</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a>            <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_LINEAR</span><span class=p>,</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a>            <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_CUBIC</span><span class=p>,</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a>            <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_AREA</span><span class=p>,</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a>            <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_LANCZOS4</span><span class=p>,</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a>        <span class=p>]</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_LINEAR</span><span class=p>,</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a>        <span class=n>border_mode</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a>            <span class=n>cv2</span><span class=o>.</span><span class=n>BORDER_CONSTANT</span><span class=p>,</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a>            <span class=n>cv2</span><span class=o>.</span><span class=n>BORDER_REPLICATE</span><span class=p>,</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a>            <span class=n>cv2</span><span class=o>.</span><span class=n>BORDER_REFLECT</span><span class=p>,</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a>            <span class=n>cv2</span><span class=o>.</span><span class=n>BORDER_WRAP</span><span class=p>,</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a>            <span class=n>cv2</span><span class=o>.</span><span class=n>BORDER_REFLECT_101</span><span class=p>,</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a>            <span class=n>cv2</span><span class=o>.</span><span class=n>BORDER_REFLECT101</span><span class=p>,</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a>        <span class=p>]</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>BORDER_CONSTANT</span><span class=p>,</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a>        <span class=n>rotate_method</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;largest_box&quot;</span><span class=p>,</span> <span class=s2>&quot;ellipse&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&quot;largest_box&quot;</span><span class=p>,</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a>        <span class=n>mask_interpolation</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a>            <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_NEAREST</span><span class=p>,</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a>            <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_LINEAR</span><span class=p>,</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a>            <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_CUBIC</span><span class=p>,</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a>            <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_AREA</span><span class=p>,</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a>            <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_LANCZOS4</span><span class=p>,</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a>        <span class=p>]</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_NEAREST</span><span class=p>,</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a>        <span class=n>fill</span><span class=p>:</span> <span class=nb>tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=o>...</span><span class=p>]</span> <span class=o>|</span> <span class=nb>float</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a>        <span class=n>fill_mask</span><span class=p>:</span> <span class=nb>tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=o>...</span><span class=p>]</span> <span class=o>|</span> <span class=nb>float</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a>        <span class=n>p</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.5</span><span class=p>,</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a>    <span class=p>):</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a>            <span class=n>rotate</span><span class=o>=</span><span class=n>limit</span><span class=p>,</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a>            <span class=n>interpolation</span><span class=o>=</span><span class=n>interpolation</span><span class=p>,</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>            <span class=n>border_mode</span><span class=o>=</span><span class=n>border_mode</span><span class=p>,</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>            <span class=n>fill</span><span class=o>=</span><span class=n>fill</span><span class=p>,</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>            <span class=n>fill_mask</span><span class=o>=</span><span class=n>fill_mask</span><span class=p>,</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a>            <span class=n>rotate_method</span><span class=o>=</span><span class=n>rotate_method</span><span class=p>,</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a>            <span class=n>fit_output</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a>            <span class=n>mask_interpolation</span><span class=o>=</span><span class=n>mask_interpolation</span><span class=p>,</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a>            <span class=n>p</span><span class=o>=</span><span class=n>p</span><span class=p>,</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>limit</span> <span class=o>=</span> <span class=n>cast</span><span class=p>(</span><span class=nb>tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>],</span> <span class=n>limit</span><span class=p>)</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>interpolation</span> <span class=o>=</span> <span class=n>interpolation</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>border_mode</span> <span class=o>=</span> <span class=n>border_mode</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>fill</span> <span class=o>=</span> <span class=n>fill</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>fill_mask</span> <span class=o>=</span> <span class=n>fill_mask</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>rotate_method</span> <span class=o>=</span> <span class=n>rotate_method</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>mask_interpolation</span> <span class=o>=</span> <span class=n>mask_interpolation</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>get_transform_init_args_names</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>tuple</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=o>...</span><span class=p>]:</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a>        <span class=k>return</span> <span class=p>(</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a>            <span class=s2>&quot;limit&quot;</span><span class=p>,</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a>            <span class=s2>&quot;interpolation&quot;</span><span class=p>,</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a>            <span class=s2>&quot;border_mode&quot;</span><span class=p>,</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a>            <span class=s2>&quot;fill&quot;</span><span class=p>,</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a>            <span class=s2>&quot;fill_mask&quot;</span><span class=p>,</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a>            <span class=s2>&quot;rotate_method&quot;</span><span class=p>,</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a>            <span class=s2>&quot;mask_interpolation&quot;</span><span class=p>,</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>_create_safe_rotate_matrix</span><span class=p>(</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a>        <span class=n>angle</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a>        <span class=n>center</span><span class=p>:</span> <span class=nb>tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>],</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a>        <span class=n>image_shape</span><span class=p>:</span> <span class=nb>tuple</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=nb>int</span><span class=p>],</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>tuple</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>float</span><span class=p>]]:</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a>        <span class=n>height</span><span class=p>,</span> <span class=n>width</span> <span class=o>=</span> <span class=n>image_shape</span><span class=p>[:</span><span class=mi>2</span><span class=p>]</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a>        <span class=n>rotation_mat</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>getRotationMatrix2D</span><span class=p>(</span><span class=n>center</span><span class=p>,</span> <span class=n>angle</span><span class=p>,</span> <span class=mf>1.0</span><span class=p>)</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a>        <span class=c1># Calculate new image size</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a>        <span class=n>abs_cos</span> <span class=o>=</span> <span class=nb>abs</span><span class=p>(</span><span class=n>rotation_mat</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>])</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a>        <span class=n>abs_sin</span> <span class=o>=</span> <span class=nb>abs</span><span class=p>(</span><span class=n>rotation_mat</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>])</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a>        <span class=n>new_w</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>height</span> <span class=o>*</span> <span class=n>abs_sin</span> <span class=o>+</span> <span class=n>width</span> <span class=o>*</span> <span class=n>abs_cos</span><span class=p>)</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a>        <span class=n>new_h</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>height</span> <span class=o>*</span> <span class=n>abs_cos</span> <span class=o>+</span> <span class=n>width</span> <span class=o>*</span> <span class=n>abs_sin</span><span class=p>)</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a>        <span class=c1># Adjust the rotation matrix to take into account the new size</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a>        <span class=n>rotation_mat</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>2</span><span class=p>]</span> <span class=o>+=</span> <span class=n>new_w</span> <span class=o>/</span> <span class=mi>2</span> <span class=o>-</span> <span class=n>center</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a>        <span class=n>rotation_mat</span><span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>]</span> <span class=o>+=</span> <span class=n>new_h</span> <span class=o>/</span> <span class=mi>2</span> <span class=o>-</span> <span class=n>center</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><a href=#__codelineno-0-152><span class=linenos data-linenos="152 "></span></a>        <span class=c1># Calculate scaling factors</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><a href=#__codelineno-0-153><span class=linenos data-linenos="153 "></span></a>        <span class=n>scale_x</span> <span class=o>=</span> <span class=n>width</span> <span class=o>/</span> <span class=n>new_w</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><a href=#__codelineno-0-154><span class=linenos data-linenos="154 "></span></a>        <span class=n>scale_y</span> <span class=o>=</span> <span class=n>height</span> <span class=o>/</span> <span class=n>new_h</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><a href=#__codelineno-0-155><span class=linenos data-linenos="155 "></span></a>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><a href=#__codelineno-0-156><span class=linenos data-linenos="156 "></span></a>        <span class=c1># Create scaling matrix</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><a href=#__codelineno-0-157><span class=linenos data-linenos="157 "></span></a>        <span class=n>scale_mat</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([[</span><span class=n>scale_x</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=n>scale_y</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>]])</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><a href=#__codelineno-0-158><span class=linenos data-linenos="158 "></span></a>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><a href=#__codelineno-0-159><span class=linenos data-linenos="159 "></span></a>        <span class=c1># Combine rotation and scaling</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><a href=#__codelineno-0-160><span class=linenos data-linenos="160 "></span></a>        <span class=n>matrix</span> <span class=o>=</span> <span class=n>scale_mat</span> <span class=o>@</span> <span class=n>np</span><span class=o>.</span><span class=n>vstack</span><span class=p>([</span><span class=n>rotation_mat</span><span class=p>,</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>]])</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><a href=#__codelineno-0-161><span class=linenos data-linenos="161 "></span></a>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><a href=#__codelineno-0-162><span class=linenos data-linenos="162 "></span></a>        <span class=k>return</span> <span class=n>matrix</span><span class=p>,</span> <span class=p>{</span><span class=s2>&quot;x&quot;</span><span class=p>:</span> <span class=n>scale_x</span><span class=p>,</span> <span class=s2>&quot;y&quot;</span><span class=p>:</span> <span class=n>scale_y</span><span class=p>}</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><a href=#__codelineno-0-163><span class=linenos data-linenos="163 "></span></a>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><a href=#__codelineno-0-164><span class=linenos data-linenos="164 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>get_params_dependent_on_data</span><span class=p>(</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><a href=#__codelineno-0-165><span class=linenos data-linenos="165 "></span></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><a href=#__codelineno-0-166><span class=linenos data-linenos="166 "></span></a>        <span class=n>params</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>],</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><a href=#__codelineno-0-167><span class=linenos data-linenos="167 "></span></a>        <span class=n>data</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>],</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><a href=#__codelineno-0-168><span class=linenos data-linenos="168 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a><a href=#__codelineno-0-169><span class=linenos data-linenos="169 "></span></a>        <span class=n>image_shape</span> <span class=o>=</span> <span class=n>params</span><span class=p>[</span><span class=s2>&quot;shape&quot;</span><span class=p>][:</span><span class=mi>2</span><span class=p>]</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a><a href=#__codelineno-0-170><span class=linenos data-linenos="170 "></span></a>        <span class=n>angle</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>py_random</span><span class=o>.</span><span class=n>uniform</span><span class=p>(</span><span class=o>*</span><span class=bp>self</span><span class=o>.</span><span class=n>limit</span><span class=p>)</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a><a href=#__codelineno-0-171><span class=linenos data-linenos="171 "></span></a>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a><a href=#__codelineno-0-172><span class=linenos data-linenos="172 "></span></a>        <span class=c1># Calculate centers for image and bbox</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a><a href=#__codelineno-0-173><span class=linenos data-linenos="173 "></span></a>        <span class=n>image_center</span> <span class=o>=</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>center</span><span class=p>(</span><span class=n>image_shape</span><span class=p>)</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a><a href=#__codelineno-0-174><span class=linenos data-linenos="174 "></span></a>        <span class=n>bbox_center</span> <span class=o>=</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>center_bbox</span><span class=p>(</span><span class=n>image_shape</span><span class=p>)</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a><a href=#__codelineno-0-175><span class=linenos data-linenos="175 "></span></a>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a><a href=#__codelineno-0-176><span class=linenos data-linenos="176 "></span></a>        <span class=c1># Create matrices for image and bbox</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a><a href=#__codelineno-0-177><span class=linenos data-linenos="177 "></span></a>        <span class=n>matrix</span><span class=p>,</span> <span class=n>scale</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_create_safe_rotate_matrix</span><span class=p>(</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a><a href=#__codelineno-0-178><span class=linenos data-linenos="178 "></span></a>            <span class=n>angle</span><span class=p>,</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a><a href=#__codelineno-0-179><span class=linenos data-linenos="179 "></span></a>            <span class=n>image_center</span><span class=p>,</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a><a href=#__codelineno-0-180><span class=linenos data-linenos="180 "></span></a>            <span class=n>image_shape</span><span class=p>,</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a><a href=#__codelineno-0-181><span class=linenos data-linenos="181 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a><a href=#__codelineno-0-182><span class=linenos data-linenos="182 "></span></a>        <span class=n>bbox_matrix</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_create_safe_rotate_matrix</span><span class=p>(</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a><a href=#__codelineno-0-183><span class=linenos data-linenos="183 "></span></a>            <span class=n>angle</span><span class=p>,</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a><a href=#__codelineno-0-184><span class=linenos data-linenos="184 "></span></a>            <span class=n>bbox_center</span><span class=p>,</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a><a href=#__codelineno-0-185><span class=linenos data-linenos="185 "></span></a>            <span class=n>image_shape</span><span class=p>,</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a><a href=#__codelineno-0-186><span class=linenos data-linenos="186 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a><a href=#__codelineno-0-187><span class=linenos data-linenos="187 "></span></a>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a><a href=#__codelineno-0-188><span class=linenos data-linenos="188 "></span></a>        <span class=k>return</span> <span class=p>{</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a><a href=#__codelineno-0-189><span class=linenos data-linenos="189 "></span></a>            <span class=s2>&quot;rotate&quot;</span><span class=p>:</span> <span class=n>angle</span><span class=p>,</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a><a href=#__codelineno-0-190><span class=linenos data-linenos="190 "></span></a>            <span class=s2>&quot;scale&quot;</span><span class=p>:</span> <span class=n>scale</span><span class=p>,</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a><a href=#__codelineno-0-191><span class=linenos data-linenos="191 "></span></a>            <span class=s2>&quot;matrix&quot;</span><span class=p>:</span> <span class=n>matrix</span><span class=p>,</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a><a href=#__codelineno-0-192><span class=linenos data-linenos="192 "></span></a>            <span class=s2>&quot;bbox_matrix&quot;</span><span class=p>:</span> <span class=n>bbox_matrix</span><span class=p>,</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a><a href=#__codelineno-0-193><span class=linenos data-linenos="193 "></span></a>            <span class=s2>&quot;output_shape&quot;</span><span class=p>:</span> <span class=n>image_shape</span><span class=p>,</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a><a href=#__codelineno-0-194><span class=linenos data-linenos="194 "></span></a>        <span class=p>}</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../resize/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Resizing transforms (augmentations.geometric.resize)"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> Resizing transforms (augmentations.geometric.resize) </div> </div> </a> <a href=../transforms/ class="md-footer__link md-footer__link--next" aria-label="Next: Geometric transforms (augmentations.geometric.transforms)"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> Geometric transforms (augmentations.geometric.transforms) </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> </div> <div class=md-social> <a href=https://twitter.com/albumentations target=_blank rel=noopener title=twitter.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9zm-24.8 373.8h39.1L151.1 88h-42z"/></svg> </a> <a href=https://www.linkedin.com/company/100504475/ target=_blank rel=noopener title=www.linkedin.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg> </a> <a href=https://discord.com/invite/AKPrrDYNAt target=_blank rel=noopener title=discord.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 640 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M524.531 69.836a1.5 1.5 0 0 0-.764-.7A485 485 0 0 0 404.081 32.03a1.82 1.82 0 0 0-1.923.91 338 338 0 0 0-14.9 30.6 447.9 447.9 0 0 0-134.426 0 310 310 0 0 0-15.135-30.6 1.89 1.89 0 0 0-1.924-.91 483.7 483.7 0 0 0-119.688 37.107 1.7 1.7 0 0 0-.788.676C39.068 183.651 18.186 294.69 28.43 404.354a2.02 2.02 0 0 0 .765 1.375 487.7 487.7 0 0 0 146.825 74.189 1.9 1.9 0 0 0 2.063-.676A348 348 0 0 0 208.12 430.4a1.86 1.86 0 0 0-1.019-2.588 321 321 0 0 1-45.868-21.853 1.885 1.885 0 0 1-.185-3.126 251 251 0 0 0 9.109-7.137 1.82 1.82 0 0 1 1.9-.256c96.229 43.917 200.41 43.917 295.5 0a1.81 1.81 0 0 1 1.924.233 235 235 0 0 0 9.132 7.16 1.884 1.884 0 0 1-.162 3.126 301.4 301.4 0 0 1-45.89 21.83 1.875 1.875 0 0 0-1 2.611 391 391 0 0 0 30.014 48.815 1.86 1.86 0 0 0 2.063.7A486 486 0 0 0 610.7 405.729a1.88 1.88 0 0 0 .765-1.352c12.264-126.783-20.532-236.912-86.934-334.541M222.491 337.58c-28.972 0-52.844-26.587-52.844-59.239s23.409-59.241 52.844-59.241c29.665 0 53.306 26.82 52.843 59.239 0 32.654-23.41 59.241-52.843 59.241m195.38 0c-28.971 0-52.843-26.587-52.843-59.239s23.409-59.241 52.843-59.241c29.667 0 53.307 26.82 52.844 59.239 0 32.654-23.177 59.241-52.844 59.241"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../../..", "features": ["navigation.sections", "navigation.indexes", "navigation.top", "navigation.footer", "navigation.path", "navigation.prune", "search.suggest", "search.highlight", "search.share", "toc.follow", "toc.integrate"], "search": "../../../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../../../../assets/javascripts/bundle.f1b6f286.min.js></script> <script src=https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/MathJax.js?config=TeX-MML-AM_CHTML"></script> <script src=../../../../js/extra.js></script> </body> </html>