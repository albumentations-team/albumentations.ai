<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Albumentations provides a comprehensive, high-performance framework for augmenting images to improve machine learning models. Ideal for computer vision applications, supporting a wide range of augmentations."><link href=https://albumentations.ai/docs/api_reference/augmentations/geometric/transforms/ rel=canonical><link href=../rotate/ rel=prev><link href=../../mixing/ rel=next><link rel=icon href=../../../../images/logo.png><meta name=generator content="mkdocs-1.6.0, mkdocs-material-9.5.27"><title>Geometric transforms (augmentations.geometric.transforms) - Albumentations Documentation</title><link rel=stylesheet href=../../../../assets/stylesheets/main.6543a935.min.css><link rel=stylesheet href=../../../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../../assets/_mkdocstrings.css><link rel=stylesheet href=../../../../css/extra.css><script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-DCXRDR9HJ0"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-DCXRDR9HJ0",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-DCXRDR9HJ0",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script><meta charset=utf-8><meta name=viewport content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta property=og:title content="Albumentations Documentation - Geometric transforms (augmentations.geometric.transforms)"><meta property=og:description content="Albumentations provides a comprehensive, high-performance framework for augmenting images to improve machine learning models. Ideal for computer vision applications, supporting a wide range of augmentations."><meta property=og:image content=https://albumentations.ai/docs/images/albumentations_card.png><meta property=og:image:type content=image/png><meta property=og:type content=website><meta content=https://albumentations.ai/docs/api_reference/augmentations/geometric/transforms/ property=og:url><meta name=twitter:card content=summary_large_image><meta name=twitter:site content=@albumentations><meta name=twitter:creator content=@viglovikov><meta name=twitter:title content="Albumentations Documentation - Geometric transforms (augmentations.geometric.transforms)"><meta name=twitter:description content="Albumentations provides a comprehensive, high-performance framework for augmenting images to improve machine learning models. Ideal for computer vision applications, supporting a wide range of augmentations."><meta name=twitter:image content=https://albumentations.ai/docs/images/albumentations_card.png><meta name=description content="Albumentations provides a comprehensive, high-performance framework for augmenting images to improve machine learning models. Ideal for computer vision applications, supporting a wide range of augmentations."><meta name=keywords content="Albumentations, image augmentation, machine learning, computer vision, data augmentation, image processing, deep learning, AI, artificial intelligence, Python"></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=white> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#geometric-transforms-augmentationsgeometrictransforms class=md-skip> Skip to content </a> </div> <div data-md-component=announce> <aside class=md-banner> <div class="md-banner__inner md-grid md-typeset"> <button class="md-banner__button md-icon" aria-label="Don't show this again"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> <div class=announce-wrapper> <div id=announce-left> <div class=item> <a class=announce-link target=_blank href=https://github.com/sponsors/albumentations-team> <span class="twemoji twitter"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </span> You can now sponsor <strong>Albumentations</strong> </a> </div> <div class=item> <a class=announce-link href=https://twitter.com/albumentations target=_blank> <span class="twemoji twitter"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg> </span> Follow <strong>@albumentations</strong> on <strong>Twitter</strong> to stay updated </a> </div> <div class=item> <a class=announce-link href=https://www.linkedin.com/company/100504475 target=_blank> <span class="twemoji linkedin"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg> </span> Follow <strong>@albumentations</strong> on <strong>LinkedIn</strong> to stay updated </a> </div> </div> </div> </div> <script>var content,el=document.querySelector("[data-md-component=announce]");el&&(content=el.querySelector(".md-typeset"),__md_hash(content.innerHTML)===__md_get("__announce")&&(el.hidden=!0))</script> </aside> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=header.title> <a href=../../../.. title="Albumentations Documentation" class="md-header__button md-logo" aria-label="Albumentations Documentation" data-md-component=logo> <img src=../../../../images/logo.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> </div> <div class=md-header-nav__title> <div class=header-menu-item> <a href=https://albumentations.ai>Home</a> </div> <div class="header-menu-item header-menu-item-selected"> <a href=https://albumentations.ai/docs/ >Documentation</a> </div> <div class="header-menu-item header-large-menu-item"> <a href=https://albumentations.ai/whos_using>Who's using</a> </div> <div class="header-menu-item header-large-menu-item"> <a href=https://demo.albumentations.ai target=_blank>Demo</a> </div> <div class="header-menu-item header-large-menu-item"> <a href=https://albumentations.ai/people>People</a> </div> </div> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/albumentations-team/albumentations title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </div> <div class=md-source__repository> albumentations </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--integrated" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../../.. title="Albumentations Documentation" class="md-nav__button md-logo" aria-label="Albumentations Documentation" data-md-component=logo> <img src=../../../../images/logo.png alt=logo> </a> Albumentations Documentation </label> <div class=md-nav__source> <a href=https://github.com/albumentations-team/albumentations title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </div> <div class=md-source__repository> albumentations </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../.. class=md-nav__link> <span class=md-ellipsis> Documentation </span> </a> </li> <li class=md-nav__item> <a href=../../../../benchmarking_results/ class=md-nav__link> <span class=md-ellipsis> Benchmarking Results </span> </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex> <span class=md-ellipsis> Introduction </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Introduction </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../introduction/image_augmentation/ class=md-nav__link> <span class=md-ellipsis> What is image augmentation </span> </a> </li> <li class=md-nav__item> <a href=../../../../introduction/why_you_need_a_dedicated_library_for_image_augmentation/ class=md-nav__link> <span class=md-ellipsis> Why you need a dedicated library </span> </a> </li> <li class=md-nav__item> <a href=../../../../introduction/why_albumentations/ class=md-nav__link> <span class=md-ellipsis> Why Albumentations </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex> <span class=md-ellipsis> Getting started </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Getting started </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../getting_started/installation/ class=md-nav__link> <span class=md-ellipsis> Installation </span> </a> </li> <li class=md-nav__item> <a href=../../../../getting_started/image_augmentation/ class=md-nav__link> <span class=md-ellipsis> Image augmentation for classification </span> </a> </li> <li class=md-nav__item> <a href=../../../../getting_started/mask_augmentation/ class=md-nav__link> <span class=md-ellipsis> Mask augmentation for segmentation </span> </a> </li> <li class=md-nav__item> <a href=../../../../getting_started/bounding_boxes_augmentation/ class=md-nav__link> <span class=md-ellipsis> Bounding boxes augmentation for object detection </span> </a> </li> <li class=md-nav__item> <a href=../../../../getting_started/keypoints_augmentation/ class=md-nav__link> <span class=md-ellipsis> Keypoints augmentation </span> </a> </li> <li class=md-nav__item> <a href=../../../../getting_started/simultaneous_augmentation/ class=md-nav__link> <span class=md-ellipsis> Simultaneous augmentation of multiple targets: masks, bounding boxes, keypoints </span> </a> </li> <li class=md-nav__item> <a href=../../../../getting_started/transforms_and_targets/ class=md-nav__link> <span class=md-ellipsis> A list of transforms and their supported targets </span> </a> </li> <li class=md-nav__item> <a href=../../../../getting_started/setting_probabilities/ class=md-nav__link> <span class=md-ellipsis> Setting probabilities for transforms </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5> <div class="md-nav__link md-nav__container"> <a href=../../../../examples/ class="md-nav__link "> <span class=md-ellipsis> Examples </span> </a> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Examples </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../../faq/ class=md-nav__link> <span class=md-ellipsis> FAQ </span> </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex> <span class=md-ellipsis> External resources </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> External resources </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../external_resources/online_courses/ class=md-nav__link> <span class=md-ellipsis> Online classes that cover Albumentations </span> </a> </li> <li class=md-nav__item> <a href=../../../../external_resources/blog_posts_podcasts_talks/ class=md-nav__link> <span class=md-ellipsis> Blog posts, podcasts, talks, and videos about Albumentations </span> </a> </li> <li class=md-nav__item> <a href=../../../../external_resources/books/ class=md-nav__link> <span class=md-ellipsis> Books that mention Albumentations </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_8> <label class=md-nav__link for=__nav_8 id=__nav_8_label tabindex> <span class=md-ellipsis> Integrations </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_8_label aria-expanded=false> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> Integrations </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../../integrations/huggingface/object_detection/ class=md-nav__link> <span class=md-ellipsis> HuggingFace </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class=md-nav__item> <a href=../../../../integrations/fiftyone/ class=md-nav__link> <span class=md-ellipsis> FiftyOne </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../../frameworks_and_libraries/ class=md-nav__link> <span class=md-ellipsis> Frameworks and libraries that use Albumentations </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_10 checked> <div class="md-nav__link md-nav__container"> <a href=../../../ class="md-nav__link "> <span class=md-ellipsis> API Reference </span> </a> <label class="md-nav__link " for=__nav_10 id=__nav_10_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_10_label aria-expanded=true> <label class=md-nav__title for=__nav_10> <span class="md-nav__icon md-icon"></span> API Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../full_reference/ class=md-nav__link> <span class=md-ellipsis> Full API Reference </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../core/ class=md-nav__link> <span class=md-ellipsis> Core API </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_10_4 checked> <div class="md-nav__link md-nav__container"> <a href=../../ class="md-nav__link "> <span class=md-ellipsis> Augmentations </span> </a> <label class="md-nav__link " for=__nav_10_4 id=__nav_10_4_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_10_4_label aria-expanded=true> <label class=md-nav__title for=__nav_10_4> <span class="md-nav__icon md-icon"></span> Augmentations </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../transforms/ class=md-nav__link> <span class=md-ellipsis> Transforms (augmentations.transforms) </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../blur/ class=md-nav__link> <span class=md-ellipsis> Blur transforms </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../crops/ class=md-nav__link> <span class=md-ellipsis> Crop transforms </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../dropout/ class=md-nav__link> <span class=md-ellipsis> Dropout transforms </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_10_4_6 checked> <div class="md-nav__link md-nav__container"> <a href=../ class="md-nav__link "> <span class=md-ellipsis> Geometric transforms </span> </a> <label class="md-nav__link " for=__nav_10_4_6 id=__nav_10_4_6_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_10_4_6_label aria-expanded=true> <label class=md-nav__title for=__nav_10_4_6> <span class="md-nav__icon md-icon"></span> Geometric transforms </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../functional/ class=md-nav__link> <span class=md-ellipsis> Geometric functional transforms (augmentations.geometric.functional) </span> </a> </li> <li class=md-nav__item> <a href=../resize/ class=md-nav__link> <span class=md-ellipsis> Resizing transforms (augmentations.geometric.resize) </span> </a> </li> <li class=md-nav__item> <a href=../rotate/ class=md-nav__link> <span class=md-ellipsis> Rotation transforms (augmentations.geometric.functional) </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Geometric transforms (augmentations.geometric.transforms) </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Geometric transforms (augmentations.geometric.transforms) </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#albumentations.augmentations.geometric.transforms class=md-nav__link> <span class=md-ellipsis> albumentations.augmentations.geometric.transforms </span> </a> <nav class=md-nav aria-label=albumentations.augmentations.geometric.transforms> <ul class=md-nav__list> <li class=md-nav__item> <a href=#albumentations.augmentations.geometric.transforms.Affine.targets_as_params class=md-nav__link> <span class=md-ellipsis> targets_as_params </span> </a> </li> <li class=md-nav__item> <a href=#albumentations.augmentations.geometric.transforms.Affine.apply class=md-nav__link> <span class=md-ellipsis> apply() </span> </a> </li> <li class=md-nav__item> <a href=#albumentations.augmentations.geometric.transforms.Affine.get_params_dependent_on_targets class=md-nav__link> <span class=md-ellipsis> get_params_dependent_on_targets() </span> </a> </li> <li class=md-nav__item> <a href=#albumentations.augmentations.geometric.transforms.Affine.get_transform_init_args_names class=md-nav__link> <span class=md-ellipsis> get_transform_init_args_names() </span> </a> </li> <li class=md-nav__item> <a href=#albumentations.augmentations.geometric.transforms.D4.apply class=md-nav__link> <span class=md-ellipsis> apply() </span> </a> </li> <li class=md-nav__item> <a href=#albumentations.augmentations.geometric.transforms.D4.get_params class=md-nav__link> <span class=md-ellipsis> get_params() </span> </a> </li> <li class=md-nav__item> <a href=#albumentations.augmentations.geometric.transforms.D4.get_transform_init_args_names class=md-nav__link> <span class=md-ellipsis> get_transform_init_args_names() </span> </a> </li> <li class=md-nav__item> <a href=#albumentations.augmentations.geometric.transforms.ElasticTransform.apply class=md-nav__link> <span class=md-ellipsis> apply() </span> </a> </li> <li class=md-nav__item> <a href=#albumentations.augmentations.geometric.transforms.ElasticTransform.get_params class=md-nav__link> <span class=md-ellipsis> get_params() </span> </a> </li> <li class=md-nav__item> <a href=#albumentations.augmentations.geometric.transforms.ElasticTransform.get_transform_init_args_names class=md-nav__link> <span class=md-ellipsis> get_transform_init_args_names() </span> </a> </li> <li class=md-nav__item> <a href=#albumentations.augmentations.geometric.transforms.Flip.apply class=md-nav__link> <span class=md-ellipsis> apply() </span> </a> </li> <li class=md-nav__item> <a href=#albumentations.augmentations.geometric.transforms.Flip.get_params class=md-nav__link> <span class=md-ellipsis> get_params() </span> </a> </li> <li class=md-nav__item> <a href=#albumentations.augmentations.geometric.transforms.Flip.get_transform_init_args_names class=md-nav__link> <span class=md-ellipsis> get_transform_init_args_names() </span> </a> </li> <li class=md-nav__item> <a href=#albumentations.augmentations.geometric.transforms.GridDistortion.targets_as_params class=md-nav__link> <span class=md-ellipsis> targets_as_params </span> </a> </li> <li class=md-nav__item> <a href=#albumentations.augmentations.geometric.transforms.GridDistortion.apply class=md-nav__link> <span class=md-ellipsis> apply() </span> </a> </li> <li class=md-nav__item> <a href=#albumentations.augmentations.geometric.transforms.GridDistortion.get_params_dependent_on_targets class=md-nav__link> <span class=md-ellipsis> get_params_dependent_on_targets() </span> </a> </li> <li class=md-nav__item> <a href=#albumentations.augmentations.geometric.transforms.GridDistortion.get_transform_init_args_names class=md-nav__link> <span class=md-ellipsis> get_transform_init_args_names() </span> </a> </li> <li class=md-nav__item> <a href=#albumentations.augmentations.geometric.transforms.HorizontalFlip.apply class=md-nav__link> <span class=md-ellipsis> apply() </span> </a> </li> <li class=md-nav__item> <a href=#albumentations.augmentations.geometric.transforms.HorizontalFlip.get_transform_init_args_names class=md-nav__link> <span class=md-ellipsis> get_transform_init_args_names() </span> </a> </li> <li class=md-nav__item> <a href=#albumentations.augmentations.geometric.transforms.OpticalDistortion.apply class=md-nav__link> <span class=md-ellipsis> apply() </span> </a> </li> <li class=md-nav__item> <a href=#albumentations.augmentations.geometric.transforms.OpticalDistortion.get_params class=md-nav__link> <span class=md-ellipsis> get_params() </span> </a> </li> <li class=md-nav__item> <a href=#albumentations.augmentations.geometric.transforms.OpticalDistortion.get_transform_init_args_names class=md-nav__link> <span class=md-ellipsis> get_transform_init_args_names() </span> </a> </li> <li class=md-nav__item> <a href=#albumentations.augmentations.geometric.transforms.PadIfNeeded.apply class=md-nav__link> <span class=md-ellipsis> apply() </span> </a> </li> <li class=md-nav__item> <a href=#albumentations.augmentations.geometric.transforms.PadIfNeeded.get_transform_init_args_names class=md-nav__link> <span class=md-ellipsis> get_transform_init_args_names() </span> </a> </li> <li class=md-nav__item> <a href=#albumentations.augmentations.geometric.transforms.PadIfNeeded.update_params class=md-nav__link> <span class=md-ellipsis> update_params() </span> </a> </li> <li class=md-nav__item> <a href=#albumentations.augmentations.geometric.transforms.Perspective.targets_as_params class=md-nav__link> <span class=md-ellipsis> targets_as_params </span> </a> </li> <li class=md-nav__item> <a href=#albumentations.augmentations.geometric.transforms.Perspective.apply class=md-nav__link> <span class=md-ellipsis> apply() </span> </a> </li> <li class=md-nav__item> <a href=#albumentations.augmentations.geometric.transforms.Perspective.get_params_dependent_on_targets class=md-nav__link> <span class=md-ellipsis> get_params_dependent_on_targets() </span> </a> </li> <li class=md-nav__item> <a href=#albumentations.augmentations.geometric.transforms.Perspective.get_transform_init_args_names class=md-nav__link> <span class=md-ellipsis> get_transform_init_args_names() </span> </a> </li> <li class=md-nav__item> <a href=#albumentations.augmentations.geometric.transforms.PiecewiseAffine.targets_as_params class=md-nav__link> <span class=md-ellipsis> targets_as_params </span> </a> </li> <li class=md-nav__item> <a href=#albumentations.augmentations.geometric.transforms.PiecewiseAffine.apply class=md-nav__link> <span class=md-ellipsis> apply() </span> </a> </li> <li class=md-nav__item> <a href=#albumentations.augmentations.geometric.transforms.PiecewiseAffine.get_params_dependent_on_targets class=md-nav__link> <span class=md-ellipsis> get_params_dependent_on_targets() </span> </a> </li> <li class=md-nav__item> <a href=#albumentations.augmentations.geometric.transforms.PiecewiseAffine.get_transform_init_args_names class=md-nav__link> <span class=md-ellipsis> get_transform_init_args_names() </span> </a> </li> <li class=md-nav__item> <a href=#albumentations.augmentations.geometric.transforms.Transpose.apply class=md-nav__link> <span class=md-ellipsis> apply() </span> </a> </li> <li class=md-nav__item> <a href=#albumentations.augmentations.geometric.transforms.Transpose.get_transform_init_args_names class=md-nav__link> <span class=md-ellipsis> get_transform_init_args_names() </span> </a> </li> <li class=md-nav__item> <a href=#albumentations.augmentations.geometric.transforms.VerticalFlip.apply class=md-nav__link> <span class=md-ellipsis> apply() </span> </a> </li> <li class=md-nav__item> <a href=#albumentations.augmentations.geometric.transforms.VerticalFlip.get_transform_init_args_names class=md-nav__link> <span class=md-ellipsis> get_transform_init_args_names() </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../mixing/ class=md-nav__link> <span class=md-ellipsis> Mixing transforms </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class=md-nav__item> <a href=../../domain_adaptation/ class=md-nav__link> <span class=md-ellipsis> Domain adaptation transforms (augmentations.domain_adaptation) </span> </a> </li> <li class=md-nav__item> <a href=../../functional/ class=md-nav__link> <span class=md-ellipsis> Functional transforms (augmentations.functional) </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../pytorch/ class=md-nav__link> <span class=md-ellipsis> PyTorch Helpers </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_11> <div class="md-nav__link md-nav__container"> <a href=../../../../autoalbument/ class="md-nav__link "> <span class=md-ellipsis> AutoAlbument </span> </a> <label class="md-nav__link " for=__nav_11 id=__nav_11_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_11_label aria-expanded=false> <label class=md-nav__title for=__nav_11> <span class="md-nav__icon md-icon"></span> AutoAlbument </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../autoalbument/benchmarks/ class=md-nav__link> <span class=md-ellipsis> Benchmarks and a comparison with baseline augmentation strategies </span> </a> </li> <li class=md-nav__item> <a href=../../../../autoalbument/installation/ class=md-nav__link> <span class=md-ellipsis> Installation </span> </a> </li> <li class=md-nav__item> <a href=../../../../autoalbument/how_to_use/ class=md-nav__link> <span class=md-ellipsis> How to use AutoAlbument </span> </a> </li> <li class=md-nav__item> <a href=../../../../autoalbument/docker/ class=md-nav__link> <span class=md-ellipsis> How to use an AutoAlbument Docker image </span> </a> </li> <li class=md-nav__item> <a href=../../../../autoalbument/custom_model/ class=md-nav__link> <span class=md-ellipsis> How to use a custom classification or semantic segmentation model </span> </a> </li> <li class=md-nav__item> <a href=../../../../autoalbument/metrics/ class=md-nav__link> <span class=md-ellipsis> Metrics and their meaning </span> </a> </li> <li class=md-nav__item> <a href=../../../../autoalbument/tuning_parameters/ class=md-nav__link> <span class=md-ellipsis> Tuning the search parameters </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../../autoalbument/examples/list/ class=md-nav__link> <span class=md-ellipsis> Examples </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class=md-nav__item> <a href=../../../../autoalbument/search_algorithms/ class=md-nav__link> <span class=md-ellipsis> Search algorithms </span> </a> </li> <li class=md-nav__item> <a href=../../../../autoalbument/faq/ class=md-nav__link> <span class=md-ellipsis> FAQ </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../../release_notes/ class=md-nav__link> <span class=md-ellipsis> Release notes </span> </a> </li> <li class=md-nav__item> <a href=../../../../CONTRIBUTING/ class=md-nav__link> <span class=md-ellipsis> Contributing to Albumentations </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <style>
  .highlight-ipynb {
    font-size: 0.7rem;
  }

  .jupyter-wrapper .jp-MarkdownOutput.jp-RenderedHTMLCommon {
    font-size: 0.8rem;
  }
</style> <a href=https://github.com/albumentations-team/albumentations.ai/tree/main/mkdocs/src/docs/api_reference/augmentations/geometric/transforms.md title=edit.link.title class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg> </a> <h1 id=geometric-transforms-augmentationsgeometrictransforms>Geometric transforms (augmentations.geometric.transforms)<a class=headerlink href=#geometric-transforms-augmentationsgeometrictransforms title="Permanent link">¶</a></h1> <div class="doc doc-object doc-module"> <a id=albumentations.augmentations.geometric.transforms></a> <div class="doc doc-contents first"> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h2 class="doc doc-heading" data-toc-label=Affine id=albumentations.augmentations.geometric.transforms.Affine> <code>class <strong> Affine</strong></code> <code> (scale=None, translate_percent=None, translate_px=None, rotate=None, shear=None, interpolation=1, mask_interpolation=0, cval=0, cval_mask=0, mode=0, fit_output=False, keep_ratio=False, rotate_method='largest_box', balanced_scale=False, always_apply=None, p=0.5) </code> <span class=doc-github-link> <a href=https://github.com/albumentations-team/albumentations/blob/main/albumentations/augmentations/geometric/transforms.py#L576 target=_blank>[view source on GitHub]</a> </span><a class=headerlink href=#albumentations.augmentations.geometric.transforms.Affine title="Permanent link">¶</a> </h2> <div class=class-signature> </div> <div class="doc doc-contents"> <p>Augmentation to apply affine transformations to images.</p> <p>Affine transformations involve:</p> <div class=codehilite><pre><span></span><code>- Translation ("move" image on the x-/y-axis)
- Rotation
- Scaling ("zoom" in/out)
- Shear (move one side of the image, turning a square into a trapezoid)
</code></pre></div> <p>All such transformations can create "new" pixels in the image without a defined content, e.g. if the image is translated to the left, pixels are created on the right. A method has to be defined to deal with these pixel values. The parameters <code>cval</code> and <code>mode</code> of this class deal with this.</p> <p>Some transformations involve interpolations between several pixels of the input image to generate output pixel values. The parameters <code>interpolation</code> and <code>mask_interpolation</code> deals with the method of interpolation used for this.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>scale</code></td> <td><code>number, tuple of number or dict</code></td> <td><p>Scaling factor to use, where <code>1.0</code> denotes "no change" and <code>0.5</code> is zoomed out to <code>50</code> percent of the original size. * If a single number, then that value will be used for all images. * If a tuple <code>(a, b)</code>, then a value will be uniformly sampled per image from the interval <code>[a, b]</code>. That the same range will be used for both x- and y-axis. To keep the aspect ratio, set <code>keep_ratio=True</code>, then the same value will be used for both x- and y-axis. * If a dictionary, then it is expected to have the keys <code>x</code> and/or <code>y</code>. Each of these keys can have the same values as described above. Using a dictionary allows to set different values for the two axis and sampling will then happen <em>independently</em> per axis, resulting in samples that differ between the axes. Note that when the <code>keep_ratio=True</code>, the x- and y-axis ranges should be the same.</p></td> </tr> <tr> <td><code>translate_percent</code></td> <td><code>None, number, tuple of number or dict</code></td> <td><p>Translation as a fraction of the image height/width (x-translation, y-translation), where <code>0</code> denotes "no change" and <code>0.5</code> denotes "half of the axis size". * If <code>None</code> then equivalent to <code>0.0</code> unless <code>translate_px</code> has a value other than <code>None</code>. * If a single number, then that value will be used for all images. * If a tuple <code>(a, b)</code>, then a value will be uniformly sampled per image from the interval <code>[a, b]</code>. That sampled fraction value will be used identically for both x- and y-axis. * If a dictionary, then it is expected to have the keys <code>x</code> and/or <code>y</code>. Each of these keys can have the same values as described above. Using a dictionary allows to set different values for the two axis and sampling will then happen <em>independently</em> per axis, resulting in samples that differ between the axes.</p></td> </tr> <tr> <td><code>translate_px</code></td> <td><code>None, int, tuple of int or dict</code></td> <td><p>Translation in pixels. * If <code>None</code> then equivalent to <code>0</code> unless <code>translate_percent</code> has a value other than <code>None</code>. * If a single int, then that value will be used for all images. * If a tuple <code>(a, b)</code>, then a value will be uniformly sampled per image from the discrete interval <code>[a..b]</code>. That number will be used identically for both x- and y-axis. * If a dictionary, then it is expected to have the keys <code>x</code> and/or <code>y</code>. Each of these keys can have the same values as described above. Using a dictionary allows to set different values for the two axis and sampling will then happen <em>independently</em> per axis, resulting in samples that differ between the axes.</p></td> </tr> <tr> <td><code>rotate</code></td> <td><code>number or tuple of number</code></td> <td><p>Rotation in degrees (<strong>NOT</strong> radians), i.e. expected value range is around <code>[-360, 360]</code>. Rotation happens around the <em>center</em> of the image, not the top left corner as in some other frameworks. * If a number, then that value will be used for all images. * If a tuple <code>(a, b)</code>, then a value will be uniformly sampled per image from the interval <code>[a, b]</code> and used as the rotation value.</p></td> </tr> <tr> <td><code>shear</code></td> <td><code>number, tuple of number or dict</code></td> <td><p>Shear in degrees (<strong>NOT</strong> radians), i.e. expected value range is around <code>[-360, 360]</code>, with reasonable values being in the range of <code>[-45, 45]</code>. * If a number, then that value will be used for all images as the shear on the x-axis (no shear on the y-axis will be done). * If a tuple <code>(a, b)</code>, then two value will be uniformly sampled per image from the interval <code>[a, b]</code> and be used as the x- and y-shear value. * If a dictionary, then it is expected to have the keys <code>x</code> and/or <code>y</code>. Each of these keys can have the same values as described above. Using a dictionary allows to set different values for the two axis and sampling will then happen <em>independently</em> per axis, resulting in samples that differ between the axes.</p></td> </tr> <tr> <td><code>interpolation</code></td> <td><code>int</code></td> <td><p>OpenCV interpolation flag.</p></td> </tr> <tr> <td><code>mask_interpolation</code></td> <td><code>int</code></td> <td><p>OpenCV interpolation flag.</p></td> </tr> <tr> <td><code>cval</code></td> <td><code>number or sequence of number</code></td> <td><p>The constant value to use when filling in newly created pixels. (E.g. translating by 1px to the right will create a new 1px-wide column of pixels on the left of the image). The value is only used when <code>mode=constant</code>. The expected value range is <code>[0, 255]</code> for <code>uint8</code> images.</p></td> </tr> <tr> <td><code>cval_mask</code></td> <td><code>number or tuple of number</code></td> <td><p>Same as cval but only for masks.</p></td> </tr> <tr> <td><code>mode</code></td> <td><code>int</code></td> <td><p>OpenCV border flag.</p></td> </tr> <tr> <td><code>fit_output</code></td> <td><code>bool</code></td> <td><p>If True, the image plane size and position will be adjusted to tightly capture the whole image after affine transformation (<code>translate_percent</code> and <code>translate_px</code> are ignored). Otherwise (<code>False</code>), parts of the transformed image may end up outside the image plane. Fitting the output shape can be useful to avoid corners of the image being outside the image plane after applying rotations. Default: False</p></td> </tr> <tr> <td><code>keep_ratio</code></td> <td><code>bool</code></td> <td><p>When True, the original aspect ratio will be kept when the random scale is applied. Default: False.</p></td> </tr> <tr> <td><code>rotate_method</code></td> <td><code>Literal["largest_box", "ellipse"]</code></td> <td><p>rotation method used for the bounding boxes. Should be one of "largest_box" or "ellipse"[1]. Default: "largest_box"</p></td> </tr> <tr> <td><code>balanced_scale</code></td> <td><code>bool</code></td> <td><p>When True, scaling factors are chosen to be either entirely below or above 1, ensuring balanced scaling. Default: False.</p> <p>This is important because without it, scaling tends to lean towards upscaling. For example, if we want the image to zoom in and out by 2x, we may pick an interval [0.5, 2]. Since the interval [0.5, 1] is three times smaller than [1, 2], values above 1 are picked three times more often if sampled directly from [0.5, 2]. With <code>balanced_scale</code>, the function ensures that half the time, the scaling factor is picked from below 1 (zooming out), and the other half from above 1 (zooming in). This makes the zooming in and out process more balanced.</p></td> </tr> <tr> <td><code>p</code></td> <td><code>float</code></td> <td><p>probability of applying the transform. Default: 0.5.</p></td> </tr> </tbody> </table> <div class="admonition targets"> <p class=admonition-title>Targets</p> <p>image, mask, keypoints, bboxes</p> </div> <p>Image types: uint8, float32</p> <div class="admonition reference"> <p class=admonition-title>Reference</p> <p>[1] <a href=https://arxiv.org/abs/2109.13488 target=_blank>https://arxiv.org/abs/2109.13488</a></p> </div> <div class="admonition info"> <p class=admonition-title><strong>Interactive Tool Available!</strong></p> <p> <strong>Explore this transform visually and adjust parameters interactively using this tool:</strong> </p> <p> <a class="md-button md-button--primary" href="https://huggingface.co/spaces/qubvel-hf/albumentations-demo?transform=Affine" target=_blank>Open Tool</a> </p> </div> <details class=quote> <summary>Source code in <code>albumentations/augmentations/geometric/transforms.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1></a><a href=#__codelineno-0-1><span class=linenos data-linenos="  1 "></span></a><span class=k>class</span> <span class=nc>Affine</span><span class=p>(</span><span class=n>DualTransform</span><span class=p>):</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2></a><a href=#__codelineno-0-2><span class=linenos data-linenos="  2 "></span></a><span class=w>    </span><span class=sd>"""Augmentation to apply affine transformations to images.</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3></a><a href=#__codelineno-0-3><span class=linenos data-linenos="  3 "></span></a>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4></a><a href=#__codelineno-0-4><span class=linenos data-linenos="  4 "></span></a><span class=sd>    Affine transformations involve:</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5></a><a href=#__codelineno-0-5><span class=linenos data-linenos="  5 "></span></a>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6></a><a href=#__codelineno-0-6><span class=linenos data-linenos="  6 "></span></a><span class=sd>        - Translation ("move" image on the x-/y-axis)</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7></a><a href=#__codelineno-0-7><span class=linenos data-linenos="  7 "></span></a><span class=sd>        - Rotation</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8></a><a href=#__codelineno-0-8><span class=linenos data-linenos="  8 "></span></a><span class=sd>        - Scaling ("zoom" in/out)</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9></a><a href=#__codelineno-0-9><span class=linenos data-linenos="  9 "></span></a><span class=sd>        - Shear (move one side of the image, turning a square into a trapezoid)</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10></a><a href=#__codelineno-0-10><span class=linenos data-linenos=" 10 "></span></a>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11></a><a href=#__codelineno-0-11><span class=linenos data-linenos=" 11 "></span></a><span class=sd>    All such transformations can create "new" pixels in the image without a defined content, e.g.</span>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12></a><a href=#__codelineno-0-12><span class=linenos data-linenos=" 12 "></span></a><span class=sd>    if the image is translated to the left, pixels are created on the right.</span>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13></a><a href=#__codelineno-0-13><span class=linenos data-linenos=" 13 "></span></a><span class=sd>    A method has to be defined to deal with these pixel values.</span>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14></a><a href=#__codelineno-0-14><span class=linenos data-linenos=" 14 "></span></a><span class=sd>    The parameters `cval` and `mode` of this class deal with this.</span>
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15></a><a href=#__codelineno-0-15><span class=linenos data-linenos=" 15 "></span></a>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16></a><a href=#__codelineno-0-16><span class=linenos data-linenos=" 16 "></span></a><span class=sd>    Some transformations involve interpolations between several pixels</span>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17></a><a href=#__codelineno-0-17><span class=linenos data-linenos=" 17 "></span></a><span class=sd>    of the input image to generate output pixel values. The parameters `interpolation` and</span>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18></a><a href=#__codelineno-0-18><span class=linenos data-linenos=" 18 "></span></a><span class=sd>    `mask_interpolation` deals with the method of interpolation used for this.</span>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19></a><a href=#__codelineno-0-19><span class=linenos data-linenos=" 19 "></span></a>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20></a><a href=#__codelineno-0-20><span class=linenos data-linenos=" 20 "></span></a><span class=sd>    Args:</span>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21></a><a href=#__codelineno-0-21><span class=linenos data-linenos=" 21 "></span></a><span class=sd>        scale (number, tuple of number or dict): Scaling factor to use, where ``1.0`` denotes "no change" and</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22></a><a href=#__codelineno-0-22><span class=linenos data-linenos=" 22 "></span></a><span class=sd>            ``0.5`` is zoomed out to ``50`` percent of the original size.</span>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23></a><a href=#__codelineno-0-23><span class=linenos data-linenos=" 23 "></span></a><span class=sd>                * If a single number, then that value will be used for all images.</span>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a><a href=#__codelineno-0-24><span class=linenos data-linenos=" 24 "></span></a><span class=sd>                * If a tuple ``(a, b)``, then a value will be uniformly sampled per image from the interval ``[a, b]``.</span>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a><a href=#__codelineno-0-25><span class=linenos data-linenos=" 25 "></span></a><span class=sd>                  That the same range will be used for both x- and y-axis. To keep the aspect ratio, set</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a><a href=#__codelineno-0-26><span class=linenos data-linenos=" 26 "></span></a><span class=sd>                  ``keep_ratio=True``, then the same value will be used for both x- and y-axis.</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a><a href=#__codelineno-0-27><span class=linenos data-linenos=" 27 "></span></a><span class=sd>                * If a dictionary, then it is expected to have the keys ``x`` and/or ``y``.</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a><a href=#__codelineno-0-28><span class=linenos data-linenos=" 28 "></span></a><span class=sd>                  Each of these keys can have the same values as described above.</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a><a href=#__codelineno-0-29><span class=linenos data-linenos=" 29 "></span></a><span class=sd>                  Using a dictionary allows to set different values for the two axis and sampling will then happen</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a><a href=#__codelineno-0-30><span class=linenos data-linenos=" 30 "></span></a><span class=sd>                  *independently* per axis, resulting in samples that differ between the axes. Note that when</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a><a href=#__codelineno-0-31><span class=linenos data-linenos=" 31 "></span></a><span class=sd>                  the ``keep_ratio=True``, the x- and y-axis ranges should be the same.</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a><a href=#__codelineno-0-32><span class=linenos data-linenos=" 32 "></span></a><span class=sd>        translate_percent (None, number, tuple of number or dict): Translation as a fraction of the image height/width</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a><a href=#__codelineno-0-33><span class=linenos data-linenos=" 33 "></span></a><span class=sd>            (x-translation, y-translation), where ``0`` denotes "no change"</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a><a href=#__codelineno-0-34><span class=linenos data-linenos=" 34 "></span></a><span class=sd>            and ``0.5`` denotes "half of the axis size".</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a><a href=#__codelineno-0-35><span class=linenos data-linenos=" 35 "></span></a><span class=sd>                * If ``None`` then equivalent to ``0.0`` unless `translate_px` has a value other than ``None``.</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a><a href=#__codelineno-0-36><span class=linenos data-linenos=" 36 "></span></a><span class=sd>                * If a single number, then that value will be used for all images.</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a><a href=#__codelineno-0-37><span class=linenos data-linenos=" 37 "></span></a><span class=sd>                * If a tuple ``(a, b)``, then a value will be uniformly sampled per image from the interval ``[a, b]``.</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a><a href=#__codelineno-0-38><span class=linenos data-linenos=" 38 "></span></a><span class=sd>                  That sampled fraction value will be used identically for both x- and y-axis.</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a><a href=#__codelineno-0-39><span class=linenos data-linenos=" 39 "></span></a><span class=sd>                * If a dictionary, then it is expected to have the keys ``x`` and/or ``y``.</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a><a href=#__codelineno-0-40><span class=linenos data-linenos=" 40 "></span></a><span class=sd>                  Each of these keys can have the same values as described above.</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a><a href=#__codelineno-0-41><span class=linenos data-linenos=" 41 "></span></a><span class=sd>                  Using a dictionary allows to set different values for the two axis and sampling will then happen</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><a href=#__codelineno-0-42><span class=linenos data-linenos=" 42 "></span></a><span class=sd>                  *independently* per axis, resulting in samples that differ between the axes.</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos=" 43 "></span></a><span class=sd>        translate_px (None, int, tuple of int or dict): Translation in pixels.</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos=" 44 "></span></a><span class=sd>                * If ``None`` then equivalent to ``0`` unless `translate_percent` has a value other than ``None``.</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos=" 45 "></span></a><span class=sd>                * If a single int, then that value will be used for all images.</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos=" 46 "></span></a><span class=sd>                * If a tuple ``(a, b)``, then a value will be uniformly sampled per image from</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos=" 47 "></span></a><span class=sd>                  the discrete interval ``[a..b]``. That number will be used identically for both x- and y-axis.</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos=" 48 "></span></a><span class=sd>                * If a dictionary, then it is expected to have the keys ``x`` and/or ``y``.</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos=" 49 "></span></a><span class=sd>                  Each of these keys can have the same values as described above.</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos=" 50 "></span></a><span class=sd>                  Using a dictionary allows to set different values for the two axis and sampling will then happen</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos=" 51 "></span></a><span class=sd>                  *independently* per axis, resulting in samples that differ between the axes.</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos=" 52 "></span></a><span class=sd>        rotate (number or tuple of number): Rotation in degrees (**NOT** radians), i.e. expected value range is</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a><span class=sd>            around ``[-360, 360]``. Rotation happens around the *center* of the image,</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a><span class=sd>            not the top left corner as in some other frameworks.</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a><span class=sd>                * If a number, then that value will be used for all images.</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a><span class=sd>                * If a tuple ``(a, b)``, then a value will be uniformly sampled per image from the interval ``[a, b]``</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a><span class=sd>                  and used as the rotation value.</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a><span class=sd>        shear (number, tuple of number or dict): Shear in degrees (**NOT** radians), i.e. expected value range is</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a><span class=sd>            around ``[-360, 360]``, with reasonable values being in the range of ``[-45, 45]``.</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a><span class=sd>                * If a number, then that value will be used for all images as</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a><span class=sd>                  the shear on the x-axis (no shear on the y-axis will be done).</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a><span class=sd>                * If a tuple ``(a, b)``, then two value will be uniformly sampled per image</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a><span class=sd>                  from the interval ``[a, b]`` and be used as the x- and y-shear value.</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a><span class=sd>                * If a dictionary, then it is expected to have the keys ``x`` and/or ``y``.</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a><span class=sd>                  Each of these keys can have the same values as described above.</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a><span class=sd>                  Using a dictionary allows to set different values for the two axis and sampling will then happen</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a><span class=sd>                  *independently* per axis, resulting in samples that differ between the axes.</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a><span class=sd>        interpolation (int): OpenCV interpolation flag.</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a><span class=sd>        mask_interpolation (int): OpenCV interpolation flag.</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a><span class=sd>        cval (number or sequence of number): The constant value to use when filling in newly created pixels.</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a><span class=sd>            (E.g. translating by 1px to the right will create a new 1px-wide column of pixels</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a><span class=sd>            on the left of the image).</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a><span class=sd>            The value is only used when `mode=constant`. The expected value range is ``[0, 255]`` for ``uint8`` images.</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a><span class=sd>        cval_mask (number or tuple of number): Same as cval but only for masks.</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a><span class=sd>        mode (int): OpenCV border flag.</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a><span class=sd>        fit_output (bool): If True, the image plane size and position will be adjusted to tightly capture</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a><span class=sd>            the whole image after affine transformation (`translate_percent` and `translate_px` are ignored).</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a><span class=sd>            Otherwise (``False``),  parts of the transformed image may end up outside the image plane.</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a><span class=sd>            Fitting the output shape can be useful to avoid corners of the image being outside the image plane</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a><span class=sd>            after applying rotations. Default: False</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a><span class=sd>        keep_ratio (bool): When True, the original aspect ratio will be kept when the random scale is applied.</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a><span class=sd>            Default: False.</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a><span class=sd>        rotate_method (Literal["largest_box", "ellipse"]): rotation method used for the bounding boxes.</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a><span class=sd>            Should be one of "largest_box" or "ellipse"[1]. Default: "largest_box"</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a><span class=sd>        balanced_scale (bool): When True, scaling factors are chosen to be either entirely below or above 1,</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a><span class=sd>            ensuring balanced scaling. Default: False.</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a><span class=sd>            This is important because without it, scaling tends to lean towards upscaling. For example, if we want</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a><span class=sd>            the image to zoom in and out by 2x, we may pick an interval [0.5, 2]. Since the interval [0.5, 1] is</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a><span class=sd>            three times smaller than [1, 2], values above 1 are picked three times more often if sampled directly</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a><span class=sd>            from [0.5, 2]. With `balanced_scale`, the  function ensures that half the time, the scaling</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a><span class=sd>            factor is picked from below 1 (zooming out), and the other half from above 1 (zooming in).</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a><span class=sd>            This makes the zooming in and out process more balanced.</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a><span class=sd>        p (float): probability of applying the transform. Default: 0.5.</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a><span class=sd>    Targets:</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a><span class=sd>        image, mask, keypoints, bboxes</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a><span class=sd>    Image types:</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a><span class=sd>        uint8, float32</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a><span class=sd>    Reference:</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a><span class=sd>        [1] https://arxiv.org/abs/2109.13488</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>    <span class=n>_targets</span> <span class=o>=</span> <span class=p>(</span><span class=n>Targets</span><span class=o>.</span><span class=n>IMAGE</span><span class=p>,</span> <span class=n>Targets</span><span class=o>.</span><span class=n>MASK</span><span class=p>,</span> <span class=n>Targets</span><span class=o>.</span><span class=n>BBOXES</span><span class=p>,</span> <span class=n>Targets</span><span class=o>.</span><span class=n>KEYPOINTS</span><span class=p>)</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a>    <span class=k>class</span> <span class=nc>InitSchema</span><span class=p>(</span><span class=n>BaseTransformInitSchema</span><span class=p>):</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a>        <span class=n>scale</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=n>ScaleFloatType</span><span class=p>,</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]]]</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a>            <span class=n>default</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a>            <span class=n>description</span><span class=o>=</span><span class=s2>"Scaling factor or dictionary for independent axis scaling."</span><span class=p>,</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a>        <span class=n>translate_percent</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=n>ScaleFloatType</span><span class=p>,</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]]]</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a>            <span class=n>default</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a>            <span class=n>description</span><span class=o>=</span><span class=s2>"Translation as a fraction of the image dimension."</span><span class=p>,</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a>        <span class=n>translate_px</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=n>ScaleIntType</span><span class=p>,</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]]]</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a>            <span class=n>default</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a>            <span class=n>description</span><span class=o>=</span><span class=s2>"Translation in pixels."</span><span class=p>,</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a>        <span class=n>rotate</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>ScaleFloatType</span><span class=p>]</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=n>default</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>"Rotation angle in degrees."</span><span class=p>)</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a>        <span class=n>shear</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=n>ScaleFloatType</span><span class=p>,</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]]]</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a>            <span class=n>default</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a>            <span class=n>description</span><span class=o>=</span><span class=s2>"Shear angle in degrees."</span><span class=p>,</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a>        <span class=n>interpolation</span><span class=p>:</span> <span class=n>InterpolationType</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_LINEAR</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a>        <span class=n>mask_interpolation</span><span class=p>:</span> <span class=n>InterpolationType</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_NEAREST</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a>        <span class=n>cval</span><span class=p>:</span> <span class=n>ColorType</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=n>default</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>"Value used for constant padding."</span><span class=p>)</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a>        <span class=n>cval_mask</span><span class=p>:</span> <span class=n>ColorType</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=n>default</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>"Value used for mask constant padding."</span><span class=p>)</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a>        <span class=n>mode</span><span class=p>:</span> <span class=n>BorderModeType</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>BORDER_CONSTANT</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a>        <span class=n>fit_output</span><span class=p>:</span> <span class=n>Annotated</span><span class=p>[</span><span class=nb>bool</span><span class=p>,</span> <span class=n>Field</span><span class=p>(</span><span class=n>default</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>"Adjust output to capture whole image."</span><span class=p>)]</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a>        <span class=n>keep_ratio</span><span class=p>:</span> <span class=n>Annotated</span><span class=p>[</span><span class=nb>bool</span><span class=p>,</span> <span class=n>Field</span><span class=p>(</span><span class=n>default</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>"Maintain aspect ratio when scaling."</span><span class=p>)]</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a>        <span class=n>rotate_method</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>"largest_box"</span><span class=p>,</span> <span class=s2>"ellipse"</span><span class=p>]</span> <span class=o>=</span> <span class=s2>"largest_box"</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a>        <span class=n>balanced_scale</span><span class=p>:</span> <span class=n>Annotated</span><span class=p>[</span><span class=nb>bool</span><span class=p>,</span> <span class=n>Field</span><span class=p>(</span><span class=n>default</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>"Use balanced scaling."</span><span class=p>)]</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a>        <span class=n>scale</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=n>ScaleFloatType</span><span class=p>,</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]]]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a>        <span class=n>translate_percent</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=n>ScaleFloatType</span><span class=p>,</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]]]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a>        <span class=n>translate_px</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=n>ScaleIntType</span><span class=p>,</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]]]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a>        <span class=n>rotate</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>ScaleFloatType</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a>        <span class=n>shear</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=n>ScaleFloatType</span><span class=p>,</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]]]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a>        <span class=n>interpolation</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_LINEAR</span><span class=p>,</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a>        <span class=n>mask_interpolation</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_NEAREST</span><span class=p>,</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a>        <span class=n>cval</span><span class=p>:</span> <span class=n>ColorType</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a>        <span class=n>cval_mask</span><span class=p>:</span> <span class=n>ColorType</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a>        <span class=n>mode</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>BORDER_CONSTANT</span><span class=p>,</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a>        <span class=n>fit_output</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a>        <span class=n>keep_ratio</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><a href=#__codelineno-0-152><span class=linenos data-linenos="152 "></span></a>        <span class=n>rotate_method</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>"largest_box"</span><span class=p>,</span> <span class=s2>"ellipse"</span><span class=p>]</span> <span class=o>=</span> <span class=s2>"largest_box"</span><span class=p>,</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><a href=#__codelineno-0-153><span class=linenos data-linenos="153 "></span></a>        <span class=n>balanced_scale</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><a href=#__codelineno-0-154><span class=linenos data-linenos="154 "></span></a>        <span class=n>always_apply</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>bool</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><a href=#__codelineno-0-155><span class=linenos data-linenos="155 "></span></a>        <span class=n>p</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.5</span><span class=p>,</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><a href=#__codelineno-0-156><span class=linenos data-linenos="156 "></span></a>    <span class=p>):</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><a href=#__codelineno-0-157><span class=linenos data-linenos="157 "></span></a>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=n>always_apply</span><span class=o>=</span><span class=n>always_apply</span><span class=p>,</span> <span class=n>p</span><span class=o>=</span><span class=n>p</span><span class=p>)</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><a href=#__codelineno-0-158><span class=linenos data-linenos="158 "></span></a>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><a href=#__codelineno-0-159><span class=linenos data-linenos="159 "></span></a>        <span class=n>params</span> <span class=o>=</span> <span class=p>[</span><span class=n>scale</span><span class=p>,</span> <span class=n>translate_percent</span><span class=p>,</span> <span class=n>translate_px</span><span class=p>,</span> <span class=n>rotate</span><span class=p>,</span> <span class=n>shear</span><span class=p>]</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><a href=#__codelineno-0-160><span class=linenos data-linenos="160 "></span></a>        <span class=k>if</span> <span class=nb>all</span><span class=p>(</span><span class=n>p</span> <span class=ow>is</span> <span class=kc>None</span> <span class=k>for</span> <span class=n>p</span> <span class=ow>in</span> <span class=n>params</span><span class=p>):</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><a href=#__codelineno-0-161><span class=linenos data-linenos="161 "></span></a>            <span class=n>scale</span> <span class=o>=</span> <span class=p>{</span><span class=s2>"x"</span><span class=p>:</span> <span class=p>(</span><span class=mf>0.9</span><span class=p>,</span> <span class=mf>1.1</span><span class=p>),</span> <span class=s2>"y"</span><span class=p>:</span> <span class=p>(</span><span class=mf>0.9</span><span class=p>,</span> <span class=mf>1.1</span><span class=p>)}</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><a href=#__codelineno-0-162><span class=linenos data-linenos="162 "></span></a>            <span class=n>translate_percent</span> <span class=o>=</span> <span class=p>{</span><span class=s2>"x"</span><span class=p>:</span> <span class=p>(</span><span class=o>-</span><span class=mf>0.1</span><span class=p>,</span> <span class=mf>0.1</span><span class=p>),</span> <span class=s2>"y"</span><span class=p>:</span> <span class=p>(</span><span class=o>-</span><span class=mf>0.1</span><span class=p>,</span> <span class=mf>0.1</span><span class=p>)}</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><a href=#__codelineno-0-163><span class=linenos data-linenos="163 "></span></a>            <span class=n>rotate</span> <span class=o>=</span> <span class=p>(</span><span class=o>-</span><span class=mi>15</span><span class=p>,</span> <span class=mi>15</span><span class=p>)</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><a href=#__codelineno-0-164><span class=linenos data-linenos="164 "></span></a>            <span class=n>shear</span> <span class=o>=</span> <span class=p>{</span><span class=s2>"x"</span><span class=p>:</span> <span class=p>(</span><span class=o>-</span><span class=mi>10</span><span class=p>,</span> <span class=mi>10</span><span class=p>),</span> <span class=s2>"y"</span><span class=p>:</span> <span class=p>(</span><span class=o>-</span><span class=mi>10</span><span class=p>,</span> <span class=mi>10</span><span class=p>)}</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><a href=#__codelineno-0-165><span class=linenos data-linenos="165 "></span></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><a href=#__codelineno-0-166><span class=linenos data-linenos="166 "></span></a>            <span class=n>scale</span> <span class=o>=</span> <span class=n>scale</span> <span class=k>if</span> <span class=n>scale</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=k>else</span> <span class=mf>1.0</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><a href=#__codelineno-0-167><span class=linenos data-linenos="167 "></span></a>            <span class=n>rotate</span> <span class=o>=</span> <span class=n>rotate</span> <span class=k>if</span> <span class=n>rotate</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=k>else</span> <span class=mf>0.0</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><a href=#__codelineno-0-168><span class=linenos data-linenos="168 "></span></a>            <span class=n>shear</span> <span class=o>=</span> <span class=n>shear</span> <span class=k>if</span> <span class=n>shear</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=k>else</span> <span class=mf>0.0</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a><a href=#__codelineno-0-169><span class=linenos data-linenos="169 "></span></a>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a><a href=#__codelineno-0-170><span class=linenos data-linenos="170 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>interpolation</span> <span class=o>=</span> <span class=n>interpolation</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a><a href=#__codelineno-0-171><span class=linenos data-linenos="171 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>mask_interpolation</span> <span class=o>=</span> <span class=n>mask_interpolation</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a><a href=#__codelineno-0-172><span class=linenos data-linenos="172 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>cval</span> <span class=o>=</span> <span class=n>cval</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a><a href=#__codelineno-0-173><span class=linenos data-linenos="173 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>cval_mask</span> <span class=o>=</span> <span class=n>cval_mask</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a><a href=#__codelineno-0-174><span class=linenos data-linenos="174 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>mode</span> <span class=o>=</span> <span class=n>mode</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a><a href=#__codelineno-0-175><span class=linenos data-linenos="175 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>scale</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_handle_dict_arg</span><span class=p>(</span><span class=n>scale</span><span class=p>,</span> <span class=s2>"scale"</span><span class=p>)</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a><a href=#__codelineno-0-176><span class=linenos data-linenos="176 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>translate_percent</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>translate_px</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_handle_translate_arg</span><span class=p>(</span><span class=n>translate_px</span><span class=p>,</span> <span class=n>translate_percent</span><span class=p>)</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a><a href=#__codelineno-0-177><span class=linenos data-linenos="177 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>rotate</span> <span class=o>=</span> <span class=n>to_tuple</span><span class=p>(</span><span class=n>rotate</span><span class=p>,</span> <span class=n>rotate</span><span class=p>)</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a><a href=#__codelineno-0-178><span class=linenos data-linenos="178 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>fit_output</span> <span class=o>=</span> <span class=n>fit_output</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a><a href=#__codelineno-0-179><span class=linenos data-linenos="179 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>shear</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_handle_dict_arg</span><span class=p>(</span><span class=n>shear</span><span class=p>,</span> <span class=s2>"shear"</span><span class=p>)</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a><a href=#__codelineno-0-180><span class=linenos data-linenos="180 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>keep_ratio</span> <span class=o>=</span> <span class=n>keep_ratio</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a><a href=#__codelineno-0-181><span class=linenos data-linenos="181 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>rotate_method</span> <span class=o>=</span> <span class=n>rotate_method</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a><a href=#__codelineno-0-182><span class=linenos data-linenos="182 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>balanced_scale</span> <span class=o>=</span> <span class=n>balanced_scale</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a><a href=#__codelineno-0-183><span class=linenos data-linenos="183 "></span></a>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a><a href=#__codelineno-0-184><span class=linenos data-linenos="184 "></span></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>keep_ratio</span> <span class=ow>and</span> <span class=bp>self</span><span class=o>.</span><span class=n>scale</span><span class=p>[</span><span class=s2>"x"</span><span class=p>]</span> <span class=o>!=</span> <span class=bp>self</span><span class=o>.</span><span class=n>scale</span><span class=p>[</span><span class=s2>"y"</span><span class=p>]:</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a><a href=#__codelineno-0-185><span class=linenos data-linenos="185 "></span></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>"When keep_ratio is True, the x and y scale range should be identical. got </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>scale</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a><a href=#__codelineno-0-186><span class=linenos data-linenos="186 "></span></a>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a><a href=#__codelineno-0-187><span class=linenos data-linenos="187 "></span></a>    <span class=k>def</span> <span class=nf>get_transform_init_args_names</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=o>...</span><span class=p>]:</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a><a href=#__codelineno-0-188><span class=linenos data-linenos="188 "></span></a>        <span class=k>return</span> <span class=p>(</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a><a href=#__codelineno-0-189><span class=linenos data-linenos="189 "></span></a>            <span class=s2>"interpolation"</span><span class=p>,</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a><a href=#__codelineno-0-190><span class=linenos data-linenos="190 "></span></a>            <span class=s2>"mask_interpolation"</span><span class=p>,</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a><a href=#__codelineno-0-191><span class=linenos data-linenos="191 "></span></a>            <span class=s2>"cval"</span><span class=p>,</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a><a href=#__codelineno-0-192><span class=linenos data-linenos="192 "></span></a>            <span class=s2>"mode"</span><span class=p>,</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a><a href=#__codelineno-0-193><span class=linenos data-linenos="193 "></span></a>            <span class=s2>"scale"</span><span class=p>,</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a><a href=#__codelineno-0-194><span class=linenos data-linenos="194 "></span></a>            <span class=s2>"translate_percent"</span><span class=p>,</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a><a href=#__codelineno-0-195><span class=linenos data-linenos="195 "></span></a>            <span class=s2>"translate_px"</span><span class=p>,</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a><a href=#__codelineno-0-196><span class=linenos data-linenos="196 "></span></a>            <span class=s2>"rotate"</span><span class=p>,</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a><a href=#__codelineno-0-197><span class=linenos data-linenos="197 "></span></a>            <span class=s2>"fit_output"</span><span class=p>,</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a><a href=#__codelineno-0-198><span class=linenos data-linenos="198 "></span></a>            <span class=s2>"shear"</span><span class=p>,</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a><a href=#__codelineno-0-199><span class=linenos data-linenos="199 "></span></a>            <span class=s2>"cval_mask"</span><span class=p>,</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a><a href=#__codelineno-0-200><span class=linenos data-linenos="200 "></span></a>            <span class=s2>"keep_ratio"</span><span class=p>,</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a><a href=#__codelineno-0-201><span class=linenos data-linenos="201 "></span></a>            <span class=s2>"rotate_method"</span><span class=p>,</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a><a href=#__codelineno-0-202><span class=linenos data-linenos="202 "></span></a>            <span class=s2>"balanced_scale"</span><span class=p>,</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a><a href=#__codelineno-0-203><span class=linenos data-linenos="203 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a><a href=#__codelineno-0-204><span class=linenos data-linenos="204 "></span></a>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a><a href=#__codelineno-0-205><span class=linenos data-linenos="205 "></span></a>    <span class=nd>@staticmethod</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a><a href=#__codelineno-0-206><span class=linenos data-linenos="206 "></span></a>    <span class=k>def</span> <span class=nf>_handle_dict_arg</span><span class=p>(</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a><a href=#__codelineno-0-207><span class=linenos data-linenos="207 "></span></a>        <span class=n>val</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>],</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]],</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a><a href=#__codelineno-0-208><span class=linenos data-linenos="208 "></span></a>        <span class=n>name</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a><a href=#__codelineno-0-209><span class=linenos data-linenos="209 "></span></a>        <span class=n>default</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a><a href=#__codelineno-0-210><span class=linenos data-linenos="210 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a><a href=#__codelineno-0-211><span class=linenos data-linenos="211 "></span></a>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>val</span><span class=p>,</span> <span class=nb>dict</span><span class=p>):</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a><a href=#__codelineno-0-212><span class=linenos data-linenos="212 "></span></a>            <span class=k>if</span> <span class=s2>"x"</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>val</span> <span class=ow>and</span> <span class=s2>"y"</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>val</span><span class=p>:</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a><a href=#__codelineno-0-213><span class=linenos data-linenos="213 "></span></a>                <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a><a href=#__codelineno-0-214><span class=linenos data-linenos="214 "></span></a>                    <span class=sa>f</span><span class=s1>'Expected </span><span class=si>{</span><span class=n>name</span><span class=si>}</span><span class=s1> dictionary to contain at least key "x" or key "y". Found neither of them.'</span><span class=p>,</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a><a href=#__codelineno-0-215><span class=linenos data-linenos="215 "></span></a>                <span class=p>)</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a><a href=#__codelineno-0-216><span class=linenos data-linenos="216 "></span></a>            <span class=n>x</span> <span class=o>=</span> <span class=n>val</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>"x"</span><span class=p>,</span> <span class=n>default</span><span class=p>)</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a><a href=#__codelineno-0-217><span class=linenos data-linenos="217 "></span></a>            <span class=n>y</span> <span class=o>=</span> <span class=n>val</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>"y"</span><span class=p>,</span> <span class=n>default</span><span class=p>)</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a><a href=#__codelineno-0-218><span class=linenos data-linenos="218 "></span></a>            <span class=k>return</span> <span class=p>{</span><span class=s2>"x"</span><span class=p>:</span> <span class=n>to_tuple</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>x</span><span class=p>),</span> <span class=s2>"y"</span><span class=p>:</span> <span class=n>to_tuple</span><span class=p>(</span><span class=n>y</span><span class=p>,</span> <span class=n>y</span><span class=p>)}</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a><a href=#__codelineno-0-219><span class=linenos data-linenos="219 "></span></a>        <span class=k>return</span> <span class=p>{</span><span class=s2>"x"</span><span class=p>:</span> <span class=n>to_tuple</span><span class=p>(</span><span class=n>val</span><span class=p>,</span> <span class=n>val</span><span class=p>),</span> <span class=s2>"y"</span><span class=p>:</span> <span class=n>to_tuple</span><span class=p>(</span><span class=n>val</span><span class=p>,</span> <span class=n>val</span><span class=p>)}</span>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a><a href=#__codelineno-0-220><span class=linenos data-linenos="220 "></span></a>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a><a href=#__codelineno-0-221><span class=linenos data-linenos="221 "></span></a>    <span class=nd>@classmethod</span>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a><a href=#__codelineno-0-222><span class=linenos data-linenos="222 "></span></a>    <span class=k>def</span> <span class=nf>_handle_translate_arg</span><span class=p>(</span>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a><a href=#__codelineno-0-223><span class=linenos data-linenos="223 "></span></a>        <span class=bp>cls</span><span class=p>,</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a><a href=#__codelineno-0-224><span class=linenos data-linenos="224 "></span></a>        <span class=n>translate_px</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=n>ScaleFloatType</span><span class=p>,</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]]],</span>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a><a href=#__codelineno-0-225><span class=linenos data-linenos="225 "></span></a>        <span class=n>translate_percent</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=n>ScaleFloatType</span><span class=p>,</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]]],</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a><a href=#__codelineno-0-226><span class=linenos data-linenos="226 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Any</span><span class=p>:</span>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a><a href=#__codelineno-0-227><span class=linenos data-linenos="227 "></span></a>        <span class=k>if</span> <span class=n>translate_percent</span> <span class=ow>is</span> <span class=kc>None</span> <span class=ow>and</span> <span class=n>translate_px</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a><a href=#__codelineno-0-228><span class=linenos data-linenos="228 "></span></a>            <span class=n>translate_px</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a><a href=#__codelineno-0-229><span class=linenos data-linenos="229 "></span></a>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a><a href=#__codelineno-0-230><span class=linenos data-linenos="230 "></span></a>        <span class=k>if</span> <span class=n>translate_percent</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=ow>and</span> <span class=n>translate_px</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a><a href=#__codelineno-0-231><span class=linenos data-linenos="231 "></span></a>            <span class=n>msg</span> <span class=o>=</span> <span class=s2>"Expected either translate_percent or translate_px to be provided, but both were provided."</span>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a><a href=#__codelineno-0-232><span class=linenos data-linenos="232 "></span></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a><a href=#__codelineno-0-233><span class=linenos data-linenos="233 "></span></a>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a><a href=#__codelineno-0-234><span class=linenos data-linenos="234 "></span></a>        <span class=k>if</span> <span class=n>translate_percent</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a><a href=#__codelineno-0-235><span class=linenos data-linenos="235 "></span></a>            <span class=c1># translate by percent</span>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a><a href=#__codelineno-0-236><span class=linenos data-linenos="236 "></span></a>            <span class=k>return</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_handle_dict_arg</span><span class=p>(</span><span class=n>translate_percent</span><span class=p>,</span> <span class=s2>"translate_percent"</span><span class=p>,</span> <span class=n>default</span><span class=o>=</span><span class=mf>0.0</span><span class=p>),</span> <span class=n>translate_px</span>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a><a href=#__codelineno-0-237><span class=linenos data-linenos="237 "></span></a>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a><a href=#__codelineno-0-238><span class=linenos data-linenos="238 "></span></a>        <span class=k>if</span> <span class=n>translate_px</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a><a href=#__codelineno-0-239><span class=linenos data-linenos="239 "></span></a>            <span class=n>msg</span> <span class=o>=</span> <span class=s2>"translate_px is None."</span>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a><a href=#__codelineno-0-240><span class=linenos data-linenos="240 "></span></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a><a href=#__codelineno-0-241><span class=linenos data-linenos="241 "></span></a>        <span class=c1># translate by pixels</span>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a><a href=#__codelineno-0-242><span class=linenos data-linenos="242 "></span></a>        <span class=k>return</span> <span class=n>translate_percent</span><span class=p>,</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_handle_dict_arg</span><span class=p>(</span><span class=n>translate_px</span><span class=p>,</span> <span class=s2>"translate_px"</span><span class=p>)</span>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a><a href=#__codelineno-0-243><span class=linenos data-linenos="243 "></span></a>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a><a href=#__codelineno-0-244><span class=linenos data-linenos="244 "></span></a>    <span class=k>def</span> <span class=nf>apply</span><span class=p>(</span>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a><a href=#__codelineno-0-245><span class=linenos data-linenos="245 "></span></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a><a href=#__codelineno-0-246><span class=linenos data-linenos="246 "></span></a>        <span class=n>img</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a><a href=#__codelineno-0-247><span class=linenos data-linenos="247 "></span></a>        <span class=n>matrix</span><span class=p>:</span> <span class=n>skimage</span><span class=o>.</span><span class=n>transform</span><span class=o>.</span><span class=n>ProjectiveTransform</span><span class=p>,</span>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a><a href=#__codelineno-0-248><span class=linenos data-linenos="248 "></span></a>        <span class=n>output_shape</span><span class=p>:</span> <span class=n>SizeType</span><span class=p>,</span>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a><a href=#__codelineno-0-249><span class=linenos data-linenos="249 "></span></a>        <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>,</span>
</span><span id=__span-0-250><a id=__codelineno-0-250 name=__codelineno-0-250></a><a href=#__codelineno-0-250><span class=linenos data-linenos="250 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a><a href=#__codelineno-0-251><span class=linenos data-linenos="251 "></span></a>        <span class=k>return</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>warp_affine</span><span class=p>(</span>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a><a href=#__codelineno-0-252><span class=linenos data-linenos="252 "></span></a>            <span class=n>img</span><span class=p>,</span>
</span><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a><a href=#__codelineno-0-253><span class=linenos data-linenos="253 "></span></a>            <span class=n>matrix</span><span class=p>,</span>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a><a href=#__codelineno-0-254><span class=linenos data-linenos="254 "></span></a>            <span class=n>interpolation</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>interpolation</span><span class=p>,</span>
</span><span id=__span-0-255><a id=__codelineno-0-255 name=__codelineno-0-255></a><a href=#__codelineno-0-255><span class=linenos data-linenos="255 "></span></a>            <span class=n>cval</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>cval</span><span class=p>,</span>
</span><span id=__span-0-256><a id=__codelineno-0-256 name=__codelineno-0-256></a><a href=#__codelineno-0-256><span class=linenos data-linenos="256 "></span></a>            <span class=n>mode</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>mode</span><span class=p>,</span>
</span><span id=__span-0-257><a id=__codelineno-0-257 name=__codelineno-0-257></a><a href=#__codelineno-0-257><span class=linenos data-linenos="257 "></span></a>            <span class=n>output_shape</span><span class=o>=</span><span class=n>output_shape</span><span class=p>,</span>
</span><span id=__span-0-258><a id=__codelineno-0-258 name=__codelineno-0-258></a><a href=#__codelineno-0-258><span class=linenos data-linenos="258 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-259><a id=__codelineno-0-259 name=__codelineno-0-259></a><a href=#__codelineno-0-259><span class=linenos data-linenos="259 "></span></a>
</span><span id=__span-0-260><a id=__codelineno-0-260 name=__codelineno-0-260></a><a href=#__codelineno-0-260><span class=linenos data-linenos="260 "></span></a>    <span class=k>def</span> <span class=nf>apply_to_mask</span><span class=p>(</span>
</span><span id=__span-0-261><a id=__codelineno-0-261 name=__codelineno-0-261></a><a href=#__codelineno-0-261><span class=linenos data-linenos="261 "></span></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-262><a id=__codelineno-0-262 name=__codelineno-0-262></a><a href=#__codelineno-0-262><span class=linenos data-linenos="262 "></span></a>        <span class=n>mask</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
</span><span id=__span-0-263><a id=__codelineno-0-263 name=__codelineno-0-263></a><a href=#__codelineno-0-263><span class=linenos data-linenos="263 "></span></a>        <span class=n>matrix</span><span class=p>:</span> <span class=n>skimage</span><span class=o>.</span><span class=n>transform</span><span class=o>.</span><span class=n>ProjectiveTransform</span><span class=p>,</span>
</span><span id=__span-0-264><a id=__codelineno-0-264 name=__codelineno-0-264></a><a href=#__codelineno-0-264><span class=linenos data-linenos="264 "></span></a>        <span class=n>output_shape</span><span class=p>:</span> <span class=n>SizeType</span><span class=p>,</span>
</span><span id=__span-0-265><a id=__codelineno-0-265 name=__codelineno-0-265></a><a href=#__codelineno-0-265><span class=linenos data-linenos="265 "></span></a>        <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>,</span>
</span><span id=__span-0-266><a id=__codelineno-0-266 name=__codelineno-0-266></a><a href=#__codelineno-0-266><span class=linenos data-linenos="266 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-0-267><a id=__codelineno-0-267 name=__codelineno-0-267></a><a href=#__codelineno-0-267><span class=linenos data-linenos="267 "></span></a>        <span class=k>return</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>warp_affine</span><span class=p>(</span>
</span><span id=__span-0-268><a id=__codelineno-0-268 name=__codelineno-0-268></a><a href=#__codelineno-0-268><span class=linenos data-linenos="268 "></span></a>            <span class=n>mask</span><span class=p>,</span>
</span><span id=__span-0-269><a id=__codelineno-0-269 name=__codelineno-0-269></a><a href=#__codelineno-0-269><span class=linenos data-linenos="269 "></span></a>            <span class=n>matrix</span><span class=p>,</span>
</span><span id=__span-0-270><a id=__codelineno-0-270 name=__codelineno-0-270></a><a href=#__codelineno-0-270><span class=linenos data-linenos="270 "></span></a>            <span class=n>interpolation</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>mask_interpolation</span><span class=p>,</span>
</span><span id=__span-0-271><a id=__codelineno-0-271 name=__codelineno-0-271></a><a href=#__codelineno-0-271><span class=linenos data-linenos="271 "></span></a>            <span class=n>cval</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>cval_mask</span><span class=p>,</span>
</span><span id=__span-0-272><a id=__codelineno-0-272 name=__codelineno-0-272></a><a href=#__codelineno-0-272><span class=linenos data-linenos="272 "></span></a>            <span class=n>mode</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>mode</span><span class=p>,</span>
</span><span id=__span-0-273><a id=__codelineno-0-273 name=__codelineno-0-273></a><a href=#__codelineno-0-273><span class=linenos data-linenos="273 "></span></a>            <span class=n>output_shape</span><span class=o>=</span><span class=n>output_shape</span><span class=p>,</span>
</span><span id=__span-0-274><a id=__codelineno-0-274 name=__codelineno-0-274></a><a href=#__codelineno-0-274><span class=linenos data-linenos="274 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-275><a id=__codelineno-0-275 name=__codelineno-0-275></a><a href=#__codelineno-0-275><span class=linenos data-linenos="275 "></span></a>
</span><span id=__span-0-276><a id=__codelineno-0-276 name=__codelineno-0-276></a><a href=#__codelineno-0-276><span class=linenos data-linenos="276 "></span></a>    <span class=k>def</span> <span class=nf>apply_to_bbox</span><span class=p>(</span>
</span><span id=__span-0-277><a id=__codelineno-0-277 name=__codelineno-0-277></a><a href=#__codelineno-0-277><span class=linenos data-linenos="277 "></span></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-278><a id=__codelineno-0-278 name=__codelineno-0-278></a><a href=#__codelineno-0-278><span class=linenos data-linenos="278 "></span></a>        <span class=n>bbox</span><span class=p>:</span> <span class=n>BoxInternalType</span><span class=p>,</span>
</span><span id=__span-0-279><a id=__codelineno-0-279 name=__codelineno-0-279></a><a href=#__codelineno-0-279><span class=linenos data-linenos="279 "></span></a>        <span class=n>matrix</span><span class=p>:</span> <span class=n>skimage</span><span class=o>.</span><span class=n>transform</span><span class=o>.</span><span class=n>ProjectiveTransform</span><span class=p>,</span>
</span><span id=__span-0-280><a id=__codelineno-0-280 name=__codelineno-0-280></a><a href=#__codelineno-0-280><span class=linenos data-linenos="280 "></span></a>        <span class=n>rows</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-281><a id=__codelineno-0-281 name=__codelineno-0-281></a><a href=#__codelineno-0-281><span class=linenos data-linenos="281 "></span></a>        <span class=n>cols</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-282><a id=__codelineno-0-282 name=__codelineno-0-282></a><a href=#__codelineno-0-282><span class=linenos data-linenos="282 "></span></a>        <span class=n>output_shape</span><span class=p>:</span> <span class=n>Sequence</span><span class=p>[</span><span class=nb>int</span><span class=p>],</span>
</span><span id=__span-0-283><a id=__codelineno-0-283 name=__codelineno-0-283></a><a href=#__codelineno-0-283><span class=linenos data-linenos="283 "></span></a>        <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>,</span>
</span><span id=__span-0-284><a id=__codelineno-0-284 name=__codelineno-0-284></a><a href=#__codelineno-0-284><span class=linenos data-linenos="284 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>BoxInternalType</span><span class=p>:</span>
</span><span id=__span-0-285><a id=__codelineno-0-285 name=__codelineno-0-285></a><a href=#__codelineno-0-285><span class=linenos data-linenos="285 "></span></a>        <span class=k>return</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>bbox_affine</span><span class=p>(</span><span class=n>bbox</span><span class=p>,</span> <span class=n>matrix</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>rotate_method</span><span class=p>,</span> <span class=n>rows</span><span class=p>,</span> <span class=n>cols</span><span class=p>,</span> <span class=n>output_shape</span><span class=p>)</span>
</span><span id=__span-0-286><a id=__codelineno-0-286 name=__codelineno-0-286></a><a href=#__codelineno-0-286><span class=linenos data-linenos="286 "></span></a>
</span><span id=__span-0-287><a id=__codelineno-0-287 name=__codelineno-0-287></a><a href=#__codelineno-0-287><span class=linenos data-linenos="287 "></span></a>    <span class=k>def</span> <span class=nf>apply_to_keypoint</span><span class=p>(</span>
</span><span id=__span-0-288><a id=__codelineno-0-288 name=__codelineno-0-288></a><a href=#__codelineno-0-288><span class=linenos data-linenos="288 "></span></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-289><a id=__codelineno-0-289 name=__codelineno-0-289></a><a href=#__codelineno-0-289><span class=linenos data-linenos="289 "></span></a>        <span class=n>keypoint</span><span class=p>:</span> <span class=n>KeypointInternalType</span><span class=p>,</span>
</span><span id=__span-0-290><a id=__codelineno-0-290 name=__codelineno-0-290></a><a href=#__codelineno-0-290><span class=linenos data-linenos="290 "></span></a>        <span class=n>matrix</span><span class=p>:</span> <span class=n>skimage</span><span class=o>.</span><span class=n>transform</span><span class=o>.</span><span class=n>ProjectiveTransform</span><span class=p>,</span>
</span><span id=__span-0-291><a id=__codelineno-0-291 name=__codelineno-0-291></a><a href=#__codelineno-0-291><span class=linenos data-linenos="291 "></span></a>        <span class=n>scale</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>],</span>
</span><span id=__span-0-292><a id=__codelineno-0-292 name=__codelineno-0-292></a><a href=#__codelineno-0-292><span class=linenos data-linenos="292 "></span></a>        <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>,</span>
</span><span id=__span-0-293><a id=__codelineno-0-293 name=__codelineno-0-293></a><a href=#__codelineno-0-293><span class=linenos data-linenos="293 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>KeypointInternalType</span><span class=p>:</span>
</span><span id=__span-0-294><a id=__codelineno-0-294 name=__codelineno-0-294></a><a href=#__codelineno-0-294><span class=linenos data-linenos="294 "></span></a>        <span class=k>if</span> <span class=n>scale</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-295><a id=__codelineno-0-295 name=__codelineno-0-295></a><a href=#__codelineno-0-295><span class=linenos data-linenos="295 "></span></a>            <span class=n>msg</span> <span class=o>=</span> <span class=s2>"Expected scale to be provided, but got None."</span>
</span><span id=__span-0-296><a id=__codelineno-0-296 name=__codelineno-0-296></a><a href=#__codelineno-0-296><span class=linenos data-linenos="296 "></span></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
</span><span id=__span-0-297><a id=__codelineno-0-297 name=__codelineno-0-297></a><a href=#__codelineno-0-297><span class=linenos data-linenos="297 "></span></a>        <span class=k>if</span> <span class=n>matrix</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-298><a id=__codelineno-0-298 name=__codelineno-0-298></a><a href=#__codelineno-0-298><span class=linenos data-linenos="298 "></span></a>            <span class=n>msg</span> <span class=o>=</span> <span class=s2>"Expected matrix to be provided, but got None."</span>
</span><span id=__span-0-299><a id=__codelineno-0-299 name=__codelineno-0-299></a><a href=#__codelineno-0-299><span class=linenos data-linenos="299 "></span></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
</span><span id=__span-0-300><a id=__codelineno-0-300 name=__codelineno-0-300></a><a href=#__codelineno-0-300><span class=linenos data-linenos="300 "></span></a>
</span><span id=__span-0-301><a id=__codelineno-0-301 name=__codelineno-0-301></a><a href=#__codelineno-0-301><span class=linenos data-linenos="301 "></span></a>        <span class=k>return</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>keypoint_affine</span><span class=p>(</span><span class=n>keypoint</span><span class=p>,</span> <span class=n>matrix</span><span class=o>=</span><span class=n>matrix</span><span class=p>,</span> <span class=n>scale</span><span class=o>=</span><span class=n>scale</span><span class=p>)</span>
</span><span id=__span-0-302><a id=__codelineno-0-302 name=__codelineno-0-302></a><a href=#__codelineno-0-302><span class=linenos data-linenos="302 "></span></a>
</span><span id=__span-0-303><a id=__codelineno-0-303 name=__codelineno-0-303></a><a href=#__codelineno-0-303><span class=linenos data-linenos="303 "></span></a>    <span class=nd>@property</span>
</span><span id=__span-0-304><a id=__codelineno-0-304 name=__codelineno-0-304></a><a href=#__codelineno-0-304><span class=linenos data-linenos="304 "></span></a>    <span class=k>def</span> <span class=nf>targets_as_params</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]:</span>
</span><span id=__span-0-305><a id=__codelineno-0-305 name=__codelineno-0-305></a><a href=#__codelineno-0-305><span class=linenos data-linenos="305 "></span></a>        <span class=k>return</span> <span class=p>[</span><span class=s2>"image"</span><span class=p>]</span>
</span><span id=__span-0-306><a id=__codelineno-0-306 name=__codelineno-0-306></a><a href=#__codelineno-0-306><span class=linenos data-linenos="306 "></span></a>
</span><span id=__span-0-307><a id=__codelineno-0-307 name=__codelineno-0-307></a><a href=#__codelineno-0-307><span class=linenos data-linenos="307 "></span></a>    <span class=nd>@staticmethod</span>
</span><span id=__span-0-308><a id=__codelineno-0-308 name=__codelineno-0-308></a><a href=#__codelineno-0-308><span class=linenos data-linenos="308 "></span></a>    <span class=k>def</span> <span class=nf>get_scale</span><span class=p>(</span><span class=n>scale</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>]],</span> <span class=n>keep_ratio</span><span class=p>:</span> <span class=nb>bool</span><span class=p>,</span> <span class=n>balanced_scale</span><span class=p>:</span> <span class=nb>bool</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>float</span><span class=p>]:</span>
</span><span id=__span-0-309><a id=__codelineno-0-309 name=__codelineno-0-309></a><a href=#__codelineno-0-309><span class=linenos data-linenos="309 "></span></a>        <span class=n>result_scale</span> <span class=o>=</span> <span class=p>{}</span>
</span><span id=__span-0-310><a id=__codelineno-0-310 name=__codelineno-0-310></a><a href=#__codelineno-0-310><span class=linenos data-linenos="310 "></span></a>        <span class=k>if</span> <span class=n>balanced_scale</span><span class=p>:</span>
</span><span id=__span-0-311><a id=__codelineno-0-311 name=__codelineno-0-311></a><a href=#__codelineno-0-311><span class=linenos data-linenos="311 "></span></a>            <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>value</span> <span class=ow>in</span> <span class=n>scale</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span><span id=__span-0-312><a id=__codelineno-0-312 name=__codelineno-0-312></a><a href=#__codelineno-0-312><span class=linenos data-linenos="312 "></span></a>                <span class=n>lower_interval</span> <span class=o>=</span> <span class=p>(</span><span class=n>value</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=mf>1.0</span><span class=p>)</span> <span class=k>if</span> <span class=n>value</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>&lt;</span> <span class=mi>1</span> <span class=k>else</span> <span class=kc>None</span>
</span><span id=__span-0-313><a id=__codelineno-0-313 name=__codelineno-0-313></a><a href=#__codelineno-0-313><span class=linenos data-linenos="313 "></span></a>                <span class=n>upper_interval</span> <span class=o>=</span> <span class=p>(</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>value</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span> <span class=k>if</span> <span class=n>value</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>1</span> <span class=k>else</span> <span class=kc>None</span>
</span><span id=__span-0-314><a id=__codelineno-0-314 name=__codelineno-0-314></a><a href=#__codelineno-0-314><span class=linenos data-linenos="314 "></span></a>
</span><span id=__span-0-315><a id=__codelineno-0-315 name=__codelineno-0-315></a><a href=#__codelineno-0-315><span class=linenos data-linenos="315 "></span></a>                <span class=k>if</span> <span class=n>lower_interval</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=ow>and</span> <span class=n>upper_interval</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-316><a id=__codelineno-0-316 name=__codelineno-0-316></a><a href=#__codelineno-0-316><span class=linenos data-linenos="316 "></span></a>                    <span class=n>selected_interval</span> <span class=o>=</span> <span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>([</span><span class=n>lower_interval</span><span class=p>,</span> <span class=n>upper_interval</span><span class=p>])</span>
</span><span id=__span-0-317><a id=__codelineno-0-317 name=__codelineno-0-317></a><a href=#__codelineno-0-317><span class=linenos data-linenos="317 "></span></a>                <span class=k>elif</span> <span class=n>lower_interval</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-318><a id=__codelineno-0-318 name=__codelineno-0-318></a><a href=#__codelineno-0-318><span class=linenos data-linenos="318 "></span></a>                    <span class=n>selected_interval</span> <span class=o>=</span> <span class=n>lower_interval</span>
</span><span id=__span-0-319><a id=__codelineno-0-319 name=__codelineno-0-319></a><a href=#__codelineno-0-319><span class=linenos data-linenos="319 "></span></a>                <span class=k>elif</span> <span class=n>upper_interval</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-320><a id=__codelineno-0-320 name=__codelineno-0-320></a><a href=#__codelineno-0-320><span class=linenos data-linenos="320 "></span></a>                    <span class=n>selected_interval</span> <span class=o>=</span> <span class=n>upper_interval</span>
</span><span id=__span-0-321><a id=__codelineno-0-321 name=__codelineno-0-321></a><a href=#__codelineno-0-321><span class=linenos data-linenos="321 "></span></a>                <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-322><a id=__codelineno-0-322 name=__codelineno-0-322></a><a href=#__codelineno-0-322><span class=linenos data-linenos="322 "></span></a>                    <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Both lower_interval and upper_interval are None for key: </span><span class=si>{</span><span class=n>key</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-0-323><a id=__codelineno-0-323 name=__codelineno-0-323></a><a href=#__codelineno-0-323><span class=linenos data-linenos="323 "></span></a>
</span><span id=__span-0-324><a id=__codelineno-0-324 name=__codelineno-0-324></a><a href=#__codelineno-0-324><span class=linenos data-linenos="324 "></span></a>                <span class=n>result_scale</span><span class=p>[</span><span class=n>key</span><span class=p>]</span> <span class=o>=</span> <span class=n>random</span><span class=o>.</span><span class=n>uniform</span><span class=p>(</span><span class=o>*</span><span class=n>selected_interval</span><span class=p>)</span>
</span><span id=__span-0-325><a id=__codelineno-0-325 name=__codelineno-0-325></a><a href=#__codelineno-0-325><span class=linenos data-linenos="325 "></span></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-326><a id=__codelineno-0-326 name=__codelineno-0-326></a><a href=#__codelineno-0-326><span class=linenos data-linenos="326 "></span></a>            <span class=n>result_scale</span> <span class=o>=</span> <span class=p>{</span><span class=n>key</span><span class=p>:</span> <span class=n>random</span><span class=o>.</span><span class=n>uniform</span><span class=p>(</span><span class=o>*</span><span class=n>value</span><span class=p>)</span> <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>value</span> <span class=ow>in</span> <span class=n>scale</span><span class=o>.</span><span class=n>items</span><span class=p>()}</span>
</span><span id=__span-0-327><a id=__codelineno-0-327 name=__codelineno-0-327></a><a href=#__codelineno-0-327><span class=linenos data-linenos="327 "></span></a>
</span><span id=__span-0-328><a id=__codelineno-0-328 name=__codelineno-0-328></a><a href=#__codelineno-0-328><span class=linenos data-linenos="328 "></span></a>        <span class=k>if</span> <span class=n>keep_ratio</span><span class=p>:</span>
</span><span id=__span-0-329><a id=__codelineno-0-329 name=__codelineno-0-329></a><a href=#__codelineno-0-329><span class=linenos data-linenos="329 "></span></a>            <span class=n>result_scale</span><span class=p>[</span><span class=s2>"y"</span><span class=p>]</span> <span class=o>=</span> <span class=n>result_scale</span><span class=p>[</span><span class=s2>"x"</span><span class=p>]</span>
</span><span id=__span-0-330><a id=__codelineno-0-330 name=__codelineno-0-330></a><a href=#__codelineno-0-330><span class=linenos data-linenos="330 "></span></a>
</span><span id=__span-0-331><a id=__codelineno-0-331 name=__codelineno-0-331></a><a href=#__codelineno-0-331><span class=linenos data-linenos="331 "></span></a>        <span class=k>return</span> <span class=n>result_scale</span>
</span><span id=__span-0-332><a id=__codelineno-0-332 name=__codelineno-0-332></a><a href=#__codelineno-0-332><span class=linenos data-linenos="332 "></span></a>
</span><span id=__span-0-333><a id=__codelineno-0-333 name=__codelineno-0-333></a><a href=#__codelineno-0-333><span class=linenos data-linenos="333 "></span></a>    <span class=k>def</span> <span class=nf>get_params_dependent_on_targets</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>params</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
</span><span id=__span-0-334><a id=__codelineno-0-334 name=__codelineno-0-334></a><a href=#__codelineno-0-334><span class=linenos data-linenos="334 "></span></a>        <span class=n>height</span><span class=p>,</span> <span class=n>width</span> <span class=o>=</span> <span class=n>params</span><span class=p>[</span><span class=s2>"image"</span><span class=p>]</span><span class=o>.</span><span class=n>shape</span><span class=p>[:</span><span class=mi>2</span><span class=p>]</span>
</span><span id=__span-0-335><a id=__codelineno-0-335 name=__codelineno-0-335></a><a href=#__codelineno-0-335><span class=linenos data-linenos="335 "></span></a>
</span><span id=__span-0-336><a id=__codelineno-0-336 name=__codelineno-0-336></a><a href=#__codelineno-0-336><span class=linenos data-linenos="336 "></span></a>        <span class=n>translate</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Union</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=nb>float</span><span class=p>]]</span>
</span><span id=__span-0-337><a id=__codelineno-0-337 name=__codelineno-0-337></a><a href=#__codelineno-0-337><span class=linenos data-linenos="337 "></span></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>translate_px</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-338><a id=__codelineno-0-338 name=__codelineno-0-338></a><a href=#__codelineno-0-338><span class=linenos data-linenos="338 "></span></a>            <span class=n>translate</span> <span class=o>=</span> <span class=p>{</span><span class=n>key</span><span class=p>:</span> <span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=o>*</span><span class=n>value</span><span class=p>)</span> <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>value</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>translate_px</span><span class=o>.</span><span class=n>items</span><span class=p>()}</span>
</span><span id=__span-0-339><a id=__codelineno-0-339 name=__codelineno-0-339></a><a href=#__codelineno-0-339><span class=linenos data-linenos="339 "></span></a>        <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>translate_percent</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-340><a id=__codelineno-0-340 name=__codelineno-0-340></a><a href=#__codelineno-0-340><span class=linenos data-linenos="340 "></span></a>            <span class=n>translate</span> <span class=o>=</span> <span class=p>{</span><span class=n>key</span><span class=p>:</span> <span class=n>random</span><span class=o>.</span><span class=n>uniform</span><span class=p>(</span><span class=o>*</span><span class=n>value</span><span class=p>)</span> <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>value</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>translate_percent</span><span class=o>.</span><span class=n>items</span><span class=p>()}</span>
</span><span id=__span-0-341><a id=__codelineno-0-341 name=__codelineno-0-341></a><a href=#__codelineno-0-341><span class=linenos data-linenos="341 "></span></a>            <span class=n>translate</span><span class=p>[</span><span class=s2>"x"</span><span class=p>]</span> <span class=o>=</span> <span class=n>translate</span><span class=p>[</span><span class=s2>"x"</span><span class=p>]</span> <span class=o>*</span> <span class=n>width</span>
</span><span id=__span-0-342><a id=__codelineno-0-342 name=__codelineno-0-342></a><a href=#__codelineno-0-342><span class=linenos data-linenos="342 "></span></a>            <span class=n>translate</span><span class=p>[</span><span class=s2>"y"</span><span class=p>]</span> <span class=o>=</span> <span class=n>translate</span><span class=p>[</span><span class=s2>"y"</span><span class=p>]</span> <span class=o>*</span> <span class=n>height</span>
</span><span id=__span-0-343><a id=__codelineno-0-343 name=__codelineno-0-343></a><a href=#__codelineno-0-343><span class=linenos data-linenos="343 "></span></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-344><a id=__codelineno-0-344 name=__codelineno-0-344></a><a href=#__codelineno-0-344><span class=linenos data-linenos="344 "></span></a>            <span class=n>translate</span> <span class=o>=</span> <span class=p>{</span><span class=s2>"x"</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=s2>"y"</span><span class=p>:</span> <span class=mi>0</span><span class=p>}</span>
</span><span id=__span-0-345><a id=__codelineno-0-345 name=__codelineno-0-345></a><a href=#__codelineno-0-345><span class=linenos data-linenos="345 "></span></a>
</span><span id=__span-0-346><a id=__codelineno-0-346 name=__codelineno-0-346></a><a href=#__codelineno-0-346><span class=linenos data-linenos="346 "></span></a>        <span class=c1># Look to issue https://github.com/albumentations-team/albumentations/issues/1079</span>
</span><span id=__span-0-347><a id=__codelineno-0-347 name=__codelineno-0-347></a><a href=#__codelineno-0-347><span class=linenos data-linenos="347 "></span></a>        <span class=n>shear</span> <span class=o>=</span> <span class=p>{</span><span class=n>key</span><span class=p>:</span> <span class=o>-</span><span class=n>random</span><span class=o>.</span><span class=n>uniform</span><span class=p>(</span><span class=o>*</span><span class=n>value</span><span class=p>)</span> <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>value</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>shear</span><span class=o>.</span><span class=n>items</span><span class=p>()}</span>
</span><span id=__span-0-348><a id=__codelineno-0-348 name=__codelineno-0-348></a><a href=#__codelineno-0-348><span class=linenos data-linenos="348 "></span></a>
</span><span id=__span-0-349><a id=__codelineno-0-349 name=__codelineno-0-349></a><a href=#__codelineno-0-349><span class=linenos data-linenos="349 "></span></a>        <span class=n>scale</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_scale</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>scale</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>keep_ratio</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>balanced_scale</span><span class=p>)</span>
</span><span id=__span-0-350><a id=__codelineno-0-350 name=__codelineno-0-350></a><a href=#__codelineno-0-350><span class=linenos data-linenos="350 "></span></a>
</span><span id=__span-0-351><a id=__codelineno-0-351 name=__codelineno-0-351></a><a href=#__codelineno-0-351><span class=linenos data-linenos="351 "></span></a>        <span class=c1># Look to issue https://github.com/albumentations-team/albumentations/issues/1079</span>
</span><span id=__span-0-352><a id=__codelineno-0-352 name=__codelineno-0-352></a><a href=#__codelineno-0-352><span class=linenos data-linenos="352 "></span></a>        <span class=n>rotate</span> <span class=o>=</span> <span class=o>-</span><span class=n>random</span><span class=o>.</span><span class=n>uniform</span><span class=p>(</span><span class=o>*</span><span class=bp>self</span><span class=o>.</span><span class=n>rotate</span><span class=p>)</span>
</span><span id=__span-0-353><a id=__codelineno-0-353 name=__codelineno-0-353></a><a href=#__codelineno-0-353><span class=linenos data-linenos="353 "></span></a>
</span><span id=__span-0-354><a id=__codelineno-0-354 name=__codelineno-0-354></a><a href=#__codelineno-0-354><span class=linenos data-linenos="354 "></span></a>        <span class=n>shift_x</span><span class=p>,</span> <span class=n>shift_y</span> <span class=o>=</span> <span class=n>center</span><span class=p>(</span><span class=n>width</span><span class=p>,</span> <span class=n>height</span><span class=p>)</span>
</span><span id=__span-0-355><a id=__codelineno-0-355 name=__codelineno-0-355></a><a href=#__codelineno-0-355><span class=linenos data-linenos="355 "></span></a>
</span><span id=__span-0-356><a id=__codelineno-0-356 name=__codelineno-0-356></a><a href=#__codelineno-0-356><span class=linenos data-linenos="356 "></span></a>        <span class=n>matrix_to_topleft</span> <span class=o>=</span> <span class=n>skimage</span><span class=o>.</span><span class=n>transform</span><span class=o>.</span><span class=n>SimilarityTransform</span><span class=p>(</span><span class=n>translation</span><span class=o>=</span><span class=p>[</span><span class=o>-</span><span class=n>shift_x</span><span class=p>,</span> <span class=o>-</span><span class=n>shift_y</span><span class=p>])</span>
</span><span id=__span-0-357><a id=__codelineno-0-357 name=__codelineno-0-357></a><a href=#__codelineno-0-357><span class=linenos data-linenos="357 "></span></a>        <span class=n>matrix_shear_y_rot</span> <span class=o>=</span> <span class=n>skimage</span><span class=o>.</span><span class=n>transform</span><span class=o>.</span><span class=n>AffineTransform</span><span class=p>(</span><span class=n>rotation</span><span class=o>=-</span><span class=n>np</span><span class=o>.</span><span class=n>pi</span> <span class=o>/</span> <span class=mi>2</span><span class=p>)</span>
</span><span id=__span-0-358><a id=__codelineno-0-358 name=__codelineno-0-358></a><a href=#__codelineno-0-358><span class=linenos data-linenos="358 "></span></a>        <span class=n>matrix_shear_y</span> <span class=o>=</span> <span class=n>skimage</span><span class=o>.</span><span class=n>transform</span><span class=o>.</span><span class=n>AffineTransform</span><span class=p>(</span><span class=n>shear</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>deg2rad</span><span class=p>(</span><span class=n>shear</span><span class=p>[</span><span class=s2>"y"</span><span class=p>]))</span>
</span><span id=__span-0-359><a id=__codelineno-0-359 name=__codelineno-0-359></a><a href=#__codelineno-0-359><span class=linenos data-linenos="359 "></span></a>        <span class=n>matrix_shear_y_rot_inv</span> <span class=o>=</span> <span class=n>skimage</span><span class=o>.</span><span class=n>transform</span><span class=o>.</span><span class=n>AffineTransform</span><span class=p>(</span><span class=n>rotation</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>pi</span> <span class=o>/</span> <span class=mi>2</span><span class=p>)</span>
</span><span id=__span-0-360><a id=__codelineno-0-360 name=__codelineno-0-360></a><a href=#__codelineno-0-360><span class=linenos data-linenos="360 "></span></a>        <span class=n>matrix_transforms</span> <span class=o>=</span> <span class=n>skimage</span><span class=o>.</span><span class=n>transform</span><span class=o>.</span><span class=n>AffineTransform</span><span class=p>(</span>
</span><span id=__span-0-361><a id=__codelineno-0-361 name=__codelineno-0-361></a><a href=#__codelineno-0-361><span class=linenos data-linenos="361 "></span></a>            <span class=n>scale</span><span class=o>=</span><span class=p>(</span><span class=n>scale</span><span class=p>[</span><span class=s2>"x"</span><span class=p>],</span> <span class=n>scale</span><span class=p>[</span><span class=s2>"y"</span><span class=p>]),</span>
</span><span id=__span-0-362><a id=__codelineno-0-362 name=__codelineno-0-362></a><a href=#__codelineno-0-362><span class=linenos data-linenos="362 "></span></a>            <span class=n>translation</span><span class=o>=</span><span class=p>(</span><span class=n>translate</span><span class=p>[</span><span class=s2>"x"</span><span class=p>],</span> <span class=n>translate</span><span class=p>[</span><span class=s2>"y"</span><span class=p>]),</span>
</span><span id=__span-0-363><a id=__codelineno-0-363 name=__codelineno-0-363></a><a href=#__codelineno-0-363><span class=linenos data-linenos="363 "></span></a>            <span class=n>rotation</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>deg2rad</span><span class=p>(</span><span class=n>rotate</span><span class=p>),</span>
</span><span id=__span-0-364><a id=__codelineno-0-364 name=__codelineno-0-364></a><a href=#__codelineno-0-364><span class=linenos data-linenos="364 "></span></a>            <span class=n>shear</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>deg2rad</span><span class=p>(</span><span class=n>shear</span><span class=p>[</span><span class=s2>"x"</span><span class=p>]),</span>
</span><span id=__span-0-365><a id=__codelineno-0-365 name=__codelineno-0-365></a><a href=#__codelineno-0-365><span class=linenos data-linenos="365 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-366><a id=__codelineno-0-366 name=__codelineno-0-366></a><a href=#__codelineno-0-366><span class=linenos data-linenos="366 "></span></a>        <span class=n>matrix_to_center</span> <span class=o>=</span> <span class=n>skimage</span><span class=o>.</span><span class=n>transform</span><span class=o>.</span><span class=n>SimilarityTransform</span><span class=p>(</span><span class=n>translation</span><span class=o>=</span><span class=p>[</span><span class=n>shift_x</span><span class=p>,</span> <span class=n>shift_y</span><span class=p>])</span>
</span><span id=__span-0-367><a id=__codelineno-0-367 name=__codelineno-0-367></a><a href=#__codelineno-0-367><span class=linenos data-linenos="367 "></span></a>        <span class=n>matrix</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-368><a id=__codelineno-0-368 name=__codelineno-0-368></a><a href=#__codelineno-0-368><span class=linenos data-linenos="368 "></span></a>            <span class=n>matrix_to_topleft</span>
</span><span id=__span-0-369><a id=__codelineno-0-369 name=__codelineno-0-369></a><a href=#__codelineno-0-369><span class=linenos data-linenos="369 "></span></a>            <span class=o>+</span> <span class=n>matrix_shear_y_rot</span>
</span><span id=__span-0-370><a id=__codelineno-0-370 name=__codelineno-0-370></a><a href=#__codelineno-0-370><span class=linenos data-linenos="370 "></span></a>            <span class=o>+</span> <span class=n>matrix_shear_y</span>
</span><span id=__span-0-371><a id=__codelineno-0-371 name=__codelineno-0-371></a><a href=#__codelineno-0-371><span class=linenos data-linenos="371 "></span></a>            <span class=o>+</span> <span class=n>matrix_shear_y_rot_inv</span>
</span><span id=__span-0-372><a id=__codelineno-0-372 name=__codelineno-0-372></a><a href=#__codelineno-0-372><span class=linenos data-linenos="372 "></span></a>            <span class=o>+</span> <span class=n>matrix_transforms</span>
</span><span id=__span-0-373><a id=__codelineno-0-373 name=__codelineno-0-373></a><a href=#__codelineno-0-373><span class=linenos data-linenos="373 "></span></a>            <span class=o>+</span> <span class=n>matrix_to_center</span>
</span><span id=__span-0-374><a id=__codelineno-0-374 name=__codelineno-0-374></a><a href=#__codelineno-0-374><span class=linenos data-linenos="374 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-375><a id=__codelineno-0-375 name=__codelineno-0-375></a><a href=#__codelineno-0-375><span class=linenos data-linenos="375 "></span></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>fit_output</span><span class=p>:</span>
</span><span id=__span-0-376><a id=__codelineno-0-376 name=__codelineno-0-376></a><a href=#__codelineno-0-376><span class=linenos data-linenos="376 "></span></a>            <span class=n>matrix</span><span class=p>,</span> <span class=n>output_shape</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_compute_affine_warp_output_shape</span><span class=p>(</span><span class=n>matrix</span><span class=p>,</span> <span class=n>params</span><span class=p>[</span><span class=s2>"image"</span><span class=p>]</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span>
</span><span id=__span-0-377><a id=__codelineno-0-377 name=__codelineno-0-377></a><a href=#__codelineno-0-377><span class=linenos data-linenos="377 "></span></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-378><a id=__codelineno-0-378 name=__codelineno-0-378></a><a href=#__codelineno-0-378><span class=linenos data-linenos="378 "></span></a>            <span class=n>output_shape</span> <span class=o>=</span> <span class=n>params</span><span class=p>[</span><span class=s2>"image"</span><span class=p>]</span><span class=o>.</span><span class=n>shape</span>
</span><span id=__span-0-379><a id=__codelineno-0-379 name=__codelineno-0-379></a><a href=#__codelineno-0-379><span class=linenos data-linenos="379 "></span></a>
</span><span id=__span-0-380><a id=__codelineno-0-380 name=__codelineno-0-380></a><a href=#__codelineno-0-380><span class=linenos data-linenos="380 "></span></a>        <span class=k>return</span> <span class=p>{</span>
</span><span id=__span-0-381><a id=__codelineno-0-381 name=__codelineno-0-381></a><a href=#__codelineno-0-381><span class=linenos data-linenos="381 "></span></a>            <span class=s2>"rotate"</span><span class=p>:</span> <span class=n>rotate</span><span class=p>,</span>
</span><span id=__span-0-382><a id=__codelineno-0-382 name=__codelineno-0-382></a><a href=#__codelineno-0-382><span class=linenos data-linenos="382 "></span></a>            <span class=s2>"scale"</span><span class=p>:</span> <span class=n>scale</span><span class=p>,</span>
</span><span id=__span-0-383><a id=__codelineno-0-383 name=__codelineno-0-383></a><a href=#__codelineno-0-383><span class=linenos data-linenos="383 "></span></a>            <span class=s2>"matrix"</span><span class=p>:</span> <span class=n>matrix</span><span class=p>,</span>
</span><span id=__span-0-384><a id=__codelineno-0-384 name=__codelineno-0-384></a><a href=#__codelineno-0-384><span class=linenos data-linenos="384 "></span></a>            <span class=s2>"output_shape"</span><span class=p>:</span> <span class=n>output_shape</span><span class=p>,</span>
</span><span id=__span-0-385><a id=__codelineno-0-385 name=__codelineno-0-385></a><a href=#__codelineno-0-385><span class=linenos data-linenos="385 "></span></a>        <span class=p>}</span>
</span><span id=__span-0-386><a id=__codelineno-0-386 name=__codelineno-0-386></a><a href=#__codelineno-0-386><span class=linenos data-linenos="386 "></span></a>
</span><span id=__span-0-387><a id=__codelineno-0-387 name=__codelineno-0-387></a><a href=#__codelineno-0-387><span class=linenos data-linenos="387 "></span></a>    <span class=nd>@staticmethod</span>
</span><span id=__span-0-388><a id=__codelineno-0-388 name=__codelineno-0-388></a><a href=#__codelineno-0-388><span class=linenos data-linenos="388 "></span></a>    <span class=k>def</span> <span class=nf>_compute_affine_warp_output_shape</span><span class=p>(</span>
</span><span id=__span-0-389><a id=__codelineno-0-389 name=__codelineno-0-389></a><a href=#__codelineno-0-389><span class=linenos data-linenos="389 "></span></a>        <span class=n>matrix</span><span class=p>:</span> <span class=n>skimage</span><span class=o>.</span><span class=n>transform</span><span class=o>.</span><span class=n>ProjectiveTransform</span><span class=p>,</span>
</span><span id=__span-0-390><a id=__codelineno-0-390 name=__codelineno-0-390></a><a href=#__codelineno-0-390><span class=linenos data-linenos="390 "></span></a>        <span class=n>input_shape</span><span class=p>:</span> <span class=n>SizeType</span><span class=p>,</span>
</span><span id=__span-0-391><a id=__codelineno-0-391 name=__codelineno-0-391></a><a href=#__codelineno-0-391><span class=linenos data-linenos="391 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=n>skimage</span><span class=o>.</span><span class=n>transform</span><span class=o>.</span><span class=n>ProjectiveTransform</span><span class=p>,</span> <span class=n>SizeType</span><span class=p>]:</span>
</span><span id=__span-0-392><a id=__codelineno-0-392 name=__codelineno-0-392></a><a href=#__codelineno-0-392><span class=linenos data-linenos="392 "></span></a>        <span class=n>height</span><span class=p>,</span> <span class=n>width</span> <span class=o>=</span> <span class=n>input_shape</span><span class=p>[:</span><span class=mi>2</span><span class=p>]</span>
</span><span id=__span-0-393><a id=__codelineno-0-393 name=__codelineno-0-393></a><a href=#__codelineno-0-393><span class=linenos data-linenos="393 "></span></a>
</span><span id=__span-0-394><a id=__codelineno-0-394 name=__codelineno-0-394></a><a href=#__codelineno-0-394><span class=linenos data-linenos="394 "></span></a>        <span class=k>if</span> <span class=n>height</span> <span class=o>==</span> <span class=mi>0</span> <span class=ow>or</span> <span class=n>width</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-0-395><a id=__codelineno-0-395 name=__codelineno-0-395></a><a href=#__codelineno-0-395><span class=linenos data-linenos="395 "></span></a>            <span class=k>return</span> <span class=n>matrix</span><span class=p>,</span> <span class=n>input_shape</span>
</span><span id=__span-0-396><a id=__codelineno-0-396 name=__codelineno-0-396></a><a href=#__codelineno-0-396><span class=linenos data-linenos="396 "></span></a>
</span><span id=__span-0-397><a id=__codelineno-0-397 name=__codelineno-0-397></a><a href=#__codelineno-0-397><span class=linenos data-linenos="397 "></span></a>        <span class=c1># determine shape of output image</span>
</span><span id=__span-0-398><a id=__codelineno-0-398 name=__codelineno-0-398></a><a href=#__codelineno-0-398><span class=linenos data-linenos="398 "></span></a>        <span class=n>corners</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=n>height</span> <span class=o>-</span> <span class=mi>1</span><span class=p>],</span> <span class=p>[</span><span class=n>width</span> <span class=o>-</span> <span class=mi>1</span><span class=p>,</span> <span class=n>height</span> <span class=o>-</span> <span class=mi>1</span><span class=p>],</span> <span class=p>[</span><span class=n>width</span> <span class=o>-</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>]])</span>
</span><span id=__span-0-399><a id=__codelineno-0-399 name=__codelineno-0-399></a><a href=#__codelineno-0-399><span class=linenos data-linenos="399 "></span></a>        <span class=n>corners</span> <span class=o>=</span> <span class=n>matrix</span><span class=p>(</span><span class=n>corners</span><span class=p>)</span>
</span><span id=__span-0-400><a id=__codelineno-0-400 name=__codelineno-0-400></a><a href=#__codelineno-0-400><span class=linenos data-linenos="400 "></span></a>
</span><span id=__span-0-401><a id=__codelineno-0-401 name=__codelineno-0-401></a><a href=#__codelineno-0-401><span class=linenos data-linenos="401 "></span></a>        <span class=n>minc</span> <span class=o>=</span> <span class=n>corners</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>min</span><span class=p>()</span>
</span><span id=__span-0-402><a id=__codelineno-0-402 name=__codelineno-0-402></a><a href=#__codelineno-0-402><span class=linenos data-linenos="402 "></span></a>        <span class=n>minr</span> <span class=o>=</span> <span class=n>corners</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>min</span><span class=p>()</span>
</span><span id=__span-0-403><a id=__codelineno-0-403 name=__codelineno-0-403></a><a href=#__codelineno-0-403><span class=linenos data-linenos="403 "></span></a>        <span class=n>maxc</span> <span class=o>=</span> <span class=n>corners</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>max</span><span class=p>()</span>
</span><span id=__span-0-404><a id=__codelineno-0-404 name=__codelineno-0-404></a><a href=#__codelineno-0-404><span class=linenos data-linenos="404 "></span></a>        <span class=n>maxr</span> <span class=o>=</span> <span class=n>corners</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>max</span><span class=p>()</span>
</span><span id=__span-0-405><a id=__codelineno-0-405 name=__codelineno-0-405></a><a href=#__codelineno-0-405><span class=linenos data-linenos="405 "></span></a>
</span><span id=__span-0-406><a id=__codelineno-0-406 name=__codelineno-0-406></a><a href=#__codelineno-0-406><span class=linenos data-linenos="406 "></span></a>        <span class=n>out_height</span> <span class=o>=</span> <span class=n>maxr</span> <span class=o>-</span> <span class=n>minr</span> <span class=o>+</span> <span class=mi>1</span>
</span><span id=__span-0-407><a id=__codelineno-0-407 name=__codelineno-0-407></a><a href=#__codelineno-0-407><span class=linenos data-linenos="407 "></span></a>        <span class=n>out_width</span> <span class=o>=</span> <span class=n>maxc</span> <span class=o>-</span> <span class=n>minc</span> <span class=o>+</span> <span class=mi>1</span>
</span><span id=__span-0-408><a id=__codelineno-0-408 name=__codelineno-0-408></a><a href=#__codelineno-0-408><span class=linenos data-linenos="408 "></span></a>
</span><span id=__span-0-409><a id=__codelineno-0-409 name=__codelineno-0-409></a><a href=#__codelineno-0-409><span class=linenos data-linenos="409 "></span></a>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>input_shape</span><span class=p>)</span> <span class=o>==</span> <span class=n>NUM_MULTI_CHANNEL_DIMENSIONS</span><span class=p>:</span>
</span><span id=__span-0-410><a id=__codelineno-0-410 name=__codelineno-0-410></a><a href=#__codelineno-0-410><span class=linenos data-linenos="410 "></span></a>            <span class=n>output_shape</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>ceil</span><span class=p>((</span><span class=n>out_height</span><span class=p>,</span> <span class=n>out_width</span><span class=p>,</span> <span class=n>input_shape</span><span class=p>[</span><span class=mi>2</span><span class=p>]))</span>
</span><span id=__span-0-411><a id=__codelineno-0-411 name=__codelineno-0-411></a><a href=#__codelineno-0-411><span class=linenos data-linenos="411 "></span></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-412><a id=__codelineno-0-412 name=__codelineno-0-412></a><a href=#__codelineno-0-412><span class=linenos data-linenos="412 "></span></a>            <span class=n>output_shape</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>ceil</span><span class=p>((</span><span class=n>out_height</span><span class=p>,</span> <span class=n>out_width</span><span class=p>))</span>
</span><span id=__span-0-413><a id=__codelineno-0-413 name=__codelineno-0-413></a><a href=#__codelineno-0-413><span class=linenos data-linenos="413 "></span></a>
</span><span id=__span-0-414><a id=__codelineno-0-414 name=__codelineno-0-414></a><a href=#__codelineno-0-414><span class=linenos data-linenos="414 "></span></a>        <span class=n>output_shape_tuple</span> <span class=o>=</span> <span class=nb>tuple</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>v</span><span class=p>)</span> <span class=k>for</span> <span class=n>v</span> <span class=ow>in</span> <span class=n>output_shape</span><span class=o>.</span><span class=n>tolist</span><span class=p>())</span>
</span><span id=__span-0-415><a id=__codelineno-0-415 name=__codelineno-0-415></a><a href=#__codelineno-0-415><span class=linenos data-linenos="415 "></span></a>        <span class=c1># fit output image in new shape</span>
</span><span id=__span-0-416><a id=__codelineno-0-416 name=__codelineno-0-416></a><a href=#__codelineno-0-416><span class=linenos data-linenos="416 "></span></a>        <span class=n>translation</span> <span class=o>=</span> <span class=o>-</span><span class=n>minc</span><span class=p>,</span> <span class=o>-</span><span class=n>minr</span>
</span><span id=__span-0-417><a id=__codelineno-0-417 name=__codelineno-0-417></a><a href=#__codelineno-0-417><span class=linenos data-linenos="417 "></span></a>        <span class=n>matrix_to_fit</span> <span class=o>=</span> <span class=n>skimage</span><span class=o>.</span><span class=n>transform</span><span class=o>.</span><span class=n>SimilarityTransform</span><span class=p>(</span><span class=n>translation</span><span class=o>=</span><span class=n>translation</span><span class=p>)</span>
</span><span id=__span-0-418><a id=__codelineno-0-418 name=__codelineno-0-418></a><a href=#__codelineno-0-418><span class=linenos data-linenos="418 "></span></a>        <span class=n>matrix</span> <span class=o>+=</span> <span class=n>matrix_to_fit</span>
</span><span id=__span-0-419><a id=__codelineno-0-419 name=__codelineno-0-419></a><a href=#__codelineno-0-419><span class=linenos data-linenos="419 "></span></a>        <span class=k>return</span> <span class=n>matrix</span><span class=p>,</span> <span class=n>output_shape_tuple</span>
</span></code></pre></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-attribute"> <h3 class="doc doc-heading" id=albumentations.augmentations.geometric.transforms.Affine.targets_as_params> <code class="highlight language-python"><span class=n>targets_as_params</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span></code> <span class="doc doc-properties"> <small class="doc doc-property doc-property-property"><code>property</code></small> <small class="doc doc-property doc-property-readonly"><code>readonly</code></small> </span> <a class=headerlink href=#albumentations.augmentations.geometric.transforms.Affine.targets_as_params title="Permanent link">¶</a></h3> <div class="doc doc-contents"> <p>Targets used to get params</p> </div> </div> <div class="doc doc-object doc-method"> <h3 class="doc doc-heading" id=albumentations.augmentations.geometric.transforms.Affine.apply> <code class="highlight language-python"><span class=n>apply</span> <span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>img</span><span class=p>,</span> <span class=n>matrix</span><span class=p>,</span> <span class=n>output_shape</span><span class=p>,</span> <span class=o>**</span><span class=n>params</span><span class=p>)</span></code> <a class=headerlink href=#albumentations.augmentations.geometric.transforms.Affine.apply title="Permanent link">¶</a></h3> <div class="doc doc-contents"> <p>Apply transform on image.</p> <details class=quote> <summary>Source code in <code>albumentations/augmentations/geometric/transforms.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=k>def</span> <span class=nf>apply</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>img</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>matrix</span><span class=p>:</span> <span class=n>skimage</span><span class=o>.</span><span class=n>transform</span><span class=o>.</span><span class=n>ProjectiveTransform</span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>output_shape</span><span class=p>:</span> <span class=n>SizeType</span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=k>return</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>warp_affine</span><span class=p>(</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>        <span class=n>img</span><span class=p>,</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>        <span class=n>matrix</span><span class=p>,</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a>        <span class=n>interpolation</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>interpolation</span><span class=p>,</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a>        <span class=n>cval</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>cval</span><span class=p>,</span>
</span><span id=__span-0-13><a href=#__codelineno-0-13 id=__codelineno-0-13 name=__codelineno-0-13></a>        <span class=n>mode</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>mode</span><span class=p>,</span>
</span><span id=__span-0-14><a href=#__codelineno-0-14 id=__codelineno-0-14 name=__codelineno-0-14></a>        <span class=n>output_shape</span><span class=o>=</span><span class=n>output_shape</span><span class=p>,</span>
</span><span id=__span-0-15><a href=#__codelineno-0-15 id=__codelineno-0-15 name=__codelineno-0-15></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-method"> <h3 class="doc doc-heading" id=albumentations.augmentations.geometric.transforms.Affine.get_params_dependent_on_targets> <code class="highlight language-python"><span class=n>get_params_dependent_on_targets</span> <span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>params</span><span class=p>)</span></code> <a class=headerlink href=#albumentations.augmentations.geometric.transforms.Affine.get_params_dependent_on_targets title="Permanent link">¶</a></h3> <div class="doc doc-contents"> <p>Returns parameters dependent on targets. Dependent target is defined in <code>self.targets_as_params</code></p> <details class=quote> <summary>Source code in <code>albumentations/augmentations/geometric/transforms.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=k>def</span> <span class=nf>get_params_dependent_on_targets</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>params</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>height</span><span class=p>,</span> <span class=n>width</span> <span class=o>=</span> <span class=n>params</span><span class=p>[</span><span class=s2>"image"</span><span class=p>]</span><span class=o>.</span><span class=n>shape</span><span class=p>[:</span><span class=mi>2</span><span class=p>]</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>translate</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Union</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=nb>float</span><span class=p>]]</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>translate_px</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>        <span class=n>translate</span> <span class=o>=</span> <span class=p>{</span><span class=n>key</span><span class=p>:</span> <span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=o>*</span><span class=n>value</span><span class=p>)</span> <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>value</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>translate_px</span><span class=o>.</span><span class=n>items</span><span class=p>()}</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>translate_percent</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>        <span class=n>translate</span> <span class=o>=</span> <span class=p>{</span><span class=n>key</span><span class=p>:</span> <span class=n>random</span><span class=o>.</span><span class=n>uniform</span><span class=p>(</span><span class=o>*</span><span class=n>value</span><span class=p>)</span> <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>value</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>translate_percent</span><span class=o>.</span><span class=n>items</span><span class=p>()}</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>        <span class=n>translate</span><span class=p>[</span><span class=s2>"x"</span><span class=p>]</span> <span class=o>=</span> <span class=n>translate</span><span class=p>[</span><span class=s2>"x"</span><span class=p>]</span> <span class=o>*</span> <span class=n>width</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>        <span class=n>translate</span><span class=p>[</span><span class=s2>"y"</span><span class=p>]</span> <span class=o>=</span> <span class=n>translate</span><span class=p>[</span><span class=s2>"y"</span><span class=p>]</span> <span class=o>*</span> <span class=n>height</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a>        <span class=n>translate</span> <span class=o>=</span> <span class=p>{</span><span class=s2>"x"</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=s2>"y"</span><span class=p>:</span> <span class=mi>0</span><span class=p>}</span>
</span><span id=__span-0-13><a href=#__codelineno-0-13 id=__codelineno-0-13 name=__codelineno-0-13></a>
</span><span id=__span-0-14><a href=#__codelineno-0-14 id=__codelineno-0-14 name=__codelineno-0-14></a>    <span class=c1># Look to issue https://github.com/albumentations-team/albumentations/issues/1079</span>
</span><span id=__span-0-15><a href=#__codelineno-0-15 id=__codelineno-0-15 name=__codelineno-0-15></a>    <span class=n>shear</span> <span class=o>=</span> <span class=p>{</span><span class=n>key</span><span class=p>:</span> <span class=o>-</span><span class=n>random</span><span class=o>.</span><span class=n>uniform</span><span class=p>(</span><span class=o>*</span><span class=n>value</span><span class=p>)</span> <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>value</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>shear</span><span class=o>.</span><span class=n>items</span><span class=p>()}</span>
</span><span id=__span-0-16><a href=#__codelineno-0-16 id=__codelineno-0-16 name=__codelineno-0-16></a>
</span><span id=__span-0-17><a href=#__codelineno-0-17 id=__codelineno-0-17 name=__codelineno-0-17></a>    <span class=n>scale</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_scale</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>scale</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>keep_ratio</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>balanced_scale</span><span class=p>)</span>
</span><span id=__span-0-18><a href=#__codelineno-0-18 id=__codelineno-0-18 name=__codelineno-0-18></a>
</span><span id=__span-0-19><a href=#__codelineno-0-19 id=__codelineno-0-19 name=__codelineno-0-19></a>    <span class=c1># Look to issue https://github.com/albumentations-team/albumentations/issues/1079</span>
</span><span id=__span-0-20><a href=#__codelineno-0-20 id=__codelineno-0-20 name=__codelineno-0-20></a>    <span class=n>rotate</span> <span class=o>=</span> <span class=o>-</span><span class=n>random</span><span class=o>.</span><span class=n>uniform</span><span class=p>(</span><span class=o>*</span><span class=bp>self</span><span class=o>.</span><span class=n>rotate</span><span class=p>)</span>
</span><span id=__span-0-21><a href=#__codelineno-0-21 id=__codelineno-0-21 name=__codelineno-0-21></a>
</span><span id=__span-0-22><a href=#__codelineno-0-22 id=__codelineno-0-22 name=__codelineno-0-22></a>    <span class=n>shift_x</span><span class=p>,</span> <span class=n>shift_y</span> <span class=o>=</span> <span class=n>center</span><span class=p>(</span><span class=n>width</span><span class=p>,</span> <span class=n>height</span><span class=p>)</span>
</span><span id=__span-0-23><a href=#__codelineno-0-23 id=__codelineno-0-23 name=__codelineno-0-23></a>
</span><span id=__span-0-24><a href=#__codelineno-0-24 id=__codelineno-0-24 name=__codelineno-0-24></a>    <span class=n>matrix_to_topleft</span> <span class=o>=</span> <span class=n>skimage</span><span class=o>.</span><span class=n>transform</span><span class=o>.</span><span class=n>SimilarityTransform</span><span class=p>(</span><span class=n>translation</span><span class=o>=</span><span class=p>[</span><span class=o>-</span><span class=n>shift_x</span><span class=p>,</span> <span class=o>-</span><span class=n>shift_y</span><span class=p>])</span>
</span><span id=__span-0-25><a href=#__codelineno-0-25 id=__codelineno-0-25 name=__codelineno-0-25></a>    <span class=n>matrix_shear_y_rot</span> <span class=o>=</span> <span class=n>skimage</span><span class=o>.</span><span class=n>transform</span><span class=o>.</span><span class=n>AffineTransform</span><span class=p>(</span><span class=n>rotation</span><span class=o>=-</span><span class=n>np</span><span class=o>.</span><span class=n>pi</span> <span class=o>/</span> <span class=mi>2</span><span class=p>)</span>
</span><span id=__span-0-26><a href=#__codelineno-0-26 id=__codelineno-0-26 name=__codelineno-0-26></a>    <span class=n>matrix_shear_y</span> <span class=o>=</span> <span class=n>skimage</span><span class=o>.</span><span class=n>transform</span><span class=o>.</span><span class=n>AffineTransform</span><span class=p>(</span><span class=n>shear</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>deg2rad</span><span class=p>(</span><span class=n>shear</span><span class=p>[</span><span class=s2>"y"</span><span class=p>]))</span>
</span><span id=__span-0-27><a href=#__codelineno-0-27 id=__codelineno-0-27 name=__codelineno-0-27></a>    <span class=n>matrix_shear_y_rot_inv</span> <span class=o>=</span> <span class=n>skimage</span><span class=o>.</span><span class=n>transform</span><span class=o>.</span><span class=n>AffineTransform</span><span class=p>(</span><span class=n>rotation</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>pi</span> <span class=o>/</span> <span class=mi>2</span><span class=p>)</span>
</span><span id=__span-0-28><a href=#__codelineno-0-28 id=__codelineno-0-28 name=__codelineno-0-28></a>    <span class=n>matrix_transforms</span> <span class=o>=</span> <span class=n>skimage</span><span class=o>.</span><span class=n>transform</span><span class=o>.</span><span class=n>AffineTransform</span><span class=p>(</span>
</span><span id=__span-0-29><a href=#__codelineno-0-29 id=__codelineno-0-29 name=__codelineno-0-29></a>        <span class=n>scale</span><span class=o>=</span><span class=p>(</span><span class=n>scale</span><span class=p>[</span><span class=s2>"x"</span><span class=p>],</span> <span class=n>scale</span><span class=p>[</span><span class=s2>"y"</span><span class=p>]),</span>
</span><span id=__span-0-30><a href=#__codelineno-0-30 id=__codelineno-0-30 name=__codelineno-0-30></a>        <span class=n>translation</span><span class=o>=</span><span class=p>(</span><span class=n>translate</span><span class=p>[</span><span class=s2>"x"</span><span class=p>],</span> <span class=n>translate</span><span class=p>[</span><span class=s2>"y"</span><span class=p>]),</span>
</span><span id=__span-0-31><a href=#__codelineno-0-31 id=__codelineno-0-31 name=__codelineno-0-31></a>        <span class=n>rotation</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>deg2rad</span><span class=p>(</span><span class=n>rotate</span><span class=p>),</span>
</span><span id=__span-0-32><a href=#__codelineno-0-32 id=__codelineno-0-32 name=__codelineno-0-32></a>        <span class=n>shear</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>deg2rad</span><span class=p>(</span><span class=n>shear</span><span class=p>[</span><span class=s2>"x"</span><span class=p>]),</span>
</span><span id=__span-0-33><a href=#__codelineno-0-33 id=__codelineno-0-33 name=__codelineno-0-33></a>    <span class=p>)</span>
</span><span id=__span-0-34><a href=#__codelineno-0-34 id=__codelineno-0-34 name=__codelineno-0-34></a>    <span class=n>matrix_to_center</span> <span class=o>=</span> <span class=n>skimage</span><span class=o>.</span><span class=n>transform</span><span class=o>.</span><span class=n>SimilarityTransform</span><span class=p>(</span><span class=n>translation</span><span class=o>=</span><span class=p>[</span><span class=n>shift_x</span><span class=p>,</span> <span class=n>shift_y</span><span class=p>])</span>
</span><span id=__span-0-35><a href=#__codelineno-0-35 id=__codelineno-0-35 name=__codelineno-0-35></a>    <span class=n>matrix</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-36><a href=#__codelineno-0-36 id=__codelineno-0-36 name=__codelineno-0-36></a>        <span class=n>matrix_to_topleft</span>
</span><span id=__span-0-37><a href=#__codelineno-0-37 id=__codelineno-0-37 name=__codelineno-0-37></a>        <span class=o>+</span> <span class=n>matrix_shear_y_rot</span>
</span><span id=__span-0-38><a href=#__codelineno-0-38 id=__codelineno-0-38 name=__codelineno-0-38></a>        <span class=o>+</span> <span class=n>matrix_shear_y</span>
</span><span id=__span-0-39><a href=#__codelineno-0-39 id=__codelineno-0-39 name=__codelineno-0-39></a>        <span class=o>+</span> <span class=n>matrix_shear_y_rot_inv</span>
</span><span id=__span-0-40><a href=#__codelineno-0-40 id=__codelineno-0-40 name=__codelineno-0-40></a>        <span class=o>+</span> <span class=n>matrix_transforms</span>
</span><span id=__span-0-41><a href=#__codelineno-0-41 id=__codelineno-0-41 name=__codelineno-0-41></a>        <span class=o>+</span> <span class=n>matrix_to_center</span>
</span><span id=__span-0-42><a href=#__codelineno-0-42 id=__codelineno-0-42 name=__codelineno-0-42></a>    <span class=p>)</span>
</span><span id=__span-0-43><a href=#__codelineno-0-43 id=__codelineno-0-43 name=__codelineno-0-43></a>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>fit_output</span><span class=p>:</span>
</span><span id=__span-0-44><a href=#__codelineno-0-44 id=__codelineno-0-44 name=__codelineno-0-44></a>        <span class=n>matrix</span><span class=p>,</span> <span class=n>output_shape</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_compute_affine_warp_output_shape</span><span class=p>(</span><span class=n>matrix</span><span class=p>,</span> <span class=n>params</span><span class=p>[</span><span class=s2>"image"</span><span class=p>]</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span>
</span><span id=__span-0-45><a href=#__codelineno-0-45 id=__codelineno-0-45 name=__codelineno-0-45></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-46><a href=#__codelineno-0-46 id=__codelineno-0-46 name=__codelineno-0-46></a>        <span class=n>output_shape</span> <span class=o>=</span> <span class=n>params</span><span class=p>[</span><span class=s2>"image"</span><span class=p>]</span><span class=o>.</span><span class=n>shape</span>
</span><span id=__span-0-47><a href=#__codelineno-0-47 id=__codelineno-0-47 name=__codelineno-0-47></a>
</span><span id=__span-0-48><a href=#__codelineno-0-48 id=__codelineno-0-48 name=__codelineno-0-48></a>    <span class=k>return</span> <span class=p>{</span>
</span><span id=__span-0-49><a href=#__codelineno-0-49 id=__codelineno-0-49 name=__codelineno-0-49></a>        <span class=s2>"rotate"</span><span class=p>:</span> <span class=n>rotate</span><span class=p>,</span>
</span><span id=__span-0-50><a href=#__codelineno-0-50 id=__codelineno-0-50 name=__codelineno-0-50></a>        <span class=s2>"scale"</span><span class=p>:</span> <span class=n>scale</span><span class=p>,</span>
</span><span id=__span-0-51><a href=#__codelineno-0-51 id=__codelineno-0-51 name=__codelineno-0-51></a>        <span class=s2>"matrix"</span><span class=p>:</span> <span class=n>matrix</span><span class=p>,</span>
</span><span id=__span-0-52><a href=#__codelineno-0-52 id=__codelineno-0-52 name=__codelineno-0-52></a>        <span class=s2>"output_shape"</span><span class=p>:</span> <span class=n>output_shape</span><span class=p>,</span>
</span><span id=__span-0-53><a href=#__codelineno-0-53 id=__codelineno-0-53 name=__codelineno-0-53></a>    <span class=p>}</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-method"> <h3 class="doc doc-heading" id=albumentations.augmentations.geometric.transforms.Affine.get_transform_init_args_names> <code class="highlight language-python"><span class=n>get_transform_init_args_names</span> <span class=p>(</span><span class=bp>self</span><span class=p>)</span></code> <a class=headerlink href=#albumentations.augmentations.geometric.transforms.Affine.get_transform_init_args_names title="Permanent link">¶</a></h3> <div class="doc doc-contents"> <p>Returns names of arguments that are used in <strong>init</strong> method of the transform</p> <details class=quote> <summary>Source code in <code>albumentations/augmentations/geometric/transforms.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=k>def</span> <span class=nf>get_transform_init_args_names</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=o>...</span><span class=p>]:</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=k>return</span> <span class=p>(</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>        <span class=s2>"interpolation"</span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>        <span class=s2>"mask_interpolation"</span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>        <span class=s2>"cval"</span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>        <span class=s2>"mode"</span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>        <span class=s2>"scale"</span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>        <span class=s2>"translate_percent"</span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>        <span class=s2>"translate_px"</span><span class=p>,</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>        <span class=s2>"rotate"</span><span class=p>,</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a>        <span class=s2>"fit_output"</span><span class=p>,</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a>        <span class=s2>"shear"</span><span class=p>,</span>
</span><span id=__span-0-13><a href=#__codelineno-0-13 id=__codelineno-0-13 name=__codelineno-0-13></a>        <span class=s2>"cval_mask"</span><span class=p>,</span>
</span><span id=__span-0-14><a href=#__codelineno-0-14 id=__codelineno-0-14 name=__codelineno-0-14></a>        <span class=s2>"keep_ratio"</span><span class=p>,</span>
</span><span id=__span-0-15><a href=#__codelineno-0-15 id=__codelineno-0-15 name=__codelineno-0-15></a>        <span class=s2>"rotate_method"</span><span class=p>,</span>
</span><span id=__span-0-16><a href=#__codelineno-0-16 id=__codelineno-0-16 name=__codelineno-0-16></a>        <span class=s2>"balanced_scale"</span><span class=p>,</span>
</span><span id=__span-0-17><a href=#__codelineno-0-17 id=__codelineno-0-17 name=__codelineno-0-17></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h2 class="doc doc-heading" data-toc-label=D4 id=albumentations.augmentations.geometric.transforms.D4> <code>class <strong> D4</strong></code> <code> (always_apply=None, p=1) </code> <span class=doc-github-link> <a href=https://github.com/albumentations-team/albumentations/blob/main/albumentations/augmentations/geometric/transforms.py#L2012 target=_blank>[view source on GitHub]</a> </span><a class=headerlink href=#albumentations.augmentations.geometric.transforms.D4 title="Permanent link">¶</a> </h2> <div class=class-signature> </div> <div class="doc doc-contents"> <p>Applies one of the eight possible D4 dihedral group transformations to a square-shaped input, maintaining the square shape. These transformations correspond to the symmetries of a square, including rotations and reflections.</p> <p>The D4 group transformations include: - 'e' (identity): No transformation is applied. - 'r90' (rotation by 90 degrees counterclockwise) - 'r180' (rotation by 180 degrees) - 'r270' (rotation by 270 degrees counterclockwise) - 'v' (reflection across the vertical midline) - 'hvt' (reflection across the anti-diagonal) - 'h' (reflection across the horizontal midline) - 't' (reflection across the main diagonal)</p> <p>Even if the probability (<code>p</code>) of applying the transform is set to 1, the identity transformation 'e' may still occur, which means the input will remain unchanged in one out of eight cases.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>p</code></td> <td><code>float</code></td> <td><p>Probability of applying the transform. Default is 1, meaning the transform is applied every time it is called.</p></td> </tr> </tbody> </table> <div class="admonition targets"> <p class=admonition-title>Targets</p> <p>image, mask, bboxes, keypoints</p> </div> <p>Image types: uint8, float32</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>This transform is particularly useful when augmenting data that does not have a clear orientation: - Top view satellite or drone imagery - Medical images</p> </div> <div class="admonition info"> <p class=admonition-title><strong>Interactive Tool Available!</strong></p> <p> <strong>Explore this transform visually and adjust parameters interactively using this tool:</strong> </p> <p> <a class="md-button md-button--primary" href="https://huggingface.co/spaces/qubvel-hf/albumentations-demo?transform=D4" target=_blank>Open Tool</a> </p> </div> <details class=quote> <summary>Source code in <code>albumentations/augmentations/geometric/transforms.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1></a><a href=#__codelineno-0-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>class</span> <span class=nc>D4</span><span class=p>(</span><span class=n>DualTransform</span><span class=p>):</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2></a><a href=#__codelineno-0-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>    </span><span class=sd>"""Applies one of the eight possible D4 dihedral group transformations to a square-shaped input,</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3></a><a href=#__codelineno-0-3><span class=linenos data-linenos=" 3 "></span></a><span class=sd>        maintaining the square shape. These transformations correspond to the symmetries of a square,</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4></a><a href=#__codelineno-0-4><span class=linenos data-linenos=" 4 "></span></a><span class=sd>        including rotations and reflections.</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5></a><a href=#__codelineno-0-5><span class=linenos data-linenos=" 5 "></span></a>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6></a><a href=#__codelineno-0-6><span class=linenos data-linenos=" 6 "></span></a><span class=sd>    The D4 group transformations include:</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7></a><a href=#__codelineno-0-7><span class=linenos data-linenos=" 7 "></span></a><span class=sd>    - 'e' (identity): No transformation is applied.</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8></a><a href=#__codelineno-0-8><span class=linenos data-linenos=" 8 "></span></a><span class=sd>    - 'r90' (rotation by 90 degrees counterclockwise)</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9></a><a href=#__codelineno-0-9><span class=linenos data-linenos=" 9 "></span></a><span class=sd>    - 'r180' (rotation by 180 degrees)</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10></a><a href=#__codelineno-0-10><span class=linenos data-linenos="10 "></span></a><span class=sd>    - 'r270' (rotation by 270 degrees counterclockwise)</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11></a><a href=#__codelineno-0-11><span class=linenos data-linenos="11 "></span></a><span class=sd>    - 'v' (reflection across the vertical midline)</span>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12></a><a href=#__codelineno-0-12><span class=linenos data-linenos="12 "></span></a><span class=sd>    - 'hvt' (reflection across the anti-diagonal)</span>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13></a><a href=#__codelineno-0-13><span class=linenos data-linenos="13 "></span></a><span class=sd>    - 'h' (reflection across the horizontal midline)</span>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14></a><a href=#__codelineno-0-14><span class=linenos data-linenos="14 "></span></a><span class=sd>    - 't' (reflection across the main diagonal)</span>
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15></a><a href=#__codelineno-0-15><span class=linenos data-linenos="15 "></span></a>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16></a><a href=#__codelineno-0-16><span class=linenos data-linenos="16 "></span></a><span class=sd>    Even if the probability (`p`) of applying the transform is set to 1, the identity transformation</span>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17></a><a href=#__codelineno-0-17><span class=linenos data-linenos="17 "></span></a><span class=sd>    'e' may still occur, which means the input will remain unchanged in one out of eight cases.</span>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18></a><a href=#__codelineno-0-18><span class=linenos data-linenos="18 "></span></a>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19></a><a href=#__codelineno-0-19><span class=linenos data-linenos="19 "></span></a><span class=sd>    Args:</span>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20></a><a href=#__codelineno-0-20><span class=linenos data-linenos="20 "></span></a><span class=sd>        p (float): Probability of applying the transform. Default is 1, meaning the</span>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21></a><a href=#__codelineno-0-21><span class=linenos data-linenos="21 "></span></a><span class=sd>                   transform is applied every time it is called.</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22></a><a href=#__codelineno-0-22><span class=linenos data-linenos="22 "></span></a>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23></a><a href=#__codelineno-0-23><span class=linenos data-linenos="23 "></span></a><span class=sd>    Targets:</span>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a><a href=#__codelineno-0-24><span class=linenos data-linenos="24 "></span></a><span class=sd>        image, mask, bboxes, keypoints</span>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a><a href=#__codelineno-0-25><span class=linenos data-linenos="25 "></span></a>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a><a href=#__codelineno-0-26><span class=linenos data-linenos="26 "></span></a><span class=sd>    Image types:</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a><a href=#__codelineno-0-27><span class=linenos data-linenos="27 "></span></a><span class=sd>        uint8, float32</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a><a href=#__codelineno-0-28><span class=linenos data-linenos="28 "></span></a>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a><a href=#__codelineno-0-29><span class=linenos data-linenos="29 "></span></a><span class=sd>    Note:</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a><a href=#__codelineno-0-30><span class=linenos data-linenos="30 "></span></a><span class=sd>        This transform is particularly useful when augmenting data that does not have a clear orientation:</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a><a href=#__codelineno-0-31><span class=linenos data-linenos="31 "></span></a><span class=sd>        - Top view satellite or drone imagery</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a><a href=#__codelineno-0-32><span class=linenos data-linenos="32 "></span></a><span class=sd>        - Medical images</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a><a href=#__codelineno-0-33><span class=linenos data-linenos="33 "></span></a>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a><a href=#__codelineno-0-34><span class=linenos data-linenos="34 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a><a href=#__codelineno-0-35><span class=linenos data-linenos="35 "></span></a>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a><a href=#__codelineno-0-36><span class=linenos data-linenos="36 "></span></a>    <span class=n>_targets</span> <span class=o>=</span> <span class=p>(</span><span class=n>Targets</span><span class=o>.</span><span class=n>IMAGE</span><span class=p>,</span> <span class=n>Targets</span><span class=o>.</span><span class=n>MASK</span><span class=p>,</span> <span class=n>Targets</span><span class=o>.</span><span class=n>BBOXES</span><span class=p>,</span> <span class=n>Targets</span><span class=o>.</span><span class=n>KEYPOINTS</span><span class=p>)</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a><a href=#__codelineno-0-37><span class=linenos data-linenos="37 "></span></a>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a><a href=#__codelineno-0-38><span class=linenos data-linenos="38 "></span></a>    <span class=k>class</span> <span class=nc>InitSchema</span><span class=p>(</span><span class=n>BaseTransformInitSchema</span><span class=p>):</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a><a href=#__codelineno-0-39><span class=linenos data-linenos="39 "></span></a>        <span class=n>p</span><span class=p>:</span> <span class=n>ProbabilityType</span> <span class=o>=</span> <span class=mi>1</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a><a href=#__codelineno-0-40><span class=linenos data-linenos="40 "></span></a>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a><a href=#__codelineno-0-41><span class=linenos data-linenos="41 "></span></a>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><a href=#__codelineno-0-42><span class=linenos data-linenos="42 "></span></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos="43 "></span></a>        <span class=n>always_apply</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>bool</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos="44 "></span></a>        <span class=n>p</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos="45 "></span></a>    <span class=p>):</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos="46 "></span></a>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=n>always_apply</span><span class=p>,</span> <span class=n>p</span><span class=p>)</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos="47 "></span></a>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos="48 "></span></a>    <span class=k>def</span> <span class=nf>apply</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>img</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>group_element</span><span class=p>:</span> <span class=n>D4Type</span><span class=p>,</span> <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos="49 "></span></a>        <span class=k>return</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>d4</span><span class=p>(</span><span class=n>img</span><span class=p>,</span> <span class=n>group_element</span><span class=p>)</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos="50 "></span></a>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos="51 "></span></a>    <span class=k>def</span> <span class=nf>apply_to_bbox</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>bbox</span><span class=p>:</span> <span class=n>BoxInternalType</span><span class=p>,</span> <span class=n>group_element</span><span class=p>:</span> <span class=n>D4Type</span><span class=p>,</span> <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>BoxInternalType</span><span class=p>:</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos="52 "></span></a>        <span class=k>return</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>bbox_d4</span><span class=p>(</span><span class=n>bbox</span><span class=p>,</span> <span class=n>group_element</span><span class=p>,</span> <span class=o>**</span><span class=n>params</span><span class=p>)</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos="53 "></span></a>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos="54 "></span></a>    <span class=k>def</span> <span class=nf>apply_to_keypoint</span><span class=p>(</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos="55 "></span></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos="56 "></span></a>        <span class=n>keypoint</span><span class=p>:</span> <span class=n>KeypointInternalType</span><span class=p>,</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos="57 "></span></a>        <span class=n>group_element</span><span class=p>:</span> <span class=n>D4Type</span><span class=p>,</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos="58 "></span></a>        <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>,</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos="59 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>KeypointInternalType</span><span class=p>:</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos="60 "></span></a>        <span class=k>return</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>keypoint_d4</span><span class=p>(</span><span class=n>keypoint</span><span class=p>,</span> <span class=n>group_element</span><span class=p>,</span> <span class=o>**</span><span class=n>params</span><span class=p>)</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos="61 "></span></a>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos="62 "></span></a>    <span class=k>def</span> <span class=nf>get_params</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>D4Type</span><span class=p>]:</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos="63 "></span></a>        <span class=k>return</span> <span class=p>{</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos="64 "></span></a>            <span class=s2>"group_element"</span><span class=p>:</span> <span class=n>random_utils</span><span class=o>.</span><span class=n>choice</span><span class=p>(</span><span class=n>d4_group_elements</span><span class=p>),</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos="65 "></span></a>        <span class=p>}</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos="66 "></span></a>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos="67 "></span></a>    <span class=k>def</span> <span class=nf>get_transform_init_args_names</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[()]:</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos="68 "></span></a>        <span class=k>return</span> <span class=p>()</span>
</span></code></pre></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-method"> <h3 class="doc doc-heading" id=albumentations.augmentations.geometric.transforms.D4.apply> <code class="highlight language-python"><span class=n>apply</span> <span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>img</span><span class=p>,</span> <span class=n>group_element</span><span class=p>,</span> <span class=o>**</span><span class=n>params</span><span class=p>)</span></code> <a class=headerlink href=#albumentations.augmentations.geometric.transforms.D4.apply title="Permanent link">¶</a></h3> <div class="doc doc-contents"> <p>Apply transform on image.</p> <details class=quote> <summary>Source code in <code>albumentations/augmentations/geometric/transforms.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=k>def</span> <span class=nf>apply</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>img</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>group_element</span><span class=p>:</span> <span class=n>D4Type</span><span class=p>,</span> <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=k>return</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>d4</span><span class=p>(</span><span class=n>img</span><span class=p>,</span> <span class=n>group_element</span><span class=p>)</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-method"> <h3 class="doc doc-heading" id=albumentations.augmentations.geometric.transforms.D4.get_params> <code class="highlight language-python"><span class=n>get_params</span> <span class=p>(</span><span class=bp>self</span><span class=p>)</span></code> <a class=headerlink href=#albumentations.augmentations.geometric.transforms.D4.get_params title="Permanent link">¶</a></h3> <div class="doc doc-contents"> <p>Returns parameters independent of input</p> <details class=quote> <summary>Source code in <code>albumentations/augmentations/geometric/transforms.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=k>def</span> <span class=nf>get_params</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>D4Type</span><span class=p>]:</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=k>return</span> <span class=p>{</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>        <span class=s2>"group_element"</span><span class=p>:</span> <span class=n>random_utils</span><span class=o>.</span><span class=n>choice</span><span class=p>(</span><span class=n>d4_group_elements</span><span class=p>),</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=p>}</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-method"> <h3 class="doc doc-heading" id=albumentations.augmentations.geometric.transforms.D4.get_transform_init_args_names> <code class="highlight language-python"><span class=n>get_transform_init_args_names</span> <span class=p>(</span><span class=bp>self</span><span class=p>)</span></code> <a class=headerlink href=#albumentations.augmentations.geometric.transforms.D4.get_transform_init_args_names title="Permanent link">¶</a></h3> <div class="doc doc-contents"> <p>Returns names of arguments that are used in <strong>init</strong> method of the transform</p> <details class=quote> <summary>Source code in <code>albumentations/augmentations/geometric/transforms.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=k>def</span> <span class=nf>get_transform_init_args_names</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[()]:</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=k>return</span> <span class=p>()</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h2 class="doc doc-heading" data-toc-label=ElasticTransform id=albumentations.augmentations.geometric.transforms.ElasticTransform> <code>class <strong> ElasticTransform</strong></code> <code> (alpha=1, sigma=50, alpha_affine=50, interpolation=1, border_mode=4, value=None, mask_value=None, always_apply=None, approximate=False, same_dxdy=False, p=0.5) </code> <span class=doc-github-link> <a href=https://github.com/albumentations-team/albumentations/blob/main/albumentations/augmentations/geometric/transforms.py#L101 target=_blank>[view source on GitHub]</a> </span><a class=headerlink href=#albumentations.augmentations.geometric.transforms.ElasticTransform title="Permanent link">¶</a> </h2> <div class=class-signature> </div> <div class="doc doc-contents"> <p>Elastic deformation of images as described in [Simard2003]_ (with modifications).</p> <p>.. [Simard2003] Simard, Steinkraus and Platt, "Best Practices for Convolutional Neural Networks applied to Visual Document Analysis", in Proc. of the International Conference on Document Analysis and Recognition, 2003.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>alpha</code></td> <td><code>float</code></td> <td></td> </tr> <tr> <td><code>sigma</code></td> <td><code>float</code></td> <td><p>Gaussian filter parameter.</p></td> </tr> <tr> <td><code>alpha_affine</code></td> <td><code>float</code></td> <td><p>The range will be (-alpha_affine, alpha_affine)</p></td> </tr> <tr> <td><code>interpolation</code></td> <td><code>OpenCV flag</code></td> <td><p>flag that is used to specify the interpolation algorithm. Should be one of: cv2.INTER_NEAREST, cv2.INTER_LINEAR, cv2.INTER_CUBIC, cv2.INTER_AREA, cv2.INTER_LANCZOS4. Default: cv2.INTER_LINEAR.</p></td> </tr> <tr> <td><code>border_mode</code></td> <td><code>OpenCV flag</code></td> <td><p>flag that is used to specify the pixel extrapolation method. Should be one of: cv2.BORDER_CONSTANT, cv2.BORDER_REPLICATE, cv2.BORDER_REFLECT, cv2.BORDER_WRAP, cv2.BORDER_REFLECT_101. Default: cv2.BORDER_REFLECT_101</p></td> </tr> <tr> <td><code>value</code></td> <td><code>int, float, list of ints, list of float</code></td> <td><p>padding value if border_mode is cv2.BORDER_CONSTANT.</p></td> </tr> <tr> <td><code>mask_value</code></td> <td><code>int, float, list of ints, list of float</code></td> <td><p>padding value if border_mode is cv2.BORDER_CONSTANT applied for masks.</p></td> </tr> <tr> <td><code>approximate</code></td> <td><code>boolean</code></td> <td><p>Whether to smooth displacement map with fixed kernel size. Enabling this option gives ~2X speedup on large images.</p></td> </tr> <tr> <td><code>same_dxdy</code></td> <td><code>boolean</code></td> <td><p>Whether to use same random generated shift for x and y. Enabling this option gives ~2X speedup.</p></td> </tr> </tbody> </table> <div class="admonition targets"> <p class=admonition-title>Targets</p> <p>image, mask, bboxes</p> </div> <p>Image types: uint8, float32</p> <div class="admonition reference"> <p class=admonition-title>Reference</p> <p><a href=https://gist.github.com/ernestum/601cdf56d2b424757de5 target=_blank>https://gist.github.com/ernestum/601cdf56d2b424757de5</a></p> </div> <div class="admonition info"> <p class=admonition-title><strong>Interactive Tool Available!</strong></p> <p> <strong>Explore this transform visually and adjust parameters interactively using this tool:</strong> </p> <p> <a class="md-button md-button--primary" href="https://huggingface.co/spaces/qubvel-hf/albumentations-demo?transform=ElasticTransform" target=_blank>Open Tool</a> </p> </div> <details class=quote> <summary>Source code in <code>albumentations/augmentations/geometric/transforms.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1></a><a href=#__codelineno-0-1><span class=linenos data-linenos="  1 "></span></a><span class=k>class</span> <span class=nc>ElasticTransform</span><span class=p>(</span><span class=n>DualTransform</span><span class=p>):</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2></a><a href=#__codelineno-0-2><span class=linenos data-linenos="  2 "></span></a><span class=w>    </span><span class=sd>"""Elastic deformation of images as described in [Simard2003]_ (with modifications).</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3></a><a href=#__codelineno-0-3><span class=linenos data-linenos="  3 "></span></a>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4></a><a href=#__codelineno-0-4><span class=linenos data-linenos="  4 "></span></a><span class=sd>    .. [Simard2003] Simard, Steinkraus and Platt, "Best Practices for</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5></a><a href=#__codelineno-0-5><span class=linenos data-linenos="  5 "></span></a><span class=sd>         Convolutional Neural Networks applied to Visual Document Analysis", in</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6></a><a href=#__codelineno-0-6><span class=linenos data-linenos="  6 "></span></a><span class=sd>         Proc. of the International Conference on Document Analysis and</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7></a><a href=#__codelineno-0-7><span class=linenos data-linenos="  7 "></span></a><span class=sd>         Recognition, 2003.</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8></a><a href=#__codelineno-0-8><span class=linenos data-linenos="  8 "></span></a>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9></a><a href=#__codelineno-0-9><span class=linenos data-linenos="  9 "></span></a><span class=sd>    Args:</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10></a><a href=#__codelineno-0-10><span class=linenos data-linenos=" 10 "></span></a><span class=sd>        alpha (float):</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11></a><a href=#__codelineno-0-11><span class=linenos data-linenos=" 11 "></span></a><span class=sd>        sigma (float): Gaussian filter parameter.</span>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12></a><a href=#__codelineno-0-12><span class=linenos data-linenos=" 12 "></span></a><span class=sd>        alpha_affine (float): The range will be (-alpha_affine, alpha_affine)</span>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13></a><a href=#__codelineno-0-13><span class=linenos data-linenos=" 13 "></span></a><span class=sd>        interpolation (OpenCV flag): flag that is used to specify the interpolation algorithm. Should be one of:</span>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14></a><a href=#__codelineno-0-14><span class=linenos data-linenos=" 14 "></span></a><span class=sd>            cv2.INTER_NEAREST, cv2.INTER_LINEAR, cv2.INTER_CUBIC, cv2.INTER_AREA, cv2.INTER_LANCZOS4.</span>
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15></a><a href=#__codelineno-0-15><span class=linenos data-linenos=" 15 "></span></a><span class=sd>            Default: cv2.INTER_LINEAR.</span>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16></a><a href=#__codelineno-0-16><span class=linenos data-linenos=" 16 "></span></a><span class=sd>        border_mode (OpenCV flag): flag that is used to specify the pixel extrapolation method. Should be one of:</span>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17></a><a href=#__codelineno-0-17><span class=linenos data-linenos=" 17 "></span></a><span class=sd>            cv2.BORDER_CONSTANT, cv2.BORDER_REPLICATE, cv2.BORDER_REFLECT, cv2.BORDER_WRAP, cv2.BORDER_REFLECT_101.</span>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18></a><a href=#__codelineno-0-18><span class=linenos data-linenos=" 18 "></span></a><span class=sd>            Default: cv2.BORDER_REFLECT_101</span>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19></a><a href=#__codelineno-0-19><span class=linenos data-linenos=" 19 "></span></a><span class=sd>        value (int, float, list of ints, list of float): padding value if border_mode is cv2.BORDER_CONSTANT.</span>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20></a><a href=#__codelineno-0-20><span class=linenos data-linenos=" 20 "></span></a><span class=sd>        mask_value (int, float,</span>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21></a><a href=#__codelineno-0-21><span class=linenos data-linenos=" 21 "></span></a><span class=sd>                    list of ints,</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22></a><a href=#__codelineno-0-22><span class=linenos data-linenos=" 22 "></span></a><span class=sd>                    list of float): padding value if border_mode is cv2.BORDER_CONSTANT applied for masks.</span>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23></a><a href=#__codelineno-0-23><span class=linenos data-linenos=" 23 "></span></a><span class=sd>        approximate (boolean): Whether to smooth displacement map with fixed kernel size.</span>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a><a href=#__codelineno-0-24><span class=linenos data-linenos=" 24 "></span></a><span class=sd>                               Enabling this option gives ~2X speedup on large images.</span>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a><a href=#__codelineno-0-25><span class=linenos data-linenos=" 25 "></span></a><span class=sd>        same_dxdy (boolean): Whether to use same random generated shift for x and y.</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a><a href=#__codelineno-0-26><span class=linenos data-linenos=" 26 "></span></a><span class=sd>                             Enabling this option gives ~2X speedup.</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a><a href=#__codelineno-0-27><span class=linenos data-linenos=" 27 "></span></a>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a><a href=#__codelineno-0-28><span class=linenos data-linenos=" 28 "></span></a><span class=sd>    Targets:</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a><a href=#__codelineno-0-29><span class=linenos data-linenos=" 29 "></span></a><span class=sd>        image, mask, bboxes</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a><a href=#__codelineno-0-30><span class=linenos data-linenos=" 30 "></span></a>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a><a href=#__codelineno-0-31><span class=linenos data-linenos=" 31 "></span></a><span class=sd>    Image types:</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a><a href=#__codelineno-0-32><span class=linenos data-linenos=" 32 "></span></a><span class=sd>        uint8, float32</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a><a href=#__codelineno-0-33><span class=linenos data-linenos=" 33 "></span></a>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a><a href=#__codelineno-0-34><span class=linenos data-linenos=" 34 "></span></a><span class=sd>    Reference:</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a><a href=#__codelineno-0-35><span class=linenos data-linenos=" 35 "></span></a><span class=sd>        https://gist.github.com/ernestum/601cdf56d2b424757de5</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a><a href=#__codelineno-0-36><span class=linenos data-linenos=" 36 "></span></a>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a><a href=#__codelineno-0-37><span class=linenos data-linenos=" 37 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a><a href=#__codelineno-0-38><span class=linenos data-linenos=" 38 "></span></a>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a><a href=#__codelineno-0-39><span class=linenos data-linenos=" 39 "></span></a>    <span class=n>_targets</span> <span class=o>=</span> <span class=p>(</span><span class=n>Targets</span><span class=o>.</span><span class=n>IMAGE</span><span class=p>,</span> <span class=n>Targets</span><span class=o>.</span><span class=n>MASK</span><span class=p>,</span> <span class=n>Targets</span><span class=o>.</span><span class=n>BBOXES</span><span class=p>)</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a><a href=#__codelineno-0-40><span class=linenos data-linenos=" 40 "></span></a>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a><a href=#__codelineno-0-41><span class=linenos data-linenos=" 41 "></span></a>    <span class=k>class</span> <span class=nc>InitSchema</span><span class=p>(</span><span class=n>BaseTransformInitSchema</span><span class=p>):</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><a href=#__codelineno-0-42><span class=linenos data-linenos=" 42 "></span></a>        <span class=n>alpha</span><span class=p>:</span> <span class=n>Annotated</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=n>Field</span><span class=p>(</span><span class=n>default</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>"Alpha parameter."</span><span class=p>,</span> <span class=n>ge</span><span class=o>=</span><span class=mi>0</span><span class=p>)]</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos=" 43 "></span></a>        <span class=n>sigma</span><span class=p>:</span> <span class=n>Annotated</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=n>Field</span><span class=p>(</span><span class=n>default</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>"Sigma parameter for Gaussian filter."</span><span class=p>,</span> <span class=n>ge</span><span class=o>=</span><span class=mi>0</span><span class=p>)]</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos=" 44 "></span></a>        <span class=n>alpha_affine</span><span class=p>:</span> <span class=n>Annotated</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=n>Field</span><span class=p>(</span><span class=n>default</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>"Alpha affine parameter."</span><span class=p>,</span> <span class=n>ge</span><span class=o>=</span><span class=mi>0</span><span class=p>)]</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos=" 45 "></span></a>        <span class=n>interpolation</span><span class=p>:</span> <span class=n>InterpolationType</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_LINEAR</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos=" 46 "></span></a>        <span class=n>border_mode</span><span class=p>:</span> <span class=n>BorderModeType</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>BORDER_REFLECT_101</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos=" 47 "></span></a>        <span class=n>value</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=nb>float</span><span class=p>,</span> <span class=n>List</span><span class=p>[</span><span class=nb>int</span><span class=p>],</span> <span class=n>List</span><span class=p>[</span><span class=nb>float</span><span class=p>]]]</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos=" 48 "></span></a>            <span class=n>default</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos=" 49 "></span></a>            <span class=n>description</span><span class=o>=</span><span class=s2>"Padding value if border_mode is cv2.BORDER_CONSTANT."</span><span class=p>,</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos=" 50 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos=" 51 "></span></a>        <span class=n>mask_value</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=n>List</span><span class=p>[</span><span class=nb>int</span><span class=p>],</span> <span class=n>List</span><span class=p>[</span><span class=nb>float</span><span class=p>]]]</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos=" 52 "></span></a>            <span class=n>default</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a>            <span class=n>description</span><span class=o>=</span><span class=s2>"Padding value if border_mode is cv2.BORDER_CONSTANT applied for masks."</span><span class=p>,</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a>        <span class=n>approximate</span><span class=p>:</span> <span class=n>Annotated</span><span class=p>[</span><span class=nb>bool</span><span class=p>,</span> <span class=n>Field</span><span class=p>(</span><span class=n>default</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>"Approximate displacement map smoothing."</span><span class=p>)]</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a>        <span class=n>same_dxdy</span><span class=p>:</span> <span class=n>Annotated</span><span class=p>[</span><span class=nb>bool</span><span class=p>,</span> <span class=n>Field</span><span class=p>(</span><span class=n>default</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>"Use same shift for x and y."</span><span class=p>)]</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a>        <span class=n>alpha</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a>        <span class=n>sigma</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mi>50</span><span class=p>,</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a>        <span class=n>alpha_affine</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mi>50</span><span class=p>,</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a>        <span class=n>interpolation</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_LINEAR</span><span class=p>,</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a>        <span class=n>border_mode</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>BORDER_REFLECT_101</span><span class=p>,</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a>        <span class=n>value</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=nb>float</span><span class=p>,</span> <span class=n>List</span><span class=p>[</span><span class=nb>int</span><span class=p>],</span> <span class=n>List</span><span class=p>[</span><span class=nb>float</span><span class=p>]]]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a>        <span class=n>mask_value</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=nb>float</span><span class=p>,</span> <span class=n>List</span><span class=p>[</span><span class=nb>int</span><span class=p>],</span> <span class=n>List</span><span class=p>[</span><span class=nb>float</span><span class=p>]]]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a>        <span class=n>always_apply</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>bool</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a>        <span class=n>approximate</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a>        <span class=n>same_dxdy</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a>        <span class=n>p</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.5</span><span class=p>,</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a>    <span class=p>):</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=n>always_apply</span><span class=p>,</span> <span class=n>p</span><span class=p>)</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>alpha</span> <span class=o>=</span> <span class=n>alpha</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>alpha_affine</span> <span class=o>=</span> <span class=n>alpha_affine</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>sigma</span> <span class=o>=</span> <span class=n>sigma</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>interpolation</span> <span class=o>=</span> <span class=n>interpolation</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>border_mode</span> <span class=o>=</span> <span class=n>border_mode</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>value</span> <span class=o>=</span> <span class=n>value</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>mask_value</span> <span class=o>=</span> <span class=n>mask_value</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>approximate</span> <span class=o>=</span> <span class=n>approximate</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>same_dxdy</span> <span class=o>=</span> <span class=n>same_dxdy</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a>    <span class=k>def</span> <span class=nf>apply</span><span class=p>(</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a>        <span class=n>img</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a>        <span class=n>random_seed</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a>        <span class=n>interpolation</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a>        <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>,</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a>        <span class=k>return</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>elastic_transform</span><span class=p>(</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a>            <span class=n>img</span><span class=p>,</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>alpha</span><span class=p>,</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>sigma</span><span class=p>,</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>alpha_affine</span><span class=p>,</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a>            <span class=n>interpolation</span><span class=p>,</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>border_mode</span><span class=p>,</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>value</span><span class=p>,</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a>            <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>RandomState</span><span class=p>(</span><span class=n>random_seed</span><span class=p>),</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>approximate</span><span class=p>,</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>same_dxdy</span><span class=p>,</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a>    <span class=k>def</span> <span class=nf>apply_to_mask</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>mask</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>random_seed</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a>        <span class=k>return</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>elastic_transform</span><span class=p>(</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a>            <span class=n>mask</span><span class=p>,</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>alpha</span><span class=p>,</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>sigma</span><span class=p>,</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>alpha_affine</span><span class=p>,</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a>            <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_NEAREST</span><span class=p>,</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>border_mode</span><span class=p>,</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>mask_value</span><span class=p>,</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a>            <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>RandomState</span><span class=p>(</span><span class=n>random_seed</span><span class=p>),</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>approximate</span><span class=p>,</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>same_dxdy</span><span class=p>,</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a>    <span class=k>def</span> <span class=nf>apply_to_bbox</span><span class=p>(</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a>        <span class=n>bbox</span><span class=p>:</span> <span class=n>BoxInternalType</span><span class=p>,</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a>        <span class=n>random_seed</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a>        <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>,</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>BoxInternalType</span><span class=p>:</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a>        <span class=n>rows</span><span class=p>,</span> <span class=n>cols</span> <span class=o>=</span> <span class=n>params</span><span class=p>[</span><span class=s2>"rows"</span><span class=p>],</span> <span class=n>params</span><span class=p>[</span><span class=s2>"cols"</span><span class=p>]</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a>        <span class=n>mask</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=n>rows</span><span class=p>,</span> <span class=n>cols</span><span class=p>),</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>uint8</span><span class=p>)</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a>        <span class=n>bbox_denorm</span> <span class=o>=</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>denormalize_bbox</span><span class=p>(</span><span class=n>bbox</span><span class=p>,</span> <span class=n>rows</span><span class=p>,</span> <span class=n>cols</span><span class=p>)</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a>        <span class=n>x_min</span><span class=p>,</span> <span class=n>y_min</span><span class=p>,</span> <span class=n>x_max</span><span class=p>,</span> <span class=n>y_max</span> <span class=o>=</span> <span class=n>bbox_denorm</span><span class=p>[:</span><span class=mi>4</span><span class=p>]</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a>        <span class=n>x_min</span><span class=p>,</span> <span class=n>y_min</span><span class=p>,</span> <span class=n>x_max</span><span class=p>,</span> <span class=n>y_max</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>x_min</span><span class=p>),</span> <span class=nb>int</span><span class=p>(</span><span class=n>y_min</span><span class=p>),</span> <span class=nb>int</span><span class=p>(</span><span class=n>x_max</span><span class=p>),</span> <span class=nb>int</span><span class=p>(</span><span class=n>y_max</span><span class=p>)</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a>        <span class=n>mask</span><span class=p>[</span><span class=n>y_min</span><span class=p>:</span><span class=n>y_max</span><span class=p>,</span> <span class=n>x_min</span><span class=p>:</span><span class=n>x_max</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a>        <span class=n>mask</span> <span class=o>=</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>elastic_transform</span><span class=p>(</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a>            <span class=n>mask</span><span class=p>,</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>alpha</span><span class=p>,</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>sigma</span><span class=p>,</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>alpha_affine</span><span class=p>,</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a>            <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_NEAREST</span><span class=p>,</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>border_mode</span><span class=p>,</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>mask_value</span><span class=p>,</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a>            <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>RandomState</span><span class=p>(</span><span class=n>random_seed</span><span class=p>),</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>approximate</span><span class=p>,</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a>        <span class=n>bbox_returned</span> <span class=o>=</span> <span class=n>bbox_from_mask</span><span class=p>(</span><span class=n>mask</span><span class=p>)</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a>        <span class=k>return</span> <span class=n>cast</span><span class=p>(</span><span class=n>BoxInternalType</span><span class=p>,</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>normalize_bbox</span><span class=p>(</span><span class=n>bbox_returned</span><span class=p>,</span> <span class=n>rows</span><span class=p>,</span> <span class=n>cols</span><span class=p>))</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a>    <span class=k>def</span> <span class=nf>get_params</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>int</span><span class=p>]:</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a>        <span class=k>return</span> <span class=p>{</span><span class=s2>"random_seed"</span><span class=p>:</span> <span class=n>random_utils</span><span class=o>.</span><span class=n>get_random_seed</span><span class=p>()}</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a>    <span class=k>def</span> <span class=nf>get_transform_init_args_names</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=o>...</span><span class=p>]:</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a>        <span class=k>return</span> <span class=p>(</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a>            <span class=s2>"alpha"</span><span class=p>,</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a>            <span class=s2>"sigma"</span><span class=p>,</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a>            <span class=s2>"alpha_affine"</span><span class=p>,</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a>            <span class=s2>"interpolation"</span><span class=p>,</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><a href=#__codelineno-0-152><span class=linenos data-linenos="152 "></span></a>            <span class=s2>"border_mode"</span><span class=p>,</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><a href=#__codelineno-0-153><span class=linenos data-linenos="153 "></span></a>            <span class=s2>"value"</span><span class=p>,</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><a href=#__codelineno-0-154><span class=linenos data-linenos="154 "></span></a>            <span class=s2>"mask_value"</span><span class=p>,</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><a href=#__codelineno-0-155><span class=linenos data-linenos="155 "></span></a>            <span class=s2>"approximate"</span><span class=p>,</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><a href=#__codelineno-0-156><span class=linenos data-linenos="156 "></span></a>            <span class=s2>"same_dxdy"</span><span class=p>,</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><a href=#__codelineno-0-157><span class=linenos data-linenos="157 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><a href=#__codelineno-0-158><span class=linenos data-linenos="158 "></span></a>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><a href=#__codelineno-0-159><span class=linenos data-linenos="159 "></span></a>    <span class=nd>@property</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><a href=#__codelineno-0-160><span class=linenos data-linenos="160 "></span></a>    <span class=k>def</span> <span class=nf>targets</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Callable</span><span class=p>[</span><span class=o>...</span><span class=p>,</span> <span class=n>Any</span><span class=p>]]:</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><a href=#__codelineno-0-161><span class=linenos data-linenos="161 "></span></a>        <span class=k>return</span> <span class=p>{</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><a href=#__codelineno-0-162><span class=linenos data-linenos="162 "></span></a>            <span class=s2>"image"</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>apply</span><span class=p>,</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><a href=#__codelineno-0-163><span class=linenos data-linenos="163 "></span></a>            <span class=s2>"mask"</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>apply_to_mask</span><span class=p>,</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><a href=#__codelineno-0-164><span class=linenos data-linenos="164 "></span></a>            <span class=s2>"masks"</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>apply_to_masks</span><span class=p>,</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><a href=#__codelineno-0-165><span class=linenos data-linenos="165 "></span></a>            <span class=s2>"bboxes"</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>apply_to_bboxes</span><span class=p>,</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><a href=#__codelineno-0-166><span class=linenos data-linenos="166 "></span></a>        <span class=p>}</span>
</span></code></pre></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-method"> <h3 class="doc doc-heading" id=albumentations.augmentations.geometric.transforms.ElasticTransform.apply> <code class="highlight language-python"><span class=n>apply</span> <span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>img</span><span class=p>,</span> <span class=n>random_seed</span><span class=p>,</span> <span class=n>interpolation</span><span class=p>,</span> <span class=o>**</span><span class=n>params</span><span class=p>)</span></code> <a class=headerlink href=#albumentations.augmentations.geometric.transforms.ElasticTransform.apply title="Permanent link">¶</a></h3> <div class="doc doc-contents"> <p>Apply transform on image.</p> <details class=quote> <summary>Source code in <code>albumentations/augmentations/geometric/transforms.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=k>def</span> <span class=nf>apply</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>img</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>random_seed</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>interpolation</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=k>return</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>elastic_transform</span><span class=p>(</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>        <span class=n>img</span><span class=p>,</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>        <span class=bp>self</span><span class=o>.</span><span class=n>alpha</span><span class=p>,</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a>        <span class=bp>self</span><span class=o>.</span><span class=n>sigma</span><span class=p>,</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a>        <span class=bp>self</span><span class=o>.</span><span class=n>alpha_affine</span><span class=p>,</span>
</span><span id=__span-0-13><a href=#__codelineno-0-13 id=__codelineno-0-13 name=__codelineno-0-13></a>        <span class=n>interpolation</span><span class=p>,</span>
</span><span id=__span-0-14><a href=#__codelineno-0-14 id=__codelineno-0-14 name=__codelineno-0-14></a>        <span class=bp>self</span><span class=o>.</span><span class=n>border_mode</span><span class=p>,</span>
</span><span id=__span-0-15><a href=#__codelineno-0-15 id=__codelineno-0-15 name=__codelineno-0-15></a>        <span class=bp>self</span><span class=o>.</span><span class=n>value</span><span class=p>,</span>
</span><span id=__span-0-16><a href=#__codelineno-0-16 id=__codelineno-0-16 name=__codelineno-0-16></a>        <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>RandomState</span><span class=p>(</span><span class=n>random_seed</span><span class=p>),</span>
</span><span id=__span-0-17><a href=#__codelineno-0-17 id=__codelineno-0-17 name=__codelineno-0-17></a>        <span class=bp>self</span><span class=o>.</span><span class=n>approximate</span><span class=p>,</span>
</span><span id=__span-0-18><a href=#__codelineno-0-18 id=__codelineno-0-18 name=__codelineno-0-18></a>        <span class=bp>self</span><span class=o>.</span><span class=n>same_dxdy</span><span class=p>,</span>
</span><span id=__span-0-19><a href=#__codelineno-0-19 id=__codelineno-0-19 name=__codelineno-0-19></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-method"> <h3 class="doc doc-heading" id=albumentations.augmentations.geometric.transforms.ElasticTransform.get_params> <code class="highlight language-python"><span class=n>get_params</span> <span class=p>(</span><span class=bp>self</span><span class=p>)</span></code> <a class=headerlink href=#albumentations.augmentations.geometric.transforms.ElasticTransform.get_params title="Permanent link">¶</a></h3> <div class="doc doc-contents"> <p>Returns parameters independent of input</p> <details class=quote> <summary>Source code in <code>albumentations/augmentations/geometric/transforms.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=k>def</span> <span class=nf>get_params</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>int</span><span class=p>]:</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=k>return</span> <span class=p>{</span><span class=s2>"random_seed"</span><span class=p>:</span> <span class=n>random_utils</span><span class=o>.</span><span class=n>get_random_seed</span><span class=p>()}</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-method"> <h3 class="doc doc-heading" id=albumentations.augmentations.geometric.transforms.ElasticTransform.get_transform_init_args_names> <code class="highlight language-python"><span class=n>get_transform_init_args_names</span> <span class=p>(</span><span class=bp>self</span><span class=p>)</span></code> <a class=headerlink href=#albumentations.augmentations.geometric.transforms.ElasticTransform.get_transform_init_args_names title="Permanent link">¶</a></h3> <div class="doc doc-contents"> <p>Returns names of arguments that are used in <strong>init</strong> method of the transform</p> <details class=quote> <summary>Source code in <code>albumentations/augmentations/geometric/transforms.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=k>def</span> <span class=nf>get_transform_init_args_names</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=o>...</span><span class=p>]:</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=k>return</span> <span class=p>(</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>        <span class=s2>"alpha"</span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>        <span class=s2>"sigma"</span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>        <span class=s2>"alpha_affine"</span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>        <span class=s2>"interpolation"</span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>        <span class=s2>"border_mode"</span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>        <span class=s2>"value"</span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>        <span class=s2>"mask_value"</span><span class=p>,</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>        <span class=s2>"approximate"</span><span class=p>,</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a>        <span class=s2>"same_dxdy"</span><span class=p>,</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h2 class="doc doc-heading" data-toc-label=Flip id=albumentations.augmentations.geometric.transforms.Flip> <code>class <strong> Flip</strong></code> <code> </code> <span class=doc-github-link> <a href=https://github.com/albumentations-team/albumentations/blob/main/albumentations/augmentations/geometric/transforms.py#L1615 target=_blank>[view source on GitHub]</a> </span><a class=headerlink href=#albumentations.augmentations.geometric.transforms.Flip title="Permanent link">¶</a> </h2> <div class=class-signature> </div> <div class="doc doc-contents"> <p>Flip the input either horizontally, vertically or both horizontally and vertically.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>p</code></td> <td><code>float</code></td> <td><p>probability of applying the transform. Default: 0.5.</p></td> </tr> </tbody> </table> <div class="admonition targets"> <p class=admonition-title>Targets</p> <p>image, mask, bboxes, keypoints</p> </div> <p>Image types: uint8, float32</p> <div class="admonition info"> <p class=admonition-title><strong>Interactive Tool Available!</strong></p> <p> <strong>Explore this transform visually and adjust parameters interactively using this tool:</strong> </p> <p> <a class="md-button md-button--primary" href="https://huggingface.co/spaces/qubvel-hf/albumentations-demo?transform=Flip" target=_blank>Open Tool</a> </p> </div> <details class=quote> <summary>Source code in <code>albumentations/augmentations/geometric/transforms.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1></a><a href=#__codelineno-0-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>class</span> <span class=nc>Flip</span><span class=p>(</span><span class=n>DualTransform</span><span class=p>):</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2></a><a href=#__codelineno-0-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>    </span><span class=sd>"""Flip the input either horizontally, vertically or both horizontally and vertically.</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3></a><a href=#__codelineno-0-3><span class=linenos data-linenos=" 3 "></span></a>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4></a><a href=#__codelineno-0-4><span class=linenos data-linenos=" 4 "></span></a><span class=sd>    Args:</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5></a><a href=#__codelineno-0-5><span class=linenos data-linenos=" 5 "></span></a><span class=sd>        p (float): probability of applying the transform. Default: 0.5.</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6></a><a href=#__codelineno-0-6><span class=linenos data-linenos=" 6 "></span></a>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7></a><a href=#__codelineno-0-7><span class=linenos data-linenos=" 7 "></span></a><span class=sd>    Targets:</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8></a><a href=#__codelineno-0-8><span class=linenos data-linenos=" 8 "></span></a><span class=sd>        image, mask, bboxes, keypoints</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9></a><a href=#__codelineno-0-9><span class=linenos data-linenos=" 9 "></span></a>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10></a><a href=#__codelineno-0-10><span class=linenos data-linenos="10 "></span></a><span class=sd>    Image types:</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11></a><a href=#__codelineno-0-11><span class=linenos data-linenos="11 "></span></a><span class=sd>        uint8, float32</span>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12></a><a href=#__codelineno-0-12><span class=linenos data-linenos="12 "></span></a>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13></a><a href=#__codelineno-0-13><span class=linenos data-linenos="13 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14></a><a href=#__codelineno-0-14><span class=linenos data-linenos="14 "></span></a>
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15></a><a href=#__codelineno-0-15><span class=linenos data-linenos="15 "></span></a>    <span class=n>_targets</span> <span class=o>=</span> <span class=p>(</span><span class=n>Targets</span><span class=o>.</span><span class=n>IMAGE</span><span class=p>,</span> <span class=n>Targets</span><span class=o>.</span><span class=n>MASK</span><span class=p>,</span> <span class=n>Targets</span><span class=o>.</span><span class=n>BBOXES</span><span class=p>,</span> <span class=n>Targets</span><span class=o>.</span><span class=n>KEYPOINTS</span><span class=p>)</span>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16></a><a href=#__codelineno-0-16><span class=linenos data-linenos="16 "></span></a>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17></a><a href=#__codelineno-0-17><span class=linenos data-linenos="17 "></span></a>    <span class=k>def</span> <span class=nf>apply</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>img</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>d</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18></a><a href=#__codelineno-0-18><span class=linenos data-linenos="18 "></span></a><span class=w>        </span><span class=sd>"""Args:</span>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19></a><a href=#__codelineno-0-19><span class=linenos data-linenos="19 "></span></a><span class=sd>        d (int): code that specifies how to flip the input. 0 for vertical flipping, 1 for horizontal flipping,</span>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20></a><a href=#__codelineno-0-20><span class=linenos data-linenos="20 "></span></a><span class=sd>                -1 for both vertical and horizontal flipping (which is also could be seen as rotating the input by</span>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21></a><a href=#__codelineno-0-21><span class=linenos data-linenos="21 "></span></a><span class=sd>                180 degrees).</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22></a><a href=#__codelineno-0-22><span class=linenos data-linenos="22 "></span></a><span class=sd>        """</span>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23></a><a href=#__codelineno-0-23><span class=linenos data-linenos="23 "></span></a>        <span class=k>return</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>random_flip</span><span class=p>(</span><span class=n>img</span><span class=p>,</span> <span class=n>d</span><span class=p>)</span>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a><a href=#__codelineno-0-24><span class=linenos data-linenos="24 "></span></a>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a><a href=#__codelineno-0-25><span class=linenos data-linenos="25 "></span></a>    <span class=k>def</span> <span class=nf>get_params</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>int</span><span class=p>]:</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a><a href=#__codelineno-0-26><span class=linenos data-linenos="26 "></span></a>        <span class=c1># Random int in the range [-1, 1]</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a><a href=#__codelineno-0-27><span class=linenos data-linenos="27 "></span></a>        <span class=k>return</span> <span class=p>{</span><span class=s2>"d"</span><span class=p>:</span> <span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>)}</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a><a href=#__codelineno-0-28><span class=linenos data-linenos="28 "></span></a>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a><a href=#__codelineno-0-29><span class=linenos data-linenos="29 "></span></a>    <span class=k>def</span> <span class=nf>apply_to_bbox</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>bbox</span><span class=p>:</span> <span class=n>BoxInternalType</span><span class=p>,</span> <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>BoxInternalType</span><span class=p>:</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a><a href=#__codelineno-0-30><span class=linenos data-linenos="30 "></span></a>        <span class=k>return</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>bbox_flip</span><span class=p>(</span><span class=n>bbox</span><span class=p>,</span> <span class=o>**</span><span class=n>params</span><span class=p>)</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a><a href=#__codelineno-0-31><span class=linenos data-linenos="31 "></span></a>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a><a href=#__codelineno-0-32><span class=linenos data-linenos="32 "></span></a>    <span class=k>def</span> <span class=nf>apply_to_keypoint</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>keypoint</span><span class=p>:</span> <span class=n>KeypointInternalType</span><span class=p>,</span> <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>KeypointInternalType</span><span class=p>:</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a><a href=#__codelineno-0-33><span class=linenos data-linenos="33 "></span></a>        <span class=k>return</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>keypoint_flip</span><span class=p>(</span><span class=n>keypoint</span><span class=p>,</span> <span class=o>**</span><span class=n>params</span><span class=p>)</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a><a href=#__codelineno-0-34><span class=linenos data-linenos="34 "></span></a>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a><a href=#__codelineno-0-35><span class=linenos data-linenos="35 "></span></a>    <span class=k>def</span> <span class=nf>get_transform_init_args_names</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[()]:</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a><a href=#__codelineno-0-36><span class=linenos data-linenos="36 "></span></a>        <span class=k>return</span> <span class=p>()</span>
</span></code></pre></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-method"> <h3 class="doc doc-heading" id=albumentations.augmentations.geometric.transforms.Flip.apply> <code class="highlight language-python"><span class=n>apply</span> <span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>img</span><span class=p>,</span> <span class=n>d</span><span class=p>,</span> <span class=o>**</span><span class=n>params</span><span class=p>)</span></code> <a class=headerlink href=#albumentations.augmentations.geometric.transforms.Flip.apply title="Permanent link">¶</a></h3> <div class="doc doc-contents"> <p>d (int): code that specifies how to flip the input. 0 for vertical flipping, 1 for horizontal flipping, -1 for both vertical and horizontal flipping (which is also could be seen as rotating the input by 180 degrees).</p> <details class=quote> <summary>Source code in <code>albumentations/augmentations/geometric/transforms.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=k>def</span> <span class=nf>apply</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>img</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>d</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a><span class=w>    </span><span class=sd>"""Args:</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a><span class=sd>    d (int): code that specifies how to flip the input. 0 for vertical flipping, 1 for horizontal flipping,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a><span class=sd>            -1 for both vertical and horizontal flipping (which is also could be seen as rotating the input by</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a><span class=sd>            180 degrees).</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a><span class=sd>    """</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=k>return</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>random_flip</span><span class=p>(</span><span class=n>img</span><span class=p>,</span> <span class=n>d</span><span class=p>)</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-method"> <h3 class="doc doc-heading" id=albumentations.augmentations.geometric.transforms.Flip.get_params> <code class="highlight language-python"><span class=n>get_params</span> <span class=p>(</span><span class=bp>self</span><span class=p>)</span></code> <a class=headerlink href=#albumentations.augmentations.geometric.transforms.Flip.get_params title="Permanent link">¶</a></h3> <div class="doc doc-contents"> <p>Returns parameters independent of input</p> <details class=quote> <summary>Source code in <code>albumentations/augmentations/geometric/transforms.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=k>def</span> <span class=nf>get_params</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>int</span><span class=p>]:</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=c1># Random int in the range [-1, 1]</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=k>return</span> <span class=p>{</span><span class=s2>"d"</span><span class=p>:</span> <span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>)}</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-method"> <h3 class="doc doc-heading" id=albumentations.augmentations.geometric.transforms.Flip.get_transform_init_args_names> <code class="highlight language-python"><span class=n>get_transform_init_args_names</span> <span class=p>(</span><span class=bp>self</span><span class=p>)</span></code> <a class=headerlink href=#albumentations.augmentations.geometric.transforms.Flip.get_transform_init_args_names title="Permanent link">¶</a></h3> <div class="doc doc-contents"> <p>Returns names of arguments that are used in <strong>init</strong> method of the transform</p> <details class=quote> <summary>Source code in <code>albumentations/augmentations/geometric/transforms.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=k>def</span> <span class=nf>get_transform_init_args_names</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[()]:</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=k>return</span> <span class=p>()</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h2 class="doc doc-heading" data-toc-label=GridDistortion id=albumentations.augmentations.geometric.transforms.GridDistortion> <code>class <strong> GridDistortion</strong></code> <code> (num_steps=5, distort_limit=(-0.3, 0.3), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False, always_apply=None, p=0.5) </code> <span class=doc-github-link> <a href=https://github.com/albumentations-team/albumentations/blob/main/albumentations/augmentations/geometric/transforms.py#L1821 target=_blank>[view source on GitHub]</a> </span><a class=headerlink href=#albumentations.augmentations.geometric.transforms.GridDistortion title="Permanent link">¶</a> </h2> <div class=class-signature> </div> <div class="doc doc-contents"> <p>Applies grid distortion augmentation to images, masks, and bounding boxes. This technique involves dividing the image into a grid of cells and randomly displacing the intersection points of the grid, resulting in localized distortions.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>num_steps</code></td> <td><code>int</code></td> <td><p>Number of grid cells on each side (minimum 1).</p></td> </tr> <tr> <td><code>distort_limit</code></td> <td><code>float, (float, float</code></td> <td><p>Range of distortion limits. If a single float is provided, the range will be from (-distort_limit, distort_limit). Default: (-0.03, 0.03).</p></td> </tr> <tr> <td><code>interpolation</code></td> <td><code>OpenCV flag</code></td> <td><p>Interpolation algorithm used for image transformation. Options are: cv2.INTER_NEAREST, cv2.INTER_LINEAR, cv2.INTER_CUBIC, cv2.INTER_AREA, cv2.INTER_LANCZOS4. Default: cv2.INTER_LINEAR.</p></td> </tr> <tr> <td><code>border_mode</code></td> <td><code>OpenCV flag</code></td> <td><p>Pixel extrapolation method used when pixels outside the image are required. Options are: cv2.BORDER_CONSTANT, cv2.BORDER_REPLICATE, cv2.BORDER_REFLECT, cv2.BORDER_WRAP, cv2.BORDER_REFLECT_101. Default: cv2.BORDER_REFLECT_101.</p></td> </tr> <tr> <td><code>value</code></td> <td><code>int, float, list of ints, list of floats</code></td> <td><p>Value used for padding when border_mode is cv2.BORDER_CONSTANT.</p></td> </tr> <tr> <td><code>mask_value</code></td> <td><code>int, float, list of ints, list of floats</code></td> <td><p>Padding value for masks when border_mode is cv2.BORDER_CONSTANT.</p></td> </tr> <tr> <td><code>normalized</code></td> <td><code>bool</code></td> <td><p>If True, ensures that distortion does not exceed image boundaries. Default: False. Reference: <a href=https://github.com/albumentations-team/albumentations/pull/722 target=_blank>https://github.com/albumentations-team/albumentations/pull/722</a></p></td> </tr> </tbody> </table> <div class="admonition targets"> <p class=admonition-title>Targets</p> <p>image, mask, bboxes</p> </div> <p>Image types: uint8, float32</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>This transform is helpful in medical imagery, Optical Character Recognition, and other tasks where local distance may not be preserved.</p> </div> <div class="admonition info"> <p class=admonition-title><strong>Interactive Tool Available!</strong></p> <p> <strong>Explore this transform visually and adjust parameters interactively using this tool:</strong> </p> <p> <a class="md-button md-button--primary" href="https://huggingface.co/spaces/qubvel-hf/albumentations-demo?transform=GridDistortion" target=_blank>Open Tool</a> </p> </div> <details class=quote> <summary>Source code in <code>albumentations/augmentations/geometric/transforms.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1></a><a href=#__codelineno-0-1><span class=linenos data-linenos="  1 "></span></a><span class=k>class</span> <span class=nc>GridDistortion</span><span class=p>(</span><span class=n>DualTransform</span><span class=p>):</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2></a><a href=#__codelineno-0-2><span class=linenos data-linenos="  2 "></span></a><span class=w>    </span><span class=sd>"""Applies grid distortion augmentation to images, masks, and bounding boxes. This technique involves dividing</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3></a><a href=#__codelineno-0-3><span class=linenos data-linenos="  3 "></span></a><span class=sd>    the image into a grid of cells and randomly displacing the intersection points of the grid,</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4></a><a href=#__codelineno-0-4><span class=linenos data-linenos="  4 "></span></a><span class=sd>    resulting in localized distortions.</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5></a><a href=#__codelineno-0-5><span class=linenos data-linenos="  5 "></span></a>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6></a><a href=#__codelineno-0-6><span class=linenos data-linenos="  6 "></span></a><span class=sd>    Args:</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7></a><a href=#__codelineno-0-7><span class=linenos data-linenos="  7 "></span></a><span class=sd>        num_steps (int): Number of grid cells on each side (minimum 1).</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8></a><a href=#__codelineno-0-8><span class=linenos data-linenos="  8 "></span></a><span class=sd>        distort_limit (float, (float, float)): Range of distortion limits. If a single float is provided,</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9></a><a href=#__codelineno-0-9><span class=linenos data-linenos="  9 "></span></a><span class=sd>            the range will be from (-distort_limit, distort_limit). Default: (-0.03, 0.03).</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10></a><a href=#__codelineno-0-10><span class=linenos data-linenos=" 10 "></span></a><span class=sd>        interpolation (OpenCV flag): Interpolation algorithm used for image transformation. Options are:</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11></a><a href=#__codelineno-0-11><span class=linenos data-linenos=" 11 "></span></a><span class=sd>            cv2.INTER_NEAREST, cv2.INTER_LINEAR, cv2.INTER_CUBIC, cv2.INTER_AREA, cv2.INTER_LANCZOS4.</span>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12></a><a href=#__codelineno-0-12><span class=linenos data-linenos=" 12 "></span></a><span class=sd>            Default: cv2.INTER_LINEAR.</span>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13></a><a href=#__codelineno-0-13><span class=linenos data-linenos=" 13 "></span></a><span class=sd>        border_mode (OpenCV flag): Pixel extrapolation method used when pixels outside the image are required.</span>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14></a><a href=#__codelineno-0-14><span class=linenos data-linenos=" 14 "></span></a><span class=sd>            Options are: cv2.BORDER_CONSTANT, cv2.BORDER_REPLICATE, cv2.BORDER_REFLECT, cv2.BORDER_WRAP,</span>
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15></a><a href=#__codelineno-0-15><span class=linenos data-linenos=" 15 "></span></a><span class=sd>            cv2.BORDER_REFLECT_101.</span>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16></a><a href=#__codelineno-0-16><span class=linenos data-linenos=" 16 "></span></a><span class=sd>            Default: cv2.BORDER_REFLECT_101.</span>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17></a><a href=#__codelineno-0-17><span class=linenos data-linenos=" 17 "></span></a><span class=sd>        value (int, float, list of ints, list of floats, optional): Value used for padding when</span>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18></a><a href=#__codelineno-0-18><span class=linenos data-linenos=" 18 "></span></a><span class=sd>            border_mode is cv2.BORDER_CONSTANT.</span>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19></a><a href=#__codelineno-0-19><span class=linenos data-linenos=" 19 "></span></a><span class=sd>        mask_value (int, float, list of ints, list of floats, optional): Padding value for masks when</span>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20></a><a href=#__codelineno-0-20><span class=linenos data-linenos=" 20 "></span></a><span class=sd>            border_mode is cv2.BORDER_CONSTANT.</span>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21></a><a href=#__codelineno-0-21><span class=linenos data-linenos=" 21 "></span></a><span class=sd>        normalized (bool): If True, ensures that distortion does not exceed image boundaries. Default: False.</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22></a><a href=#__codelineno-0-22><span class=linenos data-linenos=" 22 "></span></a><span class=sd>            Reference: https://github.com/albumentations-team/albumentations/pull/722</span>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23></a><a href=#__codelineno-0-23><span class=linenos data-linenos=" 23 "></span></a>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a><a href=#__codelineno-0-24><span class=linenos data-linenos=" 24 "></span></a><span class=sd>    Targets:</span>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a><a href=#__codelineno-0-25><span class=linenos data-linenos=" 25 "></span></a><span class=sd>        image, mask, bboxes</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a><a href=#__codelineno-0-26><span class=linenos data-linenos=" 26 "></span></a>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a><a href=#__codelineno-0-27><span class=linenos data-linenos=" 27 "></span></a><span class=sd>    Image types:</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a><a href=#__codelineno-0-28><span class=linenos data-linenos=" 28 "></span></a><span class=sd>        uint8, float32</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a><a href=#__codelineno-0-29><span class=linenos data-linenos=" 29 "></span></a>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a><a href=#__codelineno-0-30><span class=linenos data-linenos=" 30 "></span></a><span class=sd>    Note:</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a><a href=#__codelineno-0-31><span class=linenos data-linenos=" 31 "></span></a><span class=sd>        This transform is helpful in medical imagery, Optical Character Recognition, and other tasks where local</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a><a href=#__codelineno-0-32><span class=linenos data-linenos=" 32 "></span></a><span class=sd>        distance may not be preserved.</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a><a href=#__codelineno-0-33><span class=linenos data-linenos=" 33 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a><a href=#__codelineno-0-34><span class=linenos data-linenos=" 34 "></span></a>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a><a href=#__codelineno-0-35><span class=linenos data-linenos=" 35 "></span></a>    <span class=n>_targets</span> <span class=o>=</span> <span class=p>(</span><span class=n>Targets</span><span class=o>.</span><span class=n>IMAGE</span><span class=p>,</span> <span class=n>Targets</span><span class=o>.</span><span class=n>MASK</span><span class=p>,</span> <span class=n>Targets</span><span class=o>.</span><span class=n>BBOXES</span><span class=p>)</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a><a href=#__codelineno-0-36><span class=linenos data-linenos=" 36 "></span></a>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a><a href=#__codelineno-0-37><span class=linenos data-linenos=" 37 "></span></a>    <span class=k>class</span> <span class=nc>InitSchema</span><span class=p>(</span><span class=n>BaseTransformInitSchema</span><span class=p>):</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a><a href=#__codelineno-0-38><span class=linenos data-linenos=" 38 "></span></a>        <span class=n>num_steps</span><span class=p>:</span> <span class=n>Annotated</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=n>Field</span><span class=p>(</span><span class=n>ge</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>"Count of grid cells on each side."</span><span class=p>)]</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a><a href=#__codelineno-0-39><span class=linenos data-linenos=" 39 "></span></a>        <span class=n>distort_limit</span><span class=p>:</span> <span class=n>SymmetricRangeType</span> <span class=o>=</span> <span class=p>(</span><span class=o>-</span><span class=mf>0.03</span><span class=p>,</span> <span class=mf>0.03</span><span class=p>)</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a><a href=#__codelineno-0-40><span class=linenos data-linenos=" 40 "></span></a>        <span class=n>interpolation</span><span class=p>:</span> <span class=n>InterpolationType</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_LINEAR</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a><a href=#__codelineno-0-41><span class=linenos data-linenos=" 41 "></span></a>        <span class=n>border_mode</span><span class=p>:</span> <span class=n>BorderModeType</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>BORDER_REFLECT_101</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><a href=#__codelineno-0-42><span class=linenos data-linenos=" 42 "></span></a>        <span class=n>value</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>ColorType</span><span class=p>]</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos=" 43 "></span></a>            <span class=n>default</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos=" 44 "></span></a>            <span class=n>description</span><span class=o>=</span><span class=s2>"Padding value if border_mode is cv2.BORDER_CONSTANT."</span><span class=p>,</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos=" 45 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos=" 46 "></span></a>        <span class=n>mask_value</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>ColorType</span><span class=p>]</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos=" 47 "></span></a>            <span class=n>default</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos=" 48 "></span></a>            <span class=n>description</span><span class=o>=</span><span class=s2>"Padding value for mask if border_mode is cv2.BORDER_CONSTANT."</span><span class=p>,</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos=" 49 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos=" 50 "></span></a>        <span class=n>normalized</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos=" 51 "></span></a>            <span class=n>default</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos=" 52 "></span></a>            <span class=n>description</span><span class=o>=</span><span class=s2>"If true, distortion will be normalized to not go outside the image."</span><span class=p>,</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a>        <span class=nd>@field_validator</span><span class=p>(</span><span class=s2>"distort_limit"</span><span class=p>)</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a>        <span class=nd>@classmethod</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a>        <span class=k>def</span> <span class=nf>check_limits</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>v</span><span class=p>:</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>],</span> <span class=n>info</span><span class=p>:</span> <span class=n>ValidationInfo</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>]:</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a>            <span class=n>bounds</span> <span class=o>=</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a>            <span class=n>result</span> <span class=o>=</span> <span class=n>to_tuple</span><span class=p>(</span><span class=n>v</span><span class=p>)</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a>            <span class=n>check_range</span><span class=p>(</span><span class=n>result</span><span class=p>,</span> <span class=o>*</span><span class=n>bounds</span><span class=p>,</span> <span class=n>info</span><span class=o>.</span><span class=n>field_name</span><span class=p>)</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a>            <span class=k>return</span> <span class=n>result</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a>        <span class=n>num_steps</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>5</span><span class=p>,</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a>        <span class=n>distort_limit</span><span class=p>:</span> <span class=n>ScaleFloatType</span> <span class=o>=</span> <span class=p>(</span><span class=o>-</span><span class=mf>0.3</span><span class=p>,</span> <span class=mf>0.3</span><span class=p>),</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a>        <span class=n>interpolation</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_LINEAR</span><span class=p>,</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a>        <span class=n>border_mode</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>BORDER_REFLECT_101</span><span class=p>,</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a>        <span class=n>value</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>ColorType</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a>        <span class=n>mask_value</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>ColorType</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a>        <span class=n>normalized</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a>        <span class=n>always_apply</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>bool</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a>        <span class=n>p</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.5</span><span class=p>,</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a>    <span class=p>):</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=n>always_apply</span><span class=p>,</span> <span class=n>p</span><span class=p>)</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>num_steps</span> <span class=o>=</span> <span class=n>num_steps</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>distort_limit</span> <span class=o>=</span> <span class=n>cast</span><span class=p>(</span><span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>],</span> <span class=n>distort_limit</span><span class=p>)</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>interpolation</span> <span class=o>=</span> <span class=n>interpolation</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>border_mode</span> <span class=o>=</span> <span class=n>border_mode</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>value</span> <span class=o>=</span> <span class=n>value</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>mask_value</span> <span class=o>=</span> <span class=n>mask_value</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>normalized</span> <span class=o>=</span> <span class=n>normalized</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a>    <span class=k>def</span> <span class=nf>apply</span><span class=p>(</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a>        <span class=n>img</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a>        <span class=n>stepsx</span><span class=p>:</span> <span class=n>Tuple</span><span class=p>[()],</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a>        <span class=n>stepsy</span><span class=p>:</span> <span class=n>Tuple</span><span class=p>[()],</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a>        <span class=n>interpolation</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a>        <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>,</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a>        <span class=k>return</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>grid_distortion</span><span class=p>(</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a>            <span class=n>img</span><span class=p>,</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>num_steps</span><span class=p>,</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a>            <span class=n>stepsx</span><span class=p>,</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a>            <span class=n>stepsy</span><span class=p>,</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a>            <span class=n>interpolation</span><span class=p>,</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>border_mode</span><span class=p>,</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>value</span><span class=p>,</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a>    <span class=k>def</span> <span class=nf>apply_to_mask</span><span class=p>(</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a>        <span class=n>mask</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>        <span class=n>stepsx</span><span class=p>:</span> <span class=n>Tuple</span><span class=p>[()],</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>        <span class=n>stepsy</span><span class=p>:</span> <span class=n>Tuple</span><span class=p>[()],</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>        <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>,</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a>        <span class=k>return</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>grid_distortion</span><span class=p>(</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a>            <span class=n>mask</span><span class=p>,</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>num_steps</span><span class=p>,</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a>            <span class=n>stepsx</span><span class=p>,</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a>            <span class=n>stepsy</span><span class=p>,</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a>            <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_NEAREST</span><span class=p>,</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>border_mode</span><span class=p>,</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>mask_value</span><span class=p>,</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a>    <span class=k>def</span> <span class=nf>apply_to_bbox</span><span class=p>(</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a>        <span class=n>bbox</span><span class=p>:</span> <span class=n>BoxInternalType</span><span class=p>,</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a>        <span class=n>stepsx</span><span class=p>:</span> <span class=n>Tuple</span><span class=p>[()],</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a>        <span class=n>stepsy</span><span class=p>:</span> <span class=n>Tuple</span><span class=p>[()],</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a>        <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>,</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>BoxInternalType</span><span class=p>:</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a>        <span class=n>rows</span><span class=p>,</span> <span class=n>cols</span> <span class=o>=</span> <span class=n>params</span><span class=p>[</span><span class=s2>"rows"</span><span class=p>],</span> <span class=n>params</span><span class=p>[</span><span class=s2>"cols"</span><span class=p>]</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a>        <span class=n>mask</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=n>rows</span><span class=p>,</span> <span class=n>cols</span><span class=p>),</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>uint8</span><span class=p>)</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a>        <span class=n>bbox_denorm</span> <span class=o>=</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>denormalize_bbox</span><span class=p>(</span><span class=n>bbox</span><span class=p>,</span> <span class=n>rows</span><span class=p>,</span> <span class=n>cols</span><span class=p>)</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a>        <span class=n>x_min</span><span class=p>,</span> <span class=n>y_min</span><span class=p>,</span> <span class=n>x_max</span><span class=p>,</span> <span class=n>y_max</span> <span class=o>=</span> <span class=n>bbox_denorm</span><span class=p>[:</span><span class=mi>4</span><span class=p>]</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a>        <span class=n>x_min</span><span class=p>,</span> <span class=n>y_min</span><span class=p>,</span> <span class=n>x_max</span><span class=p>,</span> <span class=n>y_max</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>x_min</span><span class=p>),</span> <span class=nb>int</span><span class=p>(</span><span class=n>y_min</span><span class=p>),</span> <span class=nb>int</span><span class=p>(</span><span class=n>x_max</span><span class=p>),</span> <span class=nb>int</span><span class=p>(</span><span class=n>y_max</span><span class=p>)</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a>        <span class=n>mask</span><span class=p>[</span><span class=n>y_min</span><span class=p>:</span><span class=n>y_max</span><span class=p>,</span> <span class=n>x_min</span><span class=p>:</span><span class=n>x_max</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a>        <span class=n>mask</span> <span class=o>=</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>grid_distortion</span><span class=p>(</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a>            <span class=n>mask</span><span class=p>,</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>num_steps</span><span class=p>,</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a>            <span class=n>stepsx</span><span class=p>,</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a>            <span class=n>stepsy</span><span class=p>,</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a>            <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_NEAREST</span><span class=p>,</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>border_mode</span><span class=p>,</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>mask_value</span><span class=p>,</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a>        <span class=n>bbox_returned</span> <span class=o>=</span> <span class=n>bbox_from_mask</span><span class=p>(</span><span class=n>mask</span><span class=p>)</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a>        <span class=k>return</span> <span class=n>cast</span><span class=p>(</span><span class=n>BoxInternalType</span><span class=p>,</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>normalize_bbox</span><span class=p>(</span><span class=n>bbox_returned</span><span class=p>,</span> <span class=n>rows</span><span class=p>,</span> <span class=n>cols</span><span class=p>))</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a>    <span class=k>def</span> <span class=nf>_normalize</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>h</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>w</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>xsteps</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>float</span><span class=p>],</span> <span class=n>ysteps</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>float</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a>        <span class=c1># compensate for smaller last steps in source image.</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a>        <span class=n>x_step</span> <span class=o>=</span> <span class=n>w</span> <span class=o>//</span> <span class=bp>self</span><span class=o>.</span><span class=n>num_steps</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a>        <span class=n>last_x_step</span> <span class=o>=</span> <span class=nb>min</span><span class=p>(</span><span class=n>w</span><span class=p>,</span> <span class=p>((</span><span class=bp>self</span><span class=o>.</span><span class=n>num_steps</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>*</span> <span class=n>x_step</span><span class=p>))</span> <span class=o>-</span> <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>num_steps</span> <span class=o>*</span> <span class=n>x_step</span><span class=p>)</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a>        <span class=n>xsteps</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>*=</span> <span class=n>last_x_step</span> <span class=o>/</span> <span class=n>x_step</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a>        <span class=n>y_step</span> <span class=o>=</span> <span class=n>h</span> <span class=o>//</span> <span class=bp>self</span><span class=o>.</span><span class=n>num_steps</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><a href=#__codelineno-0-152><span class=linenos data-linenos="152 "></span></a>        <span class=n>last_y_step</span> <span class=o>=</span> <span class=nb>min</span><span class=p>(</span><span class=n>h</span><span class=p>,</span> <span class=p>((</span><span class=bp>self</span><span class=o>.</span><span class=n>num_steps</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>*</span> <span class=n>y_step</span><span class=p>))</span> <span class=o>-</span> <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>num_steps</span> <span class=o>*</span> <span class=n>y_step</span><span class=p>)</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><a href=#__codelineno-0-153><span class=linenos data-linenos="153 "></span></a>        <span class=n>ysteps</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>*=</span> <span class=n>last_y_step</span> <span class=o>/</span> <span class=n>y_step</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><a href=#__codelineno-0-154><span class=linenos data-linenos="154 "></span></a>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><a href=#__codelineno-0-155><span class=linenos data-linenos="155 "></span></a>        <span class=c1># now normalize such that distortion never leaves image bounds.</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><a href=#__codelineno-0-156><span class=linenos data-linenos="156 "></span></a>        <span class=n>tx</span> <span class=o>=</span> <span class=n>w</span> <span class=o>/</span> <span class=n>math</span><span class=o>.</span><span class=n>floor</span><span class=p>(</span><span class=n>w</span> <span class=o>/</span> <span class=bp>self</span><span class=o>.</span><span class=n>num_steps</span><span class=p>)</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><a href=#__codelineno-0-157><span class=linenos data-linenos="157 "></span></a>        <span class=n>ty</span> <span class=o>=</span> <span class=n>h</span> <span class=o>/</span> <span class=n>math</span><span class=o>.</span><span class=n>floor</span><span class=p>(</span><span class=n>h</span> <span class=o>/</span> <span class=bp>self</span><span class=o>.</span><span class=n>num_steps</span><span class=p>)</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><a href=#__codelineno-0-158><span class=linenos data-linenos="158 "></span></a>        <span class=n>xsteps</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>xsteps</span><span class=p>)</span> <span class=o>*</span> <span class=p>(</span><span class=n>tx</span> <span class=o>/</span> <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>xsteps</span><span class=p>))</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><a href=#__codelineno-0-159><span class=linenos data-linenos="159 "></span></a>        <span class=n>ysteps</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>ysteps</span><span class=p>)</span> <span class=o>*</span> <span class=p>(</span><span class=n>ty</span> <span class=o>/</span> <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>ysteps</span><span class=p>))</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><a href=#__codelineno-0-160><span class=linenos data-linenos="160 "></span></a>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><a href=#__codelineno-0-161><span class=linenos data-linenos="161 "></span></a>        <span class=k>return</span> <span class=p>{</span><span class=s2>"stepsx"</span><span class=p>:</span> <span class=n>xsteps</span><span class=p>,</span> <span class=s2>"stepsy"</span><span class=p>:</span> <span class=n>ysteps</span><span class=p>}</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><a href=#__codelineno-0-162><span class=linenos data-linenos="162 "></span></a>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><a href=#__codelineno-0-163><span class=linenos data-linenos="163 "></span></a>    <span class=nd>@property</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><a href=#__codelineno-0-164><span class=linenos data-linenos="164 "></span></a>    <span class=k>def</span> <span class=nf>targets_as_params</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]:</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><a href=#__codelineno-0-165><span class=linenos data-linenos="165 "></span></a>        <span class=k>return</span> <span class=p>[</span><span class=s2>"image"</span><span class=p>]</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><a href=#__codelineno-0-166><span class=linenos data-linenos="166 "></span></a>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><a href=#__codelineno-0-167><span class=linenos data-linenos="167 "></span></a>    <span class=k>def</span> <span class=nf>get_params_dependent_on_targets</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>params</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><a href=#__codelineno-0-168><span class=linenos data-linenos="168 "></span></a>        <span class=n>height</span><span class=p>,</span> <span class=n>width</span> <span class=o>=</span> <span class=n>params</span><span class=p>[</span><span class=s2>"image"</span><span class=p>]</span><span class=o>.</span><span class=n>shape</span><span class=p>[:</span><span class=mi>2</span><span class=p>]</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a><a href=#__codelineno-0-169><span class=linenos data-linenos="169 "></span></a>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a><a href=#__codelineno-0-170><span class=linenos data-linenos="170 "></span></a>        <span class=n>stepsx</span> <span class=o>=</span> <span class=p>[</span><span class=mi>1</span> <span class=o>+</span> <span class=n>random</span><span class=o>.</span><span class=n>uniform</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>distort_limit</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=bp>self</span><span class=o>.</span><span class=n>distort_limit</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span> <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>num_steps</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)]</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a><a href=#__codelineno-0-171><span class=linenos data-linenos="171 "></span></a>        <span class=n>stepsy</span> <span class=o>=</span> <span class=p>[</span><span class=mi>1</span> <span class=o>+</span> <span class=n>random</span><span class=o>.</span><span class=n>uniform</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>distort_limit</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=bp>self</span><span class=o>.</span><span class=n>distort_limit</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span> <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>num_steps</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)]</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a><a href=#__codelineno-0-172><span class=linenos data-linenos="172 "></span></a>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a><a href=#__codelineno-0-173><span class=linenos data-linenos="173 "></span></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>normalized</span><span class=p>:</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a><a href=#__codelineno-0-174><span class=linenos data-linenos="174 "></span></a>            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_normalize</span><span class=p>(</span><span class=n>height</span><span class=p>,</span> <span class=n>width</span><span class=p>,</span> <span class=n>stepsx</span><span class=p>,</span> <span class=n>stepsy</span><span class=p>)</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a><a href=#__codelineno-0-175><span class=linenos data-linenos="175 "></span></a>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a><a href=#__codelineno-0-176><span class=linenos data-linenos="176 "></span></a>        <span class=k>return</span> <span class=p>{</span><span class=s2>"stepsx"</span><span class=p>:</span> <span class=n>stepsx</span><span class=p>,</span> <span class=s2>"stepsy"</span><span class=p>:</span> <span class=n>stepsy</span><span class=p>}</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a><a href=#__codelineno-0-177><span class=linenos data-linenos="177 "></span></a>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a><a href=#__codelineno-0-178><span class=linenos data-linenos="178 "></span></a>    <span class=k>def</span> <span class=nf>get_transform_init_args_names</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=o>...</span><span class=p>]:</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a><a href=#__codelineno-0-179><span class=linenos data-linenos="179 "></span></a>        <span class=k>return</span> <span class=s2>"num_steps"</span><span class=p>,</span> <span class=s2>"distort_limit"</span><span class=p>,</span> <span class=s2>"interpolation"</span><span class=p>,</span> <span class=s2>"border_mode"</span><span class=p>,</span> <span class=s2>"value"</span><span class=p>,</span> <span class=s2>"mask_value"</span><span class=p>,</span> <span class=s2>"normalized"</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a><a href=#__codelineno-0-180><span class=linenos data-linenos="180 "></span></a>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a><a href=#__codelineno-0-181><span class=linenos data-linenos="181 "></span></a>    <span class=nd>@property</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a><a href=#__codelineno-0-182><span class=linenos data-linenos="182 "></span></a>    <span class=k>def</span> <span class=nf>targets</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Callable</span><span class=p>[</span><span class=o>...</span><span class=p>,</span> <span class=n>Any</span><span class=p>]]:</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a><a href=#__codelineno-0-183><span class=linenos data-linenos="183 "></span></a>        <span class=k>return</span> <span class=p>{</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a><a href=#__codelineno-0-184><span class=linenos data-linenos="184 "></span></a>            <span class=s2>"image"</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>apply</span><span class=p>,</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a><a href=#__codelineno-0-185><span class=linenos data-linenos="185 "></span></a>            <span class=s2>"mask"</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>apply_to_mask</span><span class=p>,</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a><a href=#__codelineno-0-186><span class=linenos data-linenos="186 "></span></a>            <span class=s2>"masks"</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>apply_to_masks</span><span class=p>,</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a><a href=#__codelineno-0-187><span class=linenos data-linenos="187 "></span></a>            <span class=s2>"bboxes"</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>apply_to_bboxes</span><span class=p>,</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a><a href=#__codelineno-0-188><span class=linenos data-linenos="188 "></span></a>        <span class=p>}</span>
</span></code></pre></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-attribute"> <h3 class="doc doc-heading" id=albumentations.augmentations.geometric.transforms.GridDistortion.targets_as_params> <code class="highlight language-python"><span class=n>targets_as_params</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span></code> <span class="doc doc-properties"> <small class="doc doc-property doc-property-property"><code>property</code></small> <small class="doc doc-property doc-property-readonly"><code>readonly</code></small> </span> <a class=headerlink href=#albumentations.augmentations.geometric.transforms.GridDistortion.targets_as_params title="Permanent link">¶</a></h3> <div class="doc doc-contents"> <p>Targets used to get params</p> </div> </div> <div class="doc doc-object doc-method"> <h3 class="doc doc-heading" id=albumentations.augmentations.geometric.transforms.GridDistortion.apply> <code class="highlight language-python"><span class=n>apply</span> <span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>img</span><span class=p>,</span> <span class=n>stepsx</span><span class=p>,</span> <span class=n>stepsy</span><span class=p>,</span> <span class=n>interpolation</span><span class=p>,</span> <span class=o>**</span><span class=n>params</span><span class=p>)</span></code> <a class=headerlink href=#albumentations.augmentations.geometric.transforms.GridDistortion.apply title="Permanent link">¶</a></h3> <div class="doc doc-contents"> <p>Apply transform on image.</p> <details class=quote> <summary>Source code in <code>albumentations/augmentations/geometric/transforms.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=k>def</span> <span class=nf>apply</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>img</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>stepsx</span><span class=p>:</span> <span class=n>Tuple</span><span class=p>[()],</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>stepsy</span><span class=p>:</span> <span class=n>Tuple</span><span class=p>[()],</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>interpolation</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>    <span class=k>return</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>grid_distortion</span><span class=p>(</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>        <span class=n>img</span><span class=p>,</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a>        <span class=bp>self</span><span class=o>.</span><span class=n>num_steps</span><span class=p>,</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a>        <span class=n>stepsx</span><span class=p>,</span>
</span><span id=__span-0-13><a href=#__codelineno-0-13 id=__codelineno-0-13 name=__codelineno-0-13></a>        <span class=n>stepsy</span><span class=p>,</span>
</span><span id=__span-0-14><a href=#__codelineno-0-14 id=__codelineno-0-14 name=__codelineno-0-14></a>        <span class=n>interpolation</span><span class=p>,</span>
</span><span id=__span-0-15><a href=#__codelineno-0-15 id=__codelineno-0-15 name=__codelineno-0-15></a>        <span class=bp>self</span><span class=o>.</span><span class=n>border_mode</span><span class=p>,</span>
</span><span id=__span-0-16><a href=#__codelineno-0-16 id=__codelineno-0-16 name=__codelineno-0-16></a>        <span class=bp>self</span><span class=o>.</span><span class=n>value</span><span class=p>,</span>
</span><span id=__span-0-17><a href=#__codelineno-0-17 id=__codelineno-0-17 name=__codelineno-0-17></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-method"> <h3 class="doc doc-heading" id=albumentations.augmentations.geometric.transforms.GridDistortion.get_params_dependent_on_targets> <code class="highlight language-python"><span class=n>get_params_dependent_on_targets</span> <span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>params</span><span class=p>)</span></code> <a class=headerlink href=#albumentations.augmentations.geometric.transforms.GridDistortion.get_params_dependent_on_targets title="Permanent link">¶</a></h3> <div class="doc doc-contents"> <p>Returns parameters dependent on targets. Dependent target is defined in <code>self.targets_as_params</code></p> <details class=quote> <summary>Source code in <code>albumentations/augmentations/geometric/transforms.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=k>def</span> <span class=nf>get_params_dependent_on_targets</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>params</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>height</span><span class=p>,</span> <span class=n>width</span> <span class=o>=</span> <span class=n>params</span><span class=p>[</span><span class=s2>"image"</span><span class=p>]</span><span class=o>.</span><span class=n>shape</span><span class=p>[:</span><span class=mi>2</span><span class=p>]</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>stepsx</span> <span class=o>=</span> <span class=p>[</span><span class=mi>1</span> <span class=o>+</span> <span class=n>random</span><span class=o>.</span><span class=n>uniform</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>distort_limit</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=bp>self</span><span class=o>.</span><span class=n>distort_limit</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span> <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>num_steps</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)]</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>stepsy</span> <span class=o>=</span> <span class=p>[</span><span class=mi>1</span> <span class=o>+</span> <span class=n>random</span><span class=o>.</span><span class=n>uniform</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>distort_limit</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=bp>self</span><span class=o>.</span><span class=n>distort_limit</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span> <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>num_steps</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)]</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>normalized</span><span class=p>:</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_normalize</span><span class=p>(</span><span class=n>height</span><span class=p>,</span> <span class=n>width</span><span class=p>,</span> <span class=n>stepsx</span><span class=p>,</span> <span class=n>stepsy</span><span class=p>)</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>    <span class=k>return</span> <span class=p>{</span><span class=s2>"stepsx"</span><span class=p>:</span> <span class=n>stepsx</span><span class=p>,</span> <span class=s2>"stepsy"</span><span class=p>:</span> <span class=n>stepsy</span><span class=p>}</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-method"> <h3 class="doc doc-heading" id=albumentations.augmentations.geometric.transforms.GridDistortion.get_transform_init_args_names> <code class="highlight language-python"><span class=n>get_transform_init_args_names</span> <span class=p>(</span><span class=bp>self</span><span class=p>)</span></code> <a class=headerlink href=#albumentations.augmentations.geometric.transforms.GridDistortion.get_transform_init_args_names title="Permanent link">¶</a></h3> <div class="doc doc-contents"> <p>Returns names of arguments that are used in <strong>init</strong> method of the transform</p> <details class=quote> <summary>Source code in <code>albumentations/augmentations/geometric/transforms.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=k>def</span> <span class=nf>get_transform_init_args_names</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=o>...</span><span class=p>]:</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=k>return</span> <span class=s2>"num_steps"</span><span class=p>,</span> <span class=s2>"distort_limit"</span><span class=p>,</span> <span class=s2>"interpolation"</span><span class=p>,</span> <span class=s2>"border_mode"</span><span class=p>,</span> <span class=s2>"value"</span><span class=p>,</span> <span class=s2>"mask_value"</span><span class=p>,</span> <span class=s2>"normalized"</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h2 class="doc doc-heading" data-toc-label=HorizontalFlip id=albumentations.augmentations.geometric.transforms.HorizontalFlip> <code>class <strong> HorizontalFlip</strong></code> <code> </code> <span class=doc-github-link> <a href=https://github.com/albumentations-team/albumentations/blob/main/albumentations/augmentations/geometric/transforms.py#L1581 target=_blank>[view source on GitHub]</a> </span><a class=headerlink href=#albumentations.augmentations.geometric.transforms.HorizontalFlip title="Permanent link">¶</a> </h2> <div class=class-signature> </div> <div class="doc doc-contents"> <p>Flip the input horizontally around the y-axis.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>p</code></td> <td><code>float</code></td> <td><p>probability of applying the transform. Default: 0.5.</p></td> </tr> </tbody> </table> <div class="admonition targets"> <p class=admonition-title>Targets</p> <p>image, mask, bboxes, keypoints</p> </div> <p>Image types: uint8, float32</p> <div class="admonition info"> <p class=admonition-title><strong>Interactive Tool Available!</strong></p> <p> <strong>Explore this transform visually and adjust parameters interactively using this tool:</strong> </p> <p> <a class="md-button md-button--primary" href="https://huggingface.co/spaces/qubvel-hf/albumentations-demo?transform=HorizontalFlip" target=_blank>Open Tool</a> </p> </div> <details class=quote> <summary>Source code in <code>albumentations/augmentations/geometric/transforms.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1></a><a href=#__codelineno-0-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>class</span> <span class=nc>HorizontalFlip</span><span class=p>(</span><span class=n>DualTransform</span><span class=p>):</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2></a><a href=#__codelineno-0-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>    </span><span class=sd>"""Flip the input horizontally around the y-axis.</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3></a><a href=#__codelineno-0-3><span class=linenos data-linenos=" 3 "></span></a>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4></a><a href=#__codelineno-0-4><span class=linenos data-linenos=" 4 "></span></a><span class=sd>    Args:</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5></a><a href=#__codelineno-0-5><span class=linenos data-linenos=" 5 "></span></a><span class=sd>        p (float): probability of applying the transform. Default: 0.5.</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6></a><a href=#__codelineno-0-6><span class=linenos data-linenos=" 6 "></span></a>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7></a><a href=#__codelineno-0-7><span class=linenos data-linenos=" 7 "></span></a><span class=sd>    Targets:</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8></a><a href=#__codelineno-0-8><span class=linenos data-linenos=" 8 "></span></a><span class=sd>        image, mask, bboxes, keypoints</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9></a><a href=#__codelineno-0-9><span class=linenos data-linenos=" 9 "></span></a>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10></a><a href=#__codelineno-0-10><span class=linenos data-linenos="10 "></span></a><span class=sd>    Image types:</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11></a><a href=#__codelineno-0-11><span class=linenos data-linenos="11 "></span></a><span class=sd>        uint8, float32</span>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12></a><a href=#__codelineno-0-12><span class=linenos data-linenos="12 "></span></a>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13></a><a href=#__codelineno-0-13><span class=linenos data-linenos="13 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14></a><a href=#__codelineno-0-14><span class=linenos data-linenos="14 "></span></a>
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15></a><a href=#__codelineno-0-15><span class=linenos data-linenos="15 "></span></a>    <span class=n>_targets</span> <span class=o>=</span> <span class=p>(</span><span class=n>Targets</span><span class=o>.</span><span class=n>IMAGE</span><span class=p>,</span> <span class=n>Targets</span><span class=o>.</span><span class=n>MASK</span><span class=p>,</span> <span class=n>Targets</span><span class=o>.</span><span class=n>BBOXES</span><span class=p>,</span> <span class=n>Targets</span><span class=o>.</span><span class=n>KEYPOINTS</span><span class=p>)</span>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16></a><a href=#__codelineno-0-16><span class=linenos data-linenos="16 "></span></a>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17></a><a href=#__codelineno-0-17><span class=linenos data-linenos="17 "></span></a>    <span class=k>def</span> <span class=nf>apply</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>img</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18></a><a href=#__codelineno-0-18><span class=linenos data-linenos="18 "></span></a>        <span class=k>if</span> <span class=n>get_num_channels</span><span class=p>(</span><span class=n>img</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>1</span> <span class=ow>and</span> <span class=n>img</span><span class=o>.</span><span class=n>dtype</span> <span class=o>==</span> <span class=n>np</span><span class=o>.</span><span class=n>uint8</span><span class=p>:</span>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19></a><a href=#__codelineno-0-19><span class=linenos data-linenos="19 "></span></a>            <span class=c1># Opencv is faster than numpy only in case of</span>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20></a><a href=#__codelineno-0-20><span class=linenos data-linenos="20 "></span></a>            <span class=c1># non-gray scale 8bits images</span>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21></a><a href=#__codelineno-0-21><span class=linenos data-linenos="21 "></span></a>            <span class=k>return</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>hflip_cv2</span><span class=p>(</span><span class=n>img</span><span class=p>)</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22></a><a href=#__codelineno-0-22><span class=linenos data-linenos="22 "></span></a>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23></a><a href=#__codelineno-0-23><span class=linenos data-linenos="23 "></span></a>        <span class=k>return</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>hflip</span><span class=p>(</span><span class=n>img</span><span class=p>)</span>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a><a href=#__codelineno-0-24><span class=linenos data-linenos="24 "></span></a>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a><a href=#__codelineno-0-25><span class=linenos data-linenos="25 "></span></a>    <span class=k>def</span> <span class=nf>apply_to_bbox</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>bbox</span><span class=p>:</span> <span class=n>BoxInternalType</span><span class=p>,</span> <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>BoxInternalType</span><span class=p>:</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a><a href=#__codelineno-0-26><span class=linenos data-linenos="26 "></span></a>        <span class=k>return</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>bbox_hflip</span><span class=p>(</span><span class=n>bbox</span><span class=p>,</span> <span class=o>**</span><span class=n>params</span><span class=p>)</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a><a href=#__codelineno-0-27><span class=linenos data-linenos="27 "></span></a>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a><a href=#__codelineno-0-28><span class=linenos data-linenos="28 "></span></a>    <span class=k>def</span> <span class=nf>apply_to_keypoint</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>keypoint</span><span class=p>:</span> <span class=n>KeypointInternalType</span><span class=p>,</span> <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>KeypointInternalType</span><span class=p>:</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a><a href=#__codelineno-0-29><span class=linenos data-linenos="29 "></span></a>        <span class=k>return</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>keypoint_hflip</span><span class=p>(</span><span class=n>keypoint</span><span class=p>,</span> <span class=o>**</span><span class=n>params</span><span class=p>)</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a><a href=#__codelineno-0-30><span class=linenos data-linenos="30 "></span></a>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a><a href=#__codelineno-0-31><span class=linenos data-linenos="31 "></span></a>    <span class=k>def</span> <span class=nf>get_transform_init_args_names</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[()]:</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a><a href=#__codelineno-0-32><span class=linenos data-linenos="32 "></span></a>        <span class=k>return</span> <span class=p>()</span>
</span></code></pre></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-method"> <h3 class="doc doc-heading" id=albumentations.augmentations.geometric.transforms.HorizontalFlip.apply> <code class="highlight language-python"><span class=n>apply</span> <span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>img</span><span class=p>,</span> <span class=o>**</span><span class=n>params</span><span class=p>)</span></code> <a class=headerlink href=#albumentations.augmentations.geometric.transforms.HorizontalFlip.apply title="Permanent link">¶</a></h3> <div class="doc doc-contents"> <p>Apply transform on image.</p> <details class=quote> <summary>Source code in <code>albumentations/augmentations/geometric/transforms.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=k>def</span> <span class=nf>apply</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>img</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=k>if</span> <span class=n>get_num_channels</span><span class=p>(</span><span class=n>img</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>1</span> <span class=ow>and</span> <span class=n>img</span><span class=o>.</span><span class=n>dtype</span> <span class=o>==</span> <span class=n>np</span><span class=o>.</span><span class=n>uint8</span><span class=p>:</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>        <span class=c1># Opencv is faster than numpy only in case of</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>        <span class=c1># non-gray scale 8bits images</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>        <span class=k>return</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>hflip_cv2</span><span class=p>(</span><span class=n>img</span><span class=p>)</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=k>return</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>hflip</span><span class=p>(</span><span class=n>img</span><span class=p>)</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-method"> <h3 class="doc doc-heading" id=albumentations.augmentations.geometric.transforms.HorizontalFlip.get_transform_init_args_names> <code class="highlight language-python"><span class=n>get_transform_init_args_names</span> <span class=p>(</span><span class=bp>self</span><span class=p>)</span></code> <a class=headerlink href=#albumentations.augmentations.geometric.transforms.HorizontalFlip.get_transform_init_args_names title="Permanent link">¶</a></h3> <div class="doc doc-contents"> <p>Returns names of arguments that are used in <strong>init</strong> method of the transform</p> <details class=quote> <summary>Source code in <code>albumentations/augmentations/geometric/transforms.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=k>def</span> <span class=nf>get_transform_init_args_names</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[()]:</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=k>return</span> <span class=p>()</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h2 class="doc doc-heading" data-toc-label=OpticalDistortion id=albumentations.augmentations.geometric.transforms.OpticalDistortion> <code>class <strong> OpticalDistortion</strong></code> <code> (distort_limit=(-0.05, 0.05), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None, always_apply=None, p=0.5) </code> <span class=doc-github-link> <a href=https://github.com/albumentations-team/albumentations/blob/main/albumentations/augmentations/geometric/transforms.py#L1693 target=_blank>[view source on GitHub]</a> </span><a class=headerlink href=#albumentations.augmentations.geometric.transforms.OpticalDistortion title="Permanent link">¶</a> </h2> <div class=class-signature> </div> <div class="doc doc-contents"> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>distort_limit</code></td> <td><code>float, (float, float</code></td> <td><p>If distort_limit is a single float, the range will be (-distort_limit, distort_limit). Default: (-0.05, 0.05).</p></td> </tr> <tr> <td><code>shift_limit</code></td> <td><code>float, (float, float</code></td> <td><p>If shift_limit is a single float, the range will be (-shift_limit, shift_limit). Default: (-0.05, 0.05).</p></td> </tr> <tr> <td><code>interpolation</code></td> <td><code>OpenCV flag</code></td> <td><p>flag that is used to specify the interpolation algorithm. Should be one of: cv2.INTER_NEAREST, cv2.INTER_LINEAR, cv2.INTER_CUBIC, cv2.INTER_AREA, cv2.INTER_LANCZOS4. Default: cv2.INTER_LINEAR.</p></td> </tr> <tr> <td><code>border_mode</code></td> <td><code>OpenCV flag</code></td> <td><p>flag that is used to specify the pixel extrapolation method. Should be one of: cv2.BORDER_CONSTANT, cv2.BORDER_REPLICATE, cv2.BORDER_REFLECT, cv2.BORDER_WRAP, cv2.BORDER_REFLECT_101. Default: cv2.BORDER_REFLECT_101</p></td> </tr> <tr> <td><code>value</code></td> <td><code>int, float, list of ints, list of float</code></td> <td><p>padding value if border_mode is cv2.BORDER_CONSTANT.</p></td> </tr> <tr> <td><code>mask_value</code></td> <td><code>int, float, list of ints, list of float</code></td> <td><p>padding value if border_mode is cv2.BORDER_CONSTANT applied for masks.</p></td> </tr> </tbody> </table> <div class="admonition targets"> <p class=admonition-title>Targets</p> <p>image, mask, bboxes</p> </div> <p>Image types: uint8, float32</p> <div class="admonition info"> <p class=admonition-title><strong>Interactive Tool Available!</strong></p> <p> <strong>Explore this transform visually and adjust parameters interactively using this tool:</strong> </p> <p> <a class="md-button md-button--primary" href="https://huggingface.co/spaces/qubvel-hf/albumentations-demo?transform=OpticalDistortion" target=_blank>Open Tool</a> </p> </div> <details class=quote> <summary>Source code in <code>albumentations/augmentations/geometric/transforms.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1></a><a href=#__codelineno-0-1><span class=linenos data-linenos="  1 "></span></a><span class=k>class</span> <span class=nc>OpticalDistortion</span><span class=p>(</span><span class=n>DualTransform</span><span class=p>):</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2></a><a href=#__codelineno-0-2><span class=linenos data-linenos="  2 "></span></a><span class=w>    </span><span class=sd>"""Args:</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3></a><a href=#__codelineno-0-3><span class=linenos data-linenos="  3 "></span></a><span class=sd>        distort_limit (float, (float, float)): If distort_limit is a single float, the range</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4></a><a href=#__codelineno-0-4><span class=linenos data-linenos="  4 "></span></a><span class=sd>            will be (-distort_limit, distort_limit). Default: (-0.05, 0.05).</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5></a><a href=#__codelineno-0-5><span class=linenos data-linenos="  5 "></span></a><span class=sd>        shift_limit (float, (float, float))): If shift_limit is a single float, the range</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6></a><a href=#__codelineno-0-6><span class=linenos data-linenos="  6 "></span></a><span class=sd>            will be (-shift_limit, shift_limit). Default: (-0.05, 0.05).</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7></a><a href=#__codelineno-0-7><span class=linenos data-linenos="  7 "></span></a><span class=sd>        interpolation (OpenCV flag): flag that is used to specify the interpolation algorithm. Should be one of:</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8></a><a href=#__codelineno-0-8><span class=linenos data-linenos="  8 "></span></a><span class=sd>            cv2.INTER_NEAREST, cv2.INTER_LINEAR, cv2.INTER_CUBIC, cv2.INTER_AREA, cv2.INTER_LANCZOS4.</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9></a><a href=#__codelineno-0-9><span class=linenos data-linenos="  9 "></span></a><span class=sd>            Default: cv2.INTER_LINEAR.</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10></a><a href=#__codelineno-0-10><span class=linenos data-linenos=" 10 "></span></a><span class=sd>        border_mode (OpenCV flag): flag that is used to specify the pixel extrapolation method. Should be one of:</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11></a><a href=#__codelineno-0-11><span class=linenos data-linenos=" 11 "></span></a><span class=sd>            cv2.BORDER_CONSTANT, cv2.BORDER_REPLICATE, cv2.BORDER_REFLECT, cv2.BORDER_WRAP, cv2.BORDER_REFLECT_101.</span>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12></a><a href=#__codelineno-0-12><span class=linenos data-linenos=" 12 "></span></a><span class=sd>            Default: cv2.BORDER_REFLECT_101</span>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13></a><a href=#__codelineno-0-13><span class=linenos data-linenos=" 13 "></span></a><span class=sd>        value (int, float, list of ints, list of float): padding value if border_mode is cv2.BORDER_CONSTANT.</span>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14></a><a href=#__codelineno-0-14><span class=linenos data-linenos=" 14 "></span></a><span class=sd>        mask_value (int, float,</span>
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15></a><a href=#__codelineno-0-15><span class=linenos data-linenos=" 15 "></span></a><span class=sd>                    list of ints,</span>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16></a><a href=#__codelineno-0-16><span class=linenos data-linenos=" 16 "></span></a><span class=sd>                    list of float): padding value if border_mode is cv2.BORDER_CONSTANT applied for masks.</span>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17></a><a href=#__codelineno-0-17><span class=linenos data-linenos=" 17 "></span></a>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18></a><a href=#__codelineno-0-18><span class=linenos data-linenos=" 18 "></span></a><span class=sd>    Targets:</span>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19></a><a href=#__codelineno-0-19><span class=linenos data-linenos=" 19 "></span></a><span class=sd>        image, mask, bboxes</span>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20></a><a href=#__codelineno-0-20><span class=linenos data-linenos=" 20 "></span></a>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21></a><a href=#__codelineno-0-21><span class=linenos data-linenos=" 21 "></span></a><span class=sd>    Image types:</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22></a><a href=#__codelineno-0-22><span class=linenos data-linenos=" 22 "></span></a><span class=sd>        uint8, float32</span>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23></a><a href=#__codelineno-0-23><span class=linenos data-linenos=" 23 "></span></a>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a><a href=#__codelineno-0-24><span class=linenos data-linenos=" 24 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a><a href=#__codelineno-0-25><span class=linenos data-linenos=" 25 "></span></a>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a><a href=#__codelineno-0-26><span class=linenos data-linenos=" 26 "></span></a>    <span class=n>_targets</span> <span class=o>=</span> <span class=p>(</span><span class=n>Targets</span><span class=o>.</span><span class=n>IMAGE</span><span class=p>,</span> <span class=n>Targets</span><span class=o>.</span><span class=n>MASK</span><span class=p>,</span> <span class=n>Targets</span><span class=o>.</span><span class=n>BBOXES</span><span class=p>)</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a><a href=#__codelineno-0-27><span class=linenos data-linenos=" 27 "></span></a>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a><a href=#__codelineno-0-28><span class=linenos data-linenos=" 28 "></span></a>    <span class=k>class</span> <span class=nc>InitSchema</span><span class=p>(</span><span class=n>BaseTransformInitSchema</span><span class=p>):</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a><a href=#__codelineno-0-29><span class=linenos data-linenos=" 29 "></span></a>        <span class=n>distort_limit</span><span class=p>:</span> <span class=n>SymmetricRangeType</span> <span class=o>=</span> <span class=p>(</span><span class=o>-</span><span class=mf>0.05</span><span class=p>,</span> <span class=mf>0.05</span><span class=p>)</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a><a href=#__codelineno-0-30><span class=linenos data-linenos=" 30 "></span></a>        <span class=n>shift_limit</span><span class=p>:</span> <span class=n>SymmetricRangeType</span> <span class=o>=</span> <span class=p>(</span><span class=o>-</span><span class=mf>0.05</span><span class=p>,</span> <span class=mf>0.05</span><span class=p>)</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a><a href=#__codelineno-0-31><span class=linenos data-linenos=" 31 "></span></a>        <span class=n>interpolation</span><span class=p>:</span> <span class=n>InterpolationType</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_LINEAR</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a><a href=#__codelineno-0-32><span class=linenos data-linenos=" 32 "></span></a>        <span class=n>border_mode</span><span class=p>:</span> <span class=n>BorderModeType</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>BORDER_REFLECT_101</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a><a href=#__codelineno-0-33><span class=linenos data-linenos=" 33 "></span></a>        <span class=n>value</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>ColorType</span><span class=p>]</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a><a href=#__codelineno-0-34><span class=linenos data-linenos=" 34 "></span></a>            <span class=n>default</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a><a href=#__codelineno-0-35><span class=linenos data-linenos=" 35 "></span></a>            <span class=n>description</span><span class=o>=</span><span class=s2>"Padding value if border_mode is cv2.BORDER_CONSTANT."</span><span class=p>,</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a><a href=#__codelineno-0-36><span class=linenos data-linenos=" 36 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a><a href=#__codelineno-0-37><span class=linenos data-linenos=" 37 "></span></a>        <span class=n>mask_value</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>ColorType</span><span class=p>]</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a><a href=#__codelineno-0-38><span class=linenos data-linenos=" 38 "></span></a>            <span class=n>default</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a><a href=#__codelineno-0-39><span class=linenos data-linenos=" 39 "></span></a>            <span class=n>description</span><span class=o>=</span><span class=s2>"Padding value for mask if border_mode is cv2.BORDER_CONSTANT."</span><span class=p>,</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a><a href=#__codelineno-0-40><span class=linenos data-linenos=" 40 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a><a href=#__codelineno-0-41><span class=linenos data-linenos=" 41 "></span></a>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><a href=#__codelineno-0-42><span class=linenos data-linenos=" 42 "></span></a>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos=" 43 "></span></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos=" 44 "></span></a>        <span class=n>distort_limit</span><span class=p>:</span> <span class=n>ScaleFloatType</span> <span class=o>=</span> <span class=p>(</span><span class=o>-</span><span class=mf>0.05</span><span class=p>,</span> <span class=mf>0.05</span><span class=p>),</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos=" 45 "></span></a>        <span class=n>shift_limit</span><span class=p>:</span> <span class=n>ScaleFloatType</span> <span class=o>=</span> <span class=p>(</span><span class=o>-</span><span class=mf>0.05</span><span class=p>,</span> <span class=mf>0.05</span><span class=p>),</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos=" 46 "></span></a>        <span class=n>interpolation</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_LINEAR</span><span class=p>,</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos=" 47 "></span></a>        <span class=n>border_mode</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>BORDER_REFLECT_101</span><span class=p>,</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos=" 48 "></span></a>        <span class=n>value</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>ColorType</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos=" 49 "></span></a>        <span class=n>mask_value</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>ColorType</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos=" 50 "></span></a>        <span class=n>always_apply</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>bool</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos=" 51 "></span></a>        <span class=n>p</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.5</span><span class=p>,</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos=" 52 "></span></a>    <span class=p>):</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=n>always_apply</span><span class=p>,</span> <span class=n>p</span><span class=p>)</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>shift_limit</span> <span class=o>=</span> <span class=n>cast</span><span class=p>(</span><span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>],</span> <span class=n>shift_limit</span><span class=p>)</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>distort_limit</span> <span class=o>=</span> <span class=n>cast</span><span class=p>(</span><span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>],</span> <span class=n>distort_limit</span><span class=p>)</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>interpolation</span> <span class=o>=</span> <span class=n>interpolation</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>border_mode</span> <span class=o>=</span> <span class=n>border_mode</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>value</span> <span class=o>=</span> <span class=n>value</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>mask_value</span> <span class=o>=</span> <span class=n>mask_value</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a>    <span class=k>def</span> <span class=nf>apply</span><span class=p>(</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a>        <span class=n>img</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a>        <span class=n>k</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a>        <span class=n>dx</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a>        <span class=n>dy</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a>        <span class=n>interpolation</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a>        <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>,</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a>        <span class=k>return</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>optical_distortion</span><span class=p>(</span><span class=n>img</span><span class=p>,</span> <span class=n>k</span><span class=p>,</span> <span class=n>dx</span><span class=p>,</span> <span class=n>dy</span><span class=p>,</span> <span class=n>interpolation</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>border_mode</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>value</span><span class=p>)</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a>    <span class=k>def</span> <span class=nf>apply_to_mask</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>mask</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>k</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>dx</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>dy</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a>        <span class=k>return</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>optical_distortion</span><span class=p>(</span><span class=n>mask</span><span class=p>,</span> <span class=n>k</span><span class=p>,</span> <span class=n>dx</span><span class=p>,</span> <span class=n>dy</span><span class=p>,</span> <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_NEAREST</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>border_mode</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>mask_value</span><span class=p>)</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a>    <span class=k>def</span> <span class=nf>apply_to_bbox</span><span class=p>(</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a>        <span class=n>bbox</span><span class=p>:</span> <span class=n>BoxInternalType</span><span class=p>,</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a>        <span class=n>k</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a>        <span class=n>dx</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a>        <span class=n>dy</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a>        <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>,</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>BoxInternalType</span><span class=p>:</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a>        <span class=n>rows</span><span class=p>,</span> <span class=n>cols</span> <span class=o>=</span> <span class=n>params</span><span class=p>[</span><span class=s2>"rows"</span><span class=p>],</span> <span class=n>params</span><span class=p>[</span><span class=s2>"cols"</span><span class=p>]</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a>        <span class=n>mask</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=n>rows</span><span class=p>,</span> <span class=n>cols</span><span class=p>),</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>uint8</span><span class=p>)</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a>        <span class=n>bbox_denorm</span> <span class=o>=</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>denormalize_bbox</span><span class=p>(</span><span class=n>bbox</span><span class=p>,</span> <span class=n>rows</span><span class=p>,</span> <span class=n>cols</span><span class=p>)</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a>        <span class=n>x_min</span><span class=p>,</span> <span class=n>y_min</span><span class=p>,</span> <span class=n>x_max</span><span class=p>,</span> <span class=n>y_max</span> <span class=o>=</span> <span class=n>bbox_denorm</span><span class=p>[:</span><span class=mi>4</span><span class=p>]</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a>        <span class=n>x_min</span><span class=p>,</span> <span class=n>y_min</span><span class=p>,</span> <span class=n>x_max</span><span class=p>,</span> <span class=n>y_max</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>x_min</span><span class=p>),</span> <span class=nb>int</span><span class=p>(</span><span class=n>y_min</span><span class=p>),</span> <span class=nb>int</span><span class=p>(</span><span class=n>x_max</span><span class=p>),</span> <span class=nb>int</span><span class=p>(</span><span class=n>y_max</span><span class=p>)</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a>        <span class=n>mask</span><span class=p>[</span><span class=n>y_min</span><span class=p>:</span><span class=n>y_max</span><span class=p>,</span> <span class=n>x_min</span><span class=p>:</span><span class=n>x_max</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a>        <span class=n>mask</span> <span class=o>=</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>optical_distortion</span><span class=p>(</span><span class=n>mask</span><span class=p>,</span> <span class=n>k</span><span class=p>,</span> <span class=n>dx</span><span class=p>,</span> <span class=n>dy</span><span class=p>,</span> <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_NEAREST</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>border_mode</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>mask_value</span><span class=p>)</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a>        <span class=n>bbox_returned</span> <span class=o>=</span> <span class=n>bbox_from_mask</span><span class=p>(</span><span class=n>mask</span><span class=p>)</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a>        <span class=k>return</span> <span class=n>cast</span><span class=p>(</span><span class=n>BoxInternalType</span><span class=p>,</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>normalize_bbox</span><span class=p>(</span><span class=n>bbox_returned</span><span class=p>,</span> <span class=n>rows</span><span class=p>,</span> <span class=n>cols</span><span class=p>))</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a>    <span class=k>def</span> <span class=nf>get_params</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a>        <span class=k>return</span> <span class=p>{</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a>            <span class=s2>"k"</span><span class=p>:</span> <span class=n>random</span><span class=o>.</span><span class=n>uniform</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>distort_limit</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=bp>self</span><span class=o>.</span><span class=n>distort_limit</span><span class=p>[</span><span class=mi>1</span><span class=p>]),</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a>            <span class=s2>"dx"</span><span class=p>:</span> <span class=nb>round</span><span class=p>(</span><span class=n>random</span><span class=o>.</span><span class=n>uniform</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>shift_limit</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=bp>self</span><span class=o>.</span><span class=n>shift_limit</span><span class=p>[</span><span class=mi>1</span><span class=p>])),</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a>            <span class=s2>"dy"</span><span class=p>:</span> <span class=nb>round</span><span class=p>(</span><span class=n>random</span><span class=o>.</span><span class=n>uniform</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>shift_limit</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=bp>self</span><span class=o>.</span><span class=n>shift_limit</span><span class=p>[</span><span class=mi>1</span><span class=p>])),</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a>        <span class=p>}</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a>    <span class=k>def</span> <span class=nf>get_transform_init_args_names</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=o>...</span><span class=p>]:</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a>        <span class=k>return</span> <span class=p>(</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a>            <span class=s2>"distort_limit"</span><span class=p>,</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a>            <span class=s2>"shift_limit"</span><span class=p>,</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a>            <span class=s2>"interpolation"</span><span class=p>,</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a>            <span class=s2>"border_mode"</span><span class=p>,</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>            <span class=s2>"value"</span><span class=p>,</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>            <span class=s2>"mask_value"</span><span class=p>,</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a>    <span class=nd>@property</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a>    <span class=k>def</span> <span class=nf>targets</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Callable</span><span class=p>[</span><span class=o>...</span><span class=p>,</span> <span class=n>Any</span><span class=p>]]:</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a>        <span class=k>return</span> <span class=p>{</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a>            <span class=s2>"image"</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>apply</span><span class=p>,</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a>            <span class=s2>"mask"</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>apply_to_mask</span><span class=p>,</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a>            <span class=s2>"masks"</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>apply_to_masks</span><span class=p>,</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a>            <span class=s2>"bboxes"</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>apply_to_bboxes</span><span class=p>,</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a>        <span class=p>}</span>
</span></code></pre></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-method"> <h3 class="doc doc-heading" id=albumentations.augmentations.geometric.transforms.OpticalDistortion.apply> <code class="highlight language-python"><span class=n>apply</span> <span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>img</span><span class=p>,</span> <span class=n>k</span><span class=p>,</span> <span class=n>dx</span><span class=p>,</span> <span class=n>dy</span><span class=p>,</span> <span class=n>interpolation</span><span class=p>,</span> <span class=o>**</span><span class=n>params</span><span class=p>)</span></code> <a class=headerlink href=#albumentations.augmentations.geometric.transforms.OpticalDistortion.apply title="Permanent link">¶</a></h3> <div class="doc doc-contents"> <p>Apply transform on image.</p> <details class=quote> <summary>Source code in <code>albumentations/augmentations/geometric/transforms.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=k>def</span> <span class=nf>apply</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>img</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>k</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>dx</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>dy</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>interpolation</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>    <span class=k>return</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>optical_distortion</span><span class=p>(</span><span class=n>img</span><span class=p>,</span> <span class=n>k</span><span class=p>,</span> <span class=n>dx</span><span class=p>,</span> <span class=n>dy</span><span class=p>,</span> <span class=n>interpolation</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>border_mode</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>value</span><span class=p>)</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-method"> <h3 class="doc doc-heading" id=albumentations.augmentations.geometric.transforms.OpticalDistortion.get_params> <code class="highlight language-python"><span class=n>get_params</span> <span class=p>(</span><span class=bp>self</span><span class=p>)</span></code> <a class=headerlink href=#albumentations.augmentations.geometric.transforms.OpticalDistortion.get_params title="Permanent link">¶</a></h3> <div class="doc doc-contents"> <p>Returns parameters independent of input</p> <details class=quote> <summary>Source code in <code>albumentations/augmentations/geometric/transforms.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=k>def</span> <span class=nf>get_params</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=k>return</span> <span class=p>{</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>        <span class=s2>"k"</span><span class=p>:</span> <span class=n>random</span><span class=o>.</span><span class=n>uniform</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>distort_limit</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=bp>self</span><span class=o>.</span><span class=n>distort_limit</span><span class=p>[</span><span class=mi>1</span><span class=p>]),</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>        <span class=s2>"dx"</span><span class=p>:</span> <span class=nb>round</span><span class=p>(</span><span class=n>random</span><span class=o>.</span><span class=n>uniform</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>shift_limit</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=bp>self</span><span class=o>.</span><span class=n>shift_limit</span><span class=p>[</span><span class=mi>1</span><span class=p>])),</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>        <span class=s2>"dy"</span><span class=p>:</span> <span class=nb>round</span><span class=p>(</span><span class=n>random</span><span class=o>.</span><span class=n>uniform</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>shift_limit</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=bp>self</span><span class=o>.</span><span class=n>shift_limit</span><span class=p>[</span><span class=mi>1</span><span class=p>])),</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=p>}</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-method"> <h3 class="doc doc-heading" id=albumentations.augmentations.geometric.transforms.OpticalDistortion.get_transform_init_args_names> <code class="highlight language-python"><span class=n>get_transform_init_args_names</span> <span class=p>(</span><span class=bp>self</span><span class=p>)</span></code> <a class=headerlink href=#albumentations.augmentations.geometric.transforms.OpticalDistortion.get_transform_init_args_names title="Permanent link">¶</a></h3> <div class="doc doc-contents"> <p>Returns names of arguments that are used in <strong>init</strong> method of the transform</p> <details class=quote> <summary>Source code in <code>albumentations/augmentations/geometric/transforms.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=k>def</span> <span class=nf>get_transform_init_args_names</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=o>...</span><span class=p>]:</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=k>return</span> <span class=p>(</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>        <span class=s2>"distort_limit"</span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>        <span class=s2>"shift_limit"</span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>        <span class=s2>"interpolation"</span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>        <span class=s2>"border_mode"</span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>        <span class=s2>"value"</span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>        <span class=s2>"mask_value"</span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h2 class="doc doc-heading" data-toc-label=PadIfNeeded id=albumentations.augmentations.geometric.transforms.PadIfNeeded> <code>class <strong> PadIfNeeded</strong></code> <code> (min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, position=&lt;PositionType.CENTER: 'center'&gt;, border_mode=4, value=None, mask_value=None, always_apply=None, p=1.0) </code> <span class=doc-github-link> <a href=https://github.com/albumentations-team/albumentations/blob/main/albumentations/augmentations/geometric/transforms.py#L1304 target=_blank>[view source on GitHub]</a> </span><a class=headerlink href=#albumentations.augmentations.geometric.transforms.PadIfNeeded title="Permanent link">¶</a> </h2> <div class=class-signature> </div> <div class="doc doc-contents"> <p>Pads the sides of an image if the image dimensions are less than the specified minimum dimensions. If the <code>pad_height_divisor</code> or <code>pad_width_divisor</code> is specified, the function additionally ensures that the image dimensions are divisible by these values.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>min_height</code></td> <td><code>int</code></td> <td><p>Minimum desired height of the image. Ensures image height is at least this value.</p></td> </tr> <tr> <td><code>min_width</code></td> <td><code>int</code></td> <td><p>Minimum desired width of the image. Ensures image width is at least this value.</p></td> </tr> <tr> <td><code>pad_height_divisor</code></td> <td><code>int</code></td> <td><p>If set, pads the image height to make it divisible by this value.</p></td> </tr> <tr> <td><code>pad_width_divisor</code></td> <td><code>int</code></td> <td><p>If set, pads the image width to make it divisible by this value.</p></td> </tr> <tr> <td><code>position</code></td> <td><code>Union[str, PositionType]</code></td> <td><p>Position where the image is to be placed after padding. Can be one of 'center', 'top_left', 'top_right', 'bottom_left', 'bottom_right', or 'random'. Default is 'center'.</p></td> </tr> <tr> <td><code>border_mode</code></td> <td><code>int</code></td> <td><p>Specifies the border mode to use if padding is required. The default is <code>cv2.BORDER_REFLECT_101</code>. If <code>value</code> is provided and <code>border_mode</code> is set to a mode that does not use a constant value, it should be manually set to <code>cv2.BORDER_CONSTANT</code>.</p></td> </tr> <tr> <td><code>value</code></td> <td><code>Union[int, float, list[int], list[float]]</code></td> <td><p>Value to fill the border pixels if the border mode is <code>cv2.BORDER_CONSTANT</code>. Default is None.</p></td> </tr> <tr> <td><code>mask_value</code></td> <td><code>Union[int, float, list[int], list[float]]</code></td> <td><p>Similar to <code>value</code> but used for padding masks. Default is None.</p></td> </tr> <tr> <td><code>p</code></td> <td><code>float</code></td> <td><p>Probability of applying the transform. Default is 1.0.</p></td> </tr> </tbody> </table> <div class="admonition targets"> <p class=admonition-title>Targets</p> <p>image, mask, bboxes, keypoints</p> </div> <p>Image types: uint8, float32</p> <div class="admonition info"> <p class=admonition-title><strong>Interactive Tool Available!</strong></p> <p> <strong>Explore this transform visually and adjust parameters interactively using this tool:</strong> </p> <p> <a class="md-button md-button--primary" href="https://huggingface.co/spaces/qubvel-hf/albumentations-demo?transform=PadIfNeeded" target=_blank>Open Tool</a> </p> </div> <details class=quote> <summary>Source code in <code>albumentations/augmentations/geometric/transforms.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1></a><a href=#__codelineno-0-1><span class=linenos data-linenos="  1 "></span></a><span class=k>class</span> <span class=nc>PadIfNeeded</span><span class=p>(</span><span class=n>DualTransform</span><span class=p>):</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2></a><a href=#__codelineno-0-2><span class=linenos data-linenos="  2 "></span></a><span class=w>    </span><span class=sd>"""Pads the sides of an image if the image dimensions are less than the specified minimum dimensions.</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3></a><a href=#__codelineno-0-3><span class=linenos data-linenos="  3 "></span></a><span class=sd>    If the `pad_height_divisor` or `pad_width_divisor` is specified, the function additionally ensures</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4></a><a href=#__codelineno-0-4><span class=linenos data-linenos="  4 "></span></a><span class=sd>    that the image dimensions are divisible by these values.</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5></a><a href=#__codelineno-0-5><span class=linenos data-linenos="  5 "></span></a>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6></a><a href=#__codelineno-0-6><span class=linenos data-linenos="  6 "></span></a><span class=sd>    Args:</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7></a><a href=#__codelineno-0-7><span class=linenos data-linenos="  7 "></span></a><span class=sd>        min_height (int): Minimum desired height of the image. Ensures image height is at least this value.</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8></a><a href=#__codelineno-0-8><span class=linenos data-linenos="  8 "></span></a><span class=sd>        min_width (int): Minimum desired width of the image. Ensures image width is at least this value.</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9></a><a href=#__codelineno-0-9><span class=linenos data-linenos="  9 "></span></a><span class=sd>        pad_height_divisor (int, optional): If set, pads the image height to make it divisible by this value.</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10></a><a href=#__codelineno-0-10><span class=linenos data-linenos=" 10 "></span></a><span class=sd>        pad_width_divisor (int, optional): If set, pads the image width to make it divisible by this value.</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11></a><a href=#__codelineno-0-11><span class=linenos data-linenos=" 11 "></span></a><span class=sd>        position (Union[str, PositionType]): Position where the image is to be placed after padding.</span>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12></a><a href=#__codelineno-0-12><span class=linenos data-linenos=" 12 "></span></a><span class=sd>            Can be one of 'center', 'top_left', 'top_right', 'bottom_left', 'bottom_right', or 'random'.</span>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13></a><a href=#__codelineno-0-13><span class=linenos data-linenos=" 13 "></span></a><span class=sd>            Default is 'center'.</span>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14></a><a href=#__codelineno-0-14><span class=linenos data-linenos=" 14 "></span></a><span class=sd>        border_mode (int): Specifies the border mode to use if padding is required.</span>
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15></a><a href=#__codelineno-0-15><span class=linenos data-linenos=" 15 "></span></a><span class=sd>            The default is `cv2.BORDER_REFLECT_101`. If `value` is provided and `border_mode` is set to a mode</span>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16></a><a href=#__codelineno-0-16><span class=linenos data-linenos=" 16 "></span></a><span class=sd>            that does not use a constant value, it should be manually set to `cv2.BORDER_CONSTANT`.</span>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17></a><a href=#__codelineno-0-17><span class=linenos data-linenos=" 17 "></span></a><span class=sd>        value (Union[int, float, list[int], list[float]], optional): Value to fill the border pixels if</span>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18></a><a href=#__codelineno-0-18><span class=linenos data-linenos=" 18 "></span></a><span class=sd>            the border mode is `cv2.BORDER_CONSTANT`. Default is None.</span>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19></a><a href=#__codelineno-0-19><span class=linenos data-linenos=" 19 "></span></a><span class=sd>        mask_value (Union[int, float, list[int], list[float]], optional): Similar to `value` but used for padding masks.</span>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20></a><a href=#__codelineno-0-20><span class=linenos data-linenos=" 20 "></span></a><span class=sd>            Default is None.</span>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21></a><a href=#__codelineno-0-21><span class=linenos data-linenos=" 21 "></span></a><span class=sd>        p (float): Probability of applying the transform. Default is 1.0.</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22></a><a href=#__codelineno-0-22><span class=linenos data-linenos=" 22 "></span></a>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23></a><a href=#__codelineno-0-23><span class=linenos data-linenos=" 23 "></span></a><span class=sd>    Targets:</span>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a><a href=#__codelineno-0-24><span class=linenos data-linenos=" 24 "></span></a><span class=sd>        image, mask, bboxes, keypoints</span>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a><a href=#__codelineno-0-25><span class=linenos data-linenos=" 25 "></span></a>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a><a href=#__codelineno-0-26><span class=linenos data-linenos=" 26 "></span></a><span class=sd>    Image types:</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a><a href=#__codelineno-0-27><span class=linenos data-linenos=" 27 "></span></a><span class=sd>        uint8, float32</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a><a href=#__codelineno-0-28><span class=linenos data-linenos=" 28 "></span></a>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a><a href=#__codelineno-0-29><span class=linenos data-linenos=" 29 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a><a href=#__codelineno-0-30><span class=linenos data-linenos=" 30 "></span></a>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a><a href=#__codelineno-0-31><span class=linenos data-linenos=" 31 "></span></a>    <span class=k>class</span> <span class=nc>PositionType</span><span class=p>(</span><span class=n>Enum</span><span class=p>):</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a><a href=#__codelineno-0-32><span class=linenos data-linenos=" 32 "></span></a><span class=w>        </span><span class=sd>"""Enumerates the types of positions for placing an object within a container.</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a><a href=#__codelineno-0-33><span class=linenos data-linenos=" 33 "></span></a>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a><a href=#__codelineno-0-34><span class=linenos data-linenos=" 34 "></span></a><span class=sd>        This Enum class is utilized to define specific anchor positions that an object can</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a><a href=#__codelineno-0-35><span class=linenos data-linenos=" 35 "></span></a><span class=sd>        assume relative to a container. It's particularly useful in image processing, UI layout,</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a><a href=#__codelineno-0-36><span class=linenos data-linenos=" 36 "></span></a><span class=sd>        and graphic design to specify the alignment and positioning of elements.</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a><a href=#__codelineno-0-37><span class=linenos data-linenos=" 37 "></span></a>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a><a href=#__codelineno-0-38><span class=linenos data-linenos=" 38 "></span></a><span class=sd>        Attributes:</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a><a href=#__codelineno-0-39><span class=linenos data-linenos=" 39 "></span></a><span class=sd>            CENTER (str): Specifies that the object should be placed at the center.</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a><a href=#__codelineno-0-40><span class=linenos data-linenos=" 40 "></span></a><span class=sd>            TOP_LEFT (str): Specifies that the object should be placed at the top-left corner.</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a><a href=#__codelineno-0-41><span class=linenos data-linenos=" 41 "></span></a><span class=sd>            TOP_RIGHT (str): Specifies that the object should be placed at the top-right corner.</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><a href=#__codelineno-0-42><span class=linenos data-linenos=" 42 "></span></a><span class=sd>            BOTTOM_LEFT (str): Specifies that the object should be placed at the bottom-left corner.</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos=" 43 "></span></a><span class=sd>            BOTTOM_RIGHT (str): Specifies that the object should be placed at the bottom-right corner.</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos=" 44 "></span></a><span class=sd>            RANDOM (str): Indicates that the object's position should be determined randomly.</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos=" 45 "></span></a>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos=" 46 "></span></a><span class=sd>        """</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos=" 47 "></span></a>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos=" 48 "></span></a>        <span class=n>CENTER</span> <span class=o>=</span> <span class=s2>"center"</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos=" 49 "></span></a>        <span class=n>TOP_LEFT</span> <span class=o>=</span> <span class=s2>"top_left"</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos=" 50 "></span></a>        <span class=n>TOP_RIGHT</span> <span class=o>=</span> <span class=s2>"top_right"</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos=" 51 "></span></a>        <span class=n>BOTTOM_LEFT</span> <span class=o>=</span> <span class=s2>"bottom_left"</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos=" 52 "></span></a>        <span class=n>BOTTOM_RIGHT</span> <span class=o>=</span> <span class=s2>"bottom_right"</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a>        <span class=n>RANDOM</span> <span class=o>=</span> <span class=s2>"random"</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a>    <span class=n>_targets</span> <span class=o>=</span> <span class=p>(</span><span class=n>Targets</span><span class=o>.</span><span class=n>IMAGE</span><span class=p>,</span> <span class=n>Targets</span><span class=o>.</span><span class=n>MASK</span><span class=p>,</span> <span class=n>Targets</span><span class=o>.</span><span class=n>BBOXES</span><span class=p>,</span> <span class=n>Targets</span><span class=o>.</span><span class=n>KEYPOINTS</span><span class=p>)</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a>    <span class=k>class</span> <span class=nc>InitSchema</span><span class=p>(</span><span class=n>BaseTransformInitSchema</span><span class=p>):</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a>        <span class=n>min_height</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>int</span><span class=p>]</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=n>default</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>ge</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>"Minimal result image height."</span><span class=p>)</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a>        <span class=n>min_width</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>int</span><span class=p>]</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=n>default</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>ge</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>"Minimal result image width."</span><span class=p>)</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a>        <span class=n>pad_height_divisor</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>int</span><span class=p>]</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a>            <span class=n>default</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a>            <span class=n>ge</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a>            <span class=n>description</span><span class=o>=</span><span class=s2>"Ensures image height is divisible by this value."</span><span class=p>,</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a>        <span class=n>pad_width_divisor</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>int</span><span class=p>]</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a>            <span class=n>default</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a>            <span class=n>ge</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a>            <span class=n>description</span><span class=o>=</span><span class=s2>"Ensures image width is divisible by this value."</span><span class=p>,</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a>        <span class=n>position</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=n>default</span><span class=o>=</span><span class=s2>"center"</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>"Position of the padded image."</span><span class=p>)</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a>        <span class=n>border_mode</span><span class=p>:</span> <span class=n>BorderModeType</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>BORDER_REFLECT_101</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a>        <span class=n>value</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>ColorType</span><span class=p>]</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=n>default</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>"Value for border if BORDER_CONSTANT is used."</span><span class=p>)</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a>        <span class=n>mask_value</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>ColorType</span><span class=p>]</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a>            <span class=n>default</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a>            <span class=n>description</span><span class=o>=</span><span class=s2>"Value for mask border if BORDER_CONSTANT is used."</span><span class=p>,</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a>        <span class=n>p</span><span class=p>:</span> <span class=n>ProbabilityType</span> <span class=o>=</span> <span class=mf>1.0</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a>        <span class=nd>@model_validator</span><span class=p>(</span><span class=n>mode</span><span class=o>=</span><span class=s2>"after"</span><span class=p>)</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a>        <span class=k>def</span> <span class=nf>validate_divisibility</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Self</span><span class=p>:</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a>            <span class=k>if</span> <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>min_height</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>)</span> <span class=o>==</span> <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>pad_height_divisor</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>):</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a>                <span class=n>msg</span> <span class=o>=</span> <span class=s2>"Only one of 'min_height' and 'pad_height_divisor' parameters must be set"</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a>                <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a>            <span class=k>if</span> <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>min_width</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>)</span> <span class=o>==</span> <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>pad_width_divisor</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>):</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a>                <span class=n>msg</span> <span class=o>=</span> <span class=s2>"Only one of 'min_width' and 'pad_width_divisor' parameters must be set"</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a>                <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a>            <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>value</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=ow>and</span> <span class=bp>self</span><span class=o>.</span><span class=n>border_mode</span> <span class=ow>in</span> <span class=p>{</span><span class=n>cv2</span><span class=o>.</span><span class=n>BORDER_REFLECT_101</span><span class=p>,</span> <span class=n>cv2</span><span class=o>.</span><span class=n>BORDER_REFLECT101</span><span class=p>}:</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a>                <span class=bp>self</span><span class=o>.</span><span class=n>border_mode</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>BORDER_CONSTANT</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a>            <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>border_mode</span> <span class=o>==</span> <span class=n>cv2</span><span class=o>.</span><span class=n>BORDER_CONSTANT</span> <span class=ow>and</span> <span class=bp>self</span><span class=o>.</span><span class=n>value</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a>                <span class=n>msg</span> <span class=o>=</span> <span class=s2>"If 'border_mode' is set to 'BORDER_CONSTANT', 'value' must be provided."</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a>                <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a>            <span class=k>return</span> <span class=bp>self</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a>        <span class=n>min_height</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>int</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1024</span><span class=p>,</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a>        <span class=n>min_width</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>int</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1024</span><span class=p>,</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a>        <span class=n>pad_height_divisor</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>int</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a>        <span class=n>pad_width_divisor</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>int</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a>        <span class=n>position</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>PositionType</span><span class=p>,</span> <span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=n>PositionType</span><span class=o>.</span><span class=n>CENTER</span><span class=p>,</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a>        <span class=n>border_mode</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>BORDER_REFLECT_101</span><span class=p>,</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a>        <span class=n>value</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>ColorType</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>        <span class=n>mask_value</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>ColorType</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>        <span class=n>always_apply</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>bool</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>        <span class=n>p</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a>    <span class=p>):</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=n>always_apply</span><span class=p>,</span> <span class=n>p</span><span class=p>)</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>min_height</span> <span class=o>=</span> <span class=n>min_height</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>min_width</span> <span class=o>=</span> <span class=n>min_width</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>pad_width_divisor</span> <span class=o>=</span> <span class=n>pad_width_divisor</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>pad_height_divisor</span> <span class=o>=</span> <span class=n>pad_height_divisor</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>position</span> <span class=o>=</span> <span class=n>PadIfNeeded</span><span class=o>.</span><span class=n>PositionType</span><span class=p>(</span><span class=n>position</span><span class=p>)</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>border_mode</span> <span class=o>=</span> <span class=n>border_mode</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>value</span> <span class=o>=</span> <span class=n>value</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>mask_value</span> <span class=o>=</span> <span class=n>mask_value</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a>    <span class=k>def</span> <span class=nf>update_params</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>params</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>],</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>:</span> <span class=n>Any</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a>        <span class=n>params</span> <span class=o>=</span> <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>update_params</span><span class=p>(</span><span class=n>params</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a>        <span class=n>rows</span> <span class=o>=</span> <span class=n>params</span><span class=p>[</span><span class=s2>"rows"</span><span class=p>]</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a>        <span class=n>cols</span> <span class=o>=</span> <span class=n>params</span><span class=p>[</span><span class=s2>"cols"</span><span class=p>]</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>min_height</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a>            <span class=k>if</span> <span class=n>rows</span> <span class=o>&lt;</span> <span class=bp>self</span><span class=o>.</span><span class=n>min_height</span><span class=p>:</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a>                <span class=n>h_pad_top</span> <span class=o>=</span> <span class=nb>int</span><span class=p>((</span><span class=bp>self</span><span class=o>.</span><span class=n>min_height</span> <span class=o>-</span> <span class=n>rows</span><span class=p>)</span> <span class=o>/</span> <span class=mf>2.0</span><span class=p>)</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a>                <span class=n>h_pad_bottom</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>min_height</span> <span class=o>-</span> <span class=n>rows</span> <span class=o>-</span> <span class=n>h_pad_top</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a>            <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a>                <span class=n>h_pad_top</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a>                <span class=n>h_pad_bottom</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a>            <span class=n>pad_remained</span> <span class=o>=</span> <span class=n>rows</span> <span class=o>%</span> <span class=bp>self</span><span class=o>.</span><span class=n>pad_height_divisor</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a>            <span class=n>pad_rows</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>pad_height_divisor</span> <span class=o>-</span> <span class=n>pad_remained</span> <span class=k>if</span> <span class=n>pad_remained</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=k>else</span> <span class=mi>0</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a>            <span class=n>h_pad_top</span> <span class=o>=</span> <span class=n>pad_rows</span> <span class=o>//</span> <span class=mi>2</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a>            <span class=n>h_pad_bottom</span> <span class=o>=</span> <span class=n>pad_rows</span> <span class=o>-</span> <span class=n>h_pad_top</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>min_width</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a>            <span class=k>if</span> <span class=n>cols</span> <span class=o>&lt;</span> <span class=bp>self</span><span class=o>.</span><span class=n>min_width</span><span class=p>:</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a>                <span class=n>w_pad_left</span> <span class=o>=</span> <span class=nb>int</span><span class=p>((</span><span class=bp>self</span><span class=o>.</span><span class=n>min_width</span> <span class=o>-</span> <span class=n>cols</span><span class=p>)</span> <span class=o>/</span> <span class=mf>2.0</span><span class=p>)</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a>                <span class=n>w_pad_right</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>min_width</span> <span class=o>-</span> <span class=n>cols</span> <span class=o>-</span> <span class=n>w_pad_left</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a>            <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a>                <span class=n>w_pad_left</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a>                <span class=n>w_pad_right</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a>            <span class=n>pad_remainder</span> <span class=o>=</span> <span class=n>cols</span> <span class=o>%</span> <span class=bp>self</span><span class=o>.</span><span class=n>pad_width_divisor</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a>            <span class=n>pad_cols</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>pad_width_divisor</span> <span class=o>-</span> <span class=n>pad_remainder</span> <span class=k>if</span> <span class=n>pad_remainder</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=k>else</span> <span class=mi>0</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a>            <span class=n>w_pad_left</span> <span class=o>=</span> <span class=n>pad_cols</span> <span class=o>//</span> <span class=mi>2</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a>            <span class=n>w_pad_right</span> <span class=o>=</span> <span class=n>pad_cols</span> <span class=o>-</span> <span class=n>w_pad_left</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><a href=#__codelineno-0-152><span class=linenos data-linenos="152 "></span></a>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><a href=#__codelineno-0-153><span class=linenos data-linenos="153 "></span></a>        <span class=n>h_pad_top</span><span class=p>,</span> <span class=n>h_pad_bottom</span><span class=p>,</span> <span class=n>w_pad_left</span><span class=p>,</span> <span class=n>w_pad_right</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>__update_position_params</span><span class=p>(</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><a href=#__codelineno-0-154><span class=linenos data-linenos="154 "></span></a>            <span class=n>h_top</span><span class=o>=</span><span class=n>h_pad_top</span><span class=p>,</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><a href=#__codelineno-0-155><span class=linenos data-linenos="155 "></span></a>            <span class=n>h_bottom</span><span class=o>=</span><span class=n>h_pad_bottom</span><span class=p>,</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><a href=#__codelineno-0-156><span class=linenos data-linenos="156 "></span></a>            <span class=n>w_left</span><span class=o>=</span><span class=n>w_pad_left</span><span class=p>,</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><a href=#__codelineno-0-157><span class=linenos data-linenos="157 "></span></a>            <span class=n>w_right</span><span class=o>=</span><span class=n>w_pad_right</span><span class=p>,</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><a href=#__codelineno-0-158><span class=linenos data-linenos="158 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><a href=#__codelineno-0-159><span class=linenos data-linenos="159 "></span></a>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><a href=#__codelineno-0-160><span class=linenos data-linenos="160 "></span></a>        <span class=n>params</span><span class=o>.</span><span class=n>update</span><span class=p>(</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><a href=#__codelineno-0-161><span class=linenos data-linenos="161 "></span></a>            <span class=p>{</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><a href=#__codelineno-0-162><span class=linenos data-linenos="162 "></span></a>                <span class=s2>"pad_top"</span><span class=p>:</span> <span class=n>h_pad_top</span><span class=p>,</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><a href=#__codelineno-0-163><span class=linenos data-linenos="163 "></span></a>                <span class=s2>"pad_bottom"</span><span class=p>:</span> <span class=n>h_pad_bottom</span><span class=p>,</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><a href=#__codelineno-0-164><span class=linenos data-linenos="164 "></span></a>                <span class=s2>"pad_left"</span><span class=p>:</span> <span class=n>w_pad_left</span><span class=p>,</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><a href=#__codelineno-0-165><span class=linenos data-linenos="165 "></span></a>                <span class=s2>"pad_right"</span><span class=p>:</span> <span class=n>w_pad_right</span><span class=p>,</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><a href=#__codelineno-0-166><span class=linenos data-linenos="166 "></span></a>            <span class=p>},</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><a href=#__codelineno-0-167><span class=linenos data-linenos="167 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><a href=#__codelineno-0-168><span class=linenos data-linenos="168 "></span></a>        <span class=k>return</span> <span class=n>params</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a><a href=#__codelineno-0-169><span class=linenos data-linenos="169 "></span></a>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a><a href=#__codelineno-0-170><span class=linenos data-linenos="170 "></span></a>    <span class=k>def</span> <span class=nf>apply</span><span class=p>(</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a><a href=#__codelineno-0-171><span class=linenos data-linenos="171 "></span></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a><a href=#__codelineno-0-172><span class=linenos data-linenos="172 "></span></a>        <span class=n>img</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a><a href=#__codelineno-0-173><span class=linenos data-linenos="173 "></span></a>        <span class=n>pad_top</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a><a href=#__codelineno-0-174><span class=linenos data-linenos="174 "></span></a>        <span class=n>pad_bottom</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a><a href=#__codelineno-0-175><span class=linenos data-linenos="175 "></span></a>        <span class=n>pad_left</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a><a href=#__codelineno-0-176><span class=linenos data-linenos="176 "></span></a>        <span class=n>pad_right</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a><a href=#__codelineno-0-177><span class=linenos data-linenos="177 "></span></a>        <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>,</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a><a href=#__codelineno-0-178><span class=linenos data-linenos="178 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a><a href=#__codelineno-0-179><span class=linenos data-linenos="179 "></span></a>        <span class=k>return</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>pad_with_params</span><span class=p>(</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a><a href=#__codelineno-0-180><span class=linenos data-linenos="180 "></span></a>            <span class=n>img</span><span class=p>,</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a><a href=#__codelineno-0-181><span class=linenos data-linenos="181 "></span></a>            <span class=n>pad_top</span><span class=p>,</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a><a href=#__codelineno-0-182><span class=linenos data-linenos="182 "></span></a>            <span class=n>pad_bottom</span><span class=p>,</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a><a href=#__codelineno-0-183><span class=linenos data-linenos="183 "></span></a>            <span class=n>pad_left</span><span class=p>,</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a><a href=#__codelineno-0-184><span class=linenos data-linenos="184 "></span></a>            <span class=n>pad_right</span><span class=p>,</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a><a href=#__codelineno-0-185><span class=linenos data-linenos="185 "></span></a>            <span class=n>border_mode</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>border_mode</span><span class=p>,</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a><a href=#__codelineno-0-186><span class=linenos data-linenos="186 "></span></a>            <span class=n>value</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>value</span><span class=p>,</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a><a href=#__codelineno-0-187><span class=linenos data-linenos="187 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a><a href=#__codelineno-0-188><span class=linenos data-linenos="188 "></span></a>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a><a href=#__codelineno-0-189><span class=linenos data-linenos="189 "></span></a>    <span class=k>def</span> <span class=nf>apply_to_mask</span><span class=p>(</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a><a href=#__codelineno-0-190><span class=linenos data-linenos="190 "></span></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a><a href=#__codelineno-0-191><span class=linenos data-linenos="191 "></span></a>        <span class=n>mask</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a><a href=#__codelineno-0-192><span class=linenos data-linenos="192 "></span></a>        <span class=n>pad_top</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a><a href=#__codelineno-0-193><span class=linenos data-linenos="193 "></span></a>        <span class=n>pad_bottom</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a><a href=#__codelineno-0-194><span class=linenos data-linenos="194 "></span></a>        <span class=n>pad_left</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a><a href=#__codelineno-0-195><span class=linenos data-linenos="195 "></span></a>        <span class=n>pad_right</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a><a href=#__codelineno-0-196><span class=linenos data-linenos="196 "></span></a>        <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>,</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a><a href=#__codelineno-0-197><span class=linenos data-linenos="197 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a><a href=#__codelineno-0-198><span class=linenos data-linenos="198 "></span></a>        <span class=k>return</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>pad_with_params</span><span class=p>(</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a><a href=#__codelineno-0-199><span class=linenos data-linenos="199 "></span></a>            <span class=n>mask</span><span class=p>,</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a><a href=#__codelineno-0-200><span class=linenos data-linenos="200 "></span></a>            <span class=n>pad_top</span><span class=p>,</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a><a href=#__codelineno-0-201><span class=linenos data-linenos="201 "></span></a>            <span class=n>pad_bottom</span><span class=p>,</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a><a href=#__codelineno-0-202><span class=linenos data-linenos="202 "></span></a>            <span class=n>pad_left</span><span class=p>,</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a><a href=#__codelineno-0-203><span class=linenos data-linenos="203 "></span></a>            <span class=n>pad_right</span><span class=p>,</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a><a href=#__codelineno-0-204><span class=linenos data-linenos="204 "></span></a>            <span class=n>border_mode</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>border_mode</span><span class=p>,</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a><a href=#__codelineno-0-205><span class=linenos data-linenos="205 "></span></a>            <span class=n>value</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>mask_value</span><span class=p>,</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a><a href=#__codelineno-0-206><span class=linenos data-linenos="206 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a><a href=#__codelineno-0-207><span class=linenos data-linenos="207 "></span></a>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a><a href=#__codelineno-0-208><span class=linenos data-linenos="208 "></span></a>    <span class=k>def</span> <span class=nf>apply_to_bbox</span><span class=p>(</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a><a href=#__codelineno-0-209><span class=linenos data-linenos="209 "></span></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a><a href=#__codelineno-0-210><span class=linenos data-linenos="210 "></span></a>        <span class=n>bbox</span><span class=p>:</span> <span class=n>BoxInternalType</span><span class=p>,</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a><a href=#__codelineno-0-211><span class=linenos data-linenos="211 "></span></a>        <span class=n>pad_top</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a><a href=#__codelineno-0-212><span class=linenos data-linenos="212 "></span></a>        <span class=n>pad_bottom</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a><a href=#__codelineno-0-213><span class=linenos data-linenos="213 "></span></a>        <span class=n>pad_left</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a><a href=#__codelineno-0-214><span class=linenos data-linenos="214 "></span></a>        <span class=n>pad_right</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a><a href=#__codelineno-0-215><span class=linenos data-linenos="215 "></span></a>        <span class=n>rows</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a><a href=#__codelineno-0-216><span class=linenos data-linenos="216 "></span></a>        <span class=n>cols</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a><a href=#__codelineno-0-217><span class=linenos data-linenos="217 "></span></a>        <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>,</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a><a href=#__codelineno-0-218><span class=linenos data-linenos="218 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>BoxInternalType</span><span class=p>:</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a><a href=#__codelineno-0-219><span class=linenos data-linenos="219 "></span></a>        <span class=n>x_min</span><span class=p>,</span> <span class=n>y_min</span><span class=p>,</span> <span class=n>x_max</span><span class=p>,</span> <span class=n>y_max</span> <span class=o>=</span> <span class=n>denormalize_bbox</span><span class=p>(</span><span class=n>bbox</span><span class=p>,</span> <span class=n>rows</span><span class=p>,</span> <span class=n>cols</span><span class=p>)[:</span><span class=mi>4</span><span class=p>]</span>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a><a href=#__codelineno-0-220><span class=linenos data-linenos="220 "></span></a>        <span class=n>bbox</span> <span class=o>=</span> <span class=n>x_min</span> <span class=o>+</span> <span class=n>pad_left</span><span class=p>,</span> <span class=n>y_min</span> <span class=o>+</span> <span class=n>pad_top</span><span class=p>,</span> <span class=n>x_max</span> <span class=o>+</span> <span class=n>pad_left</span><span class=p>,</span> <span class=n>y_max</span> <span class=o>+</span> <span class=n>pad_top</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a><a href=#__codelineno-0-221><span class=linenos data-linenos="221 "></span></a>        <span class=k>return</span> <span class=n>cast</span><span class=p>(</span><span class=n>BoxInternalType</span><span class=p>,</span> <span class=n>normalize_bbox</span><span class=p>(</span><span class=n>bbox</span><span class=p>,</span> <span class=n>rows</span> <span class=o>+</span> <span class=n>pad_top</span> <span class=o>+</span> <span class=n>pad_bottom</span><span class=p>,</span> <span class=n>cols</span> <span class=o>+</span> <span class=n>pad_left</span> <span class=o>+</span> <span class=n>pad_right</span><span class=p>))</span>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a><a href=#__codelineno-0-222><span class=linenos data-linenos="222 "></span></a>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a><a href=#__codelineno-0-223><span class=linenos data-linenos="223 "></span></a>    <span class=k>def</span> <span class=nf>apply_to_keypoint</span><span class=p>(</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a><a href=#__codelineno-0-224><span class=linenos data-linenos="224 "></span></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a><a href=#__codelineno-0-225><span class=linenos data-linenos="225 "></span></a>        <span class=n>keypoint</span><span class=p>:</span> <span class=n>KeypointInternalType</span><span class=p>,</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a><a href=#__codelineno-0-226><span class=linenos data-linenos="226 "></span></a>        <span class=n>pad_top</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a><a href=#__codelineno-0-227><span class=linenos data-linenos="227 "></span></a>        <span class=n>pad_bottom</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a><a href=#__codelineno-0-228><span class=linenos data-linenos="228 "></span></a>        <span class=n>pad_left</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a><a href=#__codelineno-0-229><span class=linenos data-linenos="229 "></span></a>        <span class=n>pad_right</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a><a href=#__codelineno-0-230><span class=linenos data-linenos="230 "></span></a>        <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>,</span>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a><a href=#__codelineno-0-231><span class=linenos data-linenos="231 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>KeypointInternalType</span><span class=p>:</span>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a><a href=#__codelineno-0-232><span class=linenos data-linenos="232 "></span></a>        <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>angle</span><span class=p>,</span> <span class=n>scale</span> <span class=o>=</span> <span class=n>keypoint</span><span class=p>[:</span><span class=mi>4</span><span class=p>]</span>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a><a href=#__codelineno-0-233><span class=linenos data-linenos="233 "></span></a>        <span class=k>return</span> <span class=n>x</span> <span class=o>+</span> <span class=n>pad_left</span><span class=p>,</span> <span class=n>y</span> <span class=o>+</span> <span class=n>pad_top</span><span class=p>,</span> <span class=n>angle</span><span class=p>,</span> <span class=n>scale</span>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a><a href=#__codelineno-0-234><span class=linenos data-linenos="234 "></span></a>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a><a href=#__codelineno-0-235><span class=linenos data-linenos="235 "></span></a>    <span class=k>def</span> <span class=nf>get_transform_init_args_names</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=o>...</span><span class=p>]:</span>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a><a href=#__codelineno-0-236><span class=linenos data-linenos="236 "></span></a>        <span class=k>return</span> <span class=p>(</span>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a><a href=#__codelineno-0-237><span class=linenos data-linenos="237 "></span></a>            <span class=s2>"min_height"</span><span class=p>,</span>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a><a href=#__codelineno-0-238><span class=linenos data-linenos="238 "></span></a>            <span class=s2>"min_width"</span><span class=p>,</span>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a><a href=#__codelineno-0-239><span class=linenos data-linenos="239 "></span></a>            <span class=s2>"pad_height_divisor"</span><span class=p>,</span>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a><a href=#__codelineno-0-240><span class=linenos data-linenos="240 "></span></a>            <span class=s2>"pad_width_divisor"</span><span class=p>,</span>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a><a href=#__codelineno-0-241><span class=linenos data-linenos="241 "></span></a>            <span class=s2>"position"</span><span class=p>,</span>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a><a href=#__codelineno-0-242><span class=linenos data-linenos="242 "></span></a>            <span class=s2>"border_mode"</span><span class=p>,</span>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a><a href=#__codelineno-0-243><span class=linenos data-linenos="243 "></span></a>            <span class=s2>"value"</span><span class=p>,</span>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a><a href=#__codelineno-0-244><span class=linenos data-linenos="244 "></span></a>            <span class=s2>"mask_value"</span><span class=p>,</span>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a><a href=#__codelineno-0-245><span class=linenos data-linenos="245 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a><a href=#__codelineno-0-246><span class=linenos data-linenos="246 "></span></a>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a><a href=#__codelineno-0-247><span class=linenos data-linenos="247 "></span></a>    <span class=k>def</span> <span class=nf>__update_position_params</span><span class=p>(</span>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a><a href=#__codelineno-0-248><span class=linenos data-linenos="248 "></span></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a><a href=#__codelineno-0-249><span class=linenos data-linenos="249 "></span></a>        <span class=n>h_top</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-250><a id=__codelineno-0-250 name=__codelineno-0-250></a><a href=#__codelineno-0-250><span class=linenos data-linenos="250 "></span></a>        <span class=n>h_bottom</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a><a href=#__codelineno-0-251><span class=linenos data-linenos="251 "></span></a>        <span class=n>w_left</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a><a href=#__codelineno-0-252><span class=linenos data-linenos="252 "></span></a>        <span class=n>w_right</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a><a href=#__codelineno-0-253><span class=linenos data-linenos="253 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=nb>int</span><span class=p>,</span> <span class=nb>int</span><span class=p>,</span> <span class=nb>int</span><span class=p>]:</span>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a><a href=#__codelineno-0-254><span class=linenos data-linenos="254 "></span></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>position</span> <span class=o>==</span> <span class=n>PadIfNeeded</span><span class=o>.</span><span class=n>PositionType</span><span class=o>.</span><span class=n>TOP_LEFT</span><span class=p>:</span>
</span><span id=__span-0-255><a id=__codelineno-0-255 name=__codelineno-0-255></a><a href=#__codelineno-0-255><span class=linenos data-linenos="255 "></span></a>            <span class=n>h_bottom</span> <span class=o>+=</span> <span class=n>h_top</span>
</span><span id=__span-0-256><a id=__codelineno-0-256 name=__codelineno-0-256></a><a href=#__codelineno-0-256><span class=linenos data-linenos="256 "></span></a>            <span class=n>w_right</span> <span class=o>+=</span> <span class=n>w_left</span>
</span><span id=__span-0-257><a id=__codelineno-0-257 name=__codelineno-0-257></a><a href=#__codelineno-0-257><span class=linenos data-linenos="257 "></span></a>            <span class=n>h_top</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-258><a id=__codelineno-0-258 name=__codelineno-0-258></a><a href=#__codelineno-0-258><span class=linenos data-linenos="258 "></span></a>            <span class=n>w_left</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-259><a id=__codelineno-0-259 name=__codelineno-0-259></a><a href=#__codelineno-0-259><span class=linenos data-linenos="259 "></span></a>
</span><span id=__span-0-260><a id=__codelineno-0-260 name=__codelineno-0-260></a><a href=#__codelineno-0-260><span class=linenos data-linenos="260 "></span></a>        <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>position</span> <span class=o>==</span> <span class=n>PadIfNeeded</span><span class=o>.</span><span class=n>PositionType</span><span class=o>.</span><span class=n>TOP_RIGHT</span><span class=p>:</span>
</span><span id=__span-0-261><a id=__codelineno-0-261 name=__codelineno-0-261></a><a href=#__codelineno-0-261><span class=linenos data-linenos="261 "></span></a>            <span class=n>h_bottom</span> <span class=o>+=</span> <span class=n>h_top</span>
</span><span id=__span-0-262><a id=__codelineno-0-262 name=__codelineno-0-262></a><a href=#__codelineno-0-262><span class=linenos data-linenos="262 "></span></a>            <span class=n>w_left</span> <span class=o>+=</span> <span class=n>w_right</span>
</span><span id=__span-0-263><a id=__codelineno-0-263 name=__codelineno-0-263></a><a href=#__codelineno-0-263><span class=linenos data-linenos="263 "></span></a>            <span class=n>h_top</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-264><a id=__codelineno-0-264 name=__codelineno-0-264></a><a href=#__codelineno-0-264><span class=linenos data-linenos="264 "></span></a>            <span class=n>w_right</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-265><a id=__codelineno-0-265 name=__codelineno-0-265></a><a href=#__codelineno-0-265><span class=linenos data-linenos="265 "></span></a>
</span><span id=__span-0-266><a id=__codelineno-0-266 name=__codelineno-0-266></a><a href=#__codelineno-0-266><span class=linenos data-linenos="266 "></span></a>        <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>position</span> <span class=o>==</span> <span class=n>PadIfNeeded</span><span class=o>.</span><span class=n>PositionType</span><span class=o>.</span><span class=n>BOTTOM_LEFT</span><span class=p>:</span>
</span><span id=__span-0-267><a id=__codelineno-0-267 name=__codelineno-0-267></a><a href=#__codelineno-0-267><span class=linenos data-linenos="267 "></span></a>            <span class=n>h_top</span> <span class=o>+=</span> <span class=n>h_bottom</span>
</span><span id=__span-0-268><a id=__codelineno-0-268 name=__codelineno-0-268></a><a href=#__codelineno-0-268><span class=linenos data-linenos="268 "></span></a>            <span class=n>w_right</span> <span class=o>+=</span> <span class=n>w_left</span>
</span><span id=__span-0-269><a id=__codelineno-0-269 name=__codelineno-0-269></a><a href=#__codelineno-0-269><span class=linenos data-linenos="269 "></span></a>            <span class=n>h_bottom</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-270><a id=__codelineno-0-270 name=__codelineno-0-270></a><a href=#__codelineno-0-270><span class=linenos data-linenos="270 "></span></a>            <span class=n>w_left</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-271><a id=__codelineno-0-271 name=__codelineno-0-271></a><a href=#__codelineno-0-271><span class=linenos data-linenos="271 "></span></a>
</span><span id=__span-0-272><a id=__codelineno-0-272 name=__codelineno-0-272></a><a href=#__codelineno-0-272><span class=linenos data-linenos="272 "></span></a>        <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>position</span> <span class=o>==</span> <span class=n>PadIfNeeded</span><span class=o>.</span><span class=n>PositionType</span><span class=o>.</span><span class=n>BOTTOM_RIGHT</span><span class=p>:</span>
</span><span id=__span-0-273><a id=__codelineno-0-273 name=__codelineno-0-273></a><a href=#__codelineno-0-273><span class=linenos data-linenos="273 "></span></a>            <span class=n>h_top</span> <span class=o>+=</span> <span class=n>h_bottom</span>
</span><span id=__span-0-274><a id=__codelineno-0-274 name=__codelineno-0-274></a><a href=#__codelineno-0-274><span class=linenos data-linenos="274 "></span></a>            <span class=n>w_left</span> <span class=o>+=</span> <span class=n>w_right</span>
</span><span id=__span-0-275><a id=__codelineno-0-275 name=__codelineno-0-275></a><a href=#__codelineno-0-275><span class=linenos data-linenos="275 "></span></a>            <span class=n>h_bottom</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-276><a id=__codelineno-0-276 name=__codelineno-0-276></a><a href=#__codelineno-0-276><span class=linenos data-linenos="276 "></span></a>            <span class=n>w_right</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-277><a id=__codelineno-0-277 name=__codelineno-0-277></a><a href=#__codelineno-0-277><span class=linenos data-linenos="277 "></span></a>
</span><span id=__span-0-278><a id=__codelineno-0-278 name=__codelineno-0-278></a><a href=#__codelineno-0-278><span class=linenos data-linenos="278 "></span></a>        <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>position</span> <span class=o>==</span> <span class=n>PadIfNeeded</span><span class=o>.</span><span class=n>PositionType</span><span class=o>.</span><span class=n>RANDOM</span><span class=p>:</span>
</span><span id=__span-0-279><a id=__codelineno-0-279 name=__codelineno-0-279></a><a href=#__codelineno-0-279><span class=linenos data-linenos="279 "></span></a>            <span class=n>h_pad</span> <span class=o>=</span> <span class=n>h_top</span> <span class=o>+</span> <span class=n>h_bottom</span>
</span><span id=__span-0-280><a id=__codelineno-0-280 name=__codelineno-0-280></a><a href=#__codelineno-0-280><span class=linenos data-linenos="280 "></span></a>            <span class=n>w_pad</span> <span class=o>=</span> <span class=n>w_left</span> <span class=o>+</span> <span class=n>w_right</span>
</span><span id=__span-0-281><a id=__codelineno-0-281 name=__codelineno-0-281></a><a href=#__codelineno-0-281><span class=linenos data-linenos="281 "></span></a>            <span class=n>h_top</span> <span class=o>=</span> <span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>h_pad</span><span class=p>)</span>
</span><span id=__span-0-282><a id=__codelineno-0-282 name=__codelineno-0-282></a><a href=#__codelineno-0-282><span class=linenos data-linenos="282 "></span></a>            <span class=n>h_bottom</span> <span class=o>=</span> <span class=n>h_pad</span> <span class=o>-</span> <span class=n>h_top</span>
</span><span id=__span-0-283><a id=__codelineno-0-283 name=__codelineno-0-283></a><a href=#__codelineno-0-283><span class=linenos data-linenos="283 "></span></a>            <span class=n>w_left</span> <span class=o>=</span> <span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>w_pad</span><span class=p>)</span>
</span><span id=__span-0-284><a id=__codelineno-0-284 name=__codelineno-0-284></a><a href=#__codelineno-0-284><span class=linenos data-linenos="284 "></span></a>            <span class=n>w_right</span> <span class=o>=</span> <span class=n>w_pad</span> <span class=o>-</span> <span class=n>w_left</span>
</span><span id=__span-0-285><a id=__codelineno-0-285 name=__codelineno-0-285></a><a href=#__codelineno-0-285><span class=linenos data-linenos="285 "></span></a>
</span><span id=__span-0-286><a id=__codelineno-0-286 name=__codelineno-0-286></a><a href=#__codelineno-0-286><span class=linenos data-linenos="286 "></span></a>        <span class=k>return</span> <span class=n>h_top</span><span class=p>,</span> <span class=n>h_bottom</span><span class=p>,</span> <span class=n>w_left</span><span class=p>,</span> <span class=n>w_right</span>
</span></code></pre></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h3 class="doc doc-heading" data-toc-label=PositionType id=albumentations.augmentations.geometric.transforms.PadIfNeeded.PositionType> <code>class <strong> PositionType</strong></code> <code> </code> <a class=headerlink href=#albumentations.augmentations.geometric.transforms.PadIfNeeded.PositionType title="Permanent link">¶</a> </h3> <div class=class-signature> </div> <div class="doc doc-contents"> <p>Enumerates the types of positions for placing an object within a container.</p> <p>This Enum class is utilized to define specific anchor positions that an object can assume relative to a container. It's particularly useful in image processing, UI layout, and graphic design to specify the alignment and positioning of elements.</p> <p><strong>Attributes:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>CENTER</code></td> <td><code>str</code></td> <td><p>Specifies that the object should be placed at the center.</p></td> </tr> <tr> <td><code>TOP_LEFT</code></td> <td><code>str</code></td> <td><p>Specifies that the object should be placed at the top-left corner.</p></td> </tr> <tr> <td><code>TOP_RIGHT</code></td> <td><code>str</code></td> <td><p>Specifies that the object should be placed at the top-right corner.</p></td> </tr> <tr> <td><code>BOTTOM_LEFT</code></td> <td><code>str</code></td> <td><p>Specifies that the object should be placed at the bottom-left corner.</p></td> </tr> <tr> <td><code>BOTTOM_RIGHT</code></td> <td><code>str</code></td> <td><p>Specifies that the object should be placed at the bottom-right corner.</p></td> </tr> <tr> <td><code>RANDOM</code></td> <td><code>str</code></td> <td><p>Indicates that the object's position should be determined randomly.</p></td> </tr> </tbody> </table> <div class="admonition info"> <p class=admonition-title><strong>Interactive Tool Available!</strong></p> <p> <strong>Explore this transform visually and adjust parameters interactively using this tool:</strong> </p> <p> <a class="md-button md-button--primary" href="https://huggingface.co/spaces/qubvel-hf/albumentations-demo?transform=PositionType" target=_blank>Open Tool</a> </p> </div> <details class=quote> <summary>Source code in <code>albumentations/augmentations/geometric/transforms.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1></a><a href=#__codelineno-0-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>class</span> <span class=nc>PositionType</span><span class=p>(</span><span class=n>Enum</span><span class=p>):</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2></a><a href=#__codelineno-0-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>    </span><span class=sd>"""Enumerates the types of positions for placing an object within a container.</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3></a><a href=#__codelineno-0-3><span class=linenos data-linenos=" 3 "></span></a>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4></a><a href=#__codelineno-0-4><span class=linenos data-linenos=" 4 "></span></a><span class=sd>    This Enum class is utilized to define specific anchor positions that an object can</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5></a><a href=#__codelineno-0-5><span class=linenos data-linenos=" 5 "></span></a><span class=sd>    assume relative to a container. It's particularly useful in image processing, UI layout,</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6></a><a href=#__codelineno-0-6><span class=linenos data-linenos=" 6 "></span></a><span class=sd>    and graphic design to specify the alignment and positioning of elements.</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7></a><a href=#__codelineno-0-7><span class=linenos data-linenos=" 7 "></span></a>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8></a><a href=#__codelineno-0-8><span class=linenos data-linenos=" 8 "></span></a><span class=sd>    Attributes:</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9></a><a href=#__codelineno-0-9><span class=linenos data-linenos=" 9 "></span></a><span class=sd>        CENTER (str): Specifies that the object should be placed at the center.</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10></a><a href=#__codelineno-0-10><span class=linenos data-linenos="10 "></span></a><span class=sd>        TOP_LEFT (str): Specifies that the object should be placed at the top-left corner.</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11></a><a href=#__codelineno-0-11><span class=linenos data-linenos="11 "></span></a><span class=sd>        TOP_RIGHT (str): Specifies that the object should be placed at the top-right corner.</span>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12></a><a href=#__codelineno-0-12><span class=linenos data-linenos="12 "></span></a><span class=sd>        BOTTOM_LEFT (str): Specifies that the object should be placed at the bottom-left corner.</span>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13></a><a href=#__codelineno-0-13><span class=linenos data-linenos="13 "></span></a><span class=sd>        BOTTOM_RIGHT (str): Specifies that the object should be placed at the bottom-right corner.</span>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14></a><a href=#__codelineno-0-14><span class=linenos data-linenos="14 "></span></a><span class=sd>        RANDOM (str): Indicates that the object's position should be determined randomly.</span>
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15></a><a href=#__codelineno-0-15><span class=linenos data-linenos="15 "></span></a>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16></a><a href=#__codelineno-0-16><span class=linenos data-linenos="16 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17></a><a href=#__codelineno-0-17><span class=linenos data-linenos="17 "></span></a>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18></a><a href=#__codelineno-0-18><span class=linenos data-linenos="18 "></span></a>    <span class=n>CENTER</span> <span class=o>=</span> <span class=s2>"center"</span>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19></a><a href=#__codelineno-0-19><span class=linenos data-linenos="19 "></span></a>    <span class=n>TOP_LEFT</span> <span class=o>=</span> <span class=s2>"top_left"</span>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20></a><a href=#__codelineno-0-20><span class=linenos data-linenos="20 "></span></a>    <span class=n>TOP_RIGHT</span> <span class=o>=</span> <span class=s2>"top_right"</span>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21></a><a href=#__codelineno-0-21><span class=linenos data-linenos="21 "></span></a>    <span class=n>BOTTOM_LEFT</span> <span class=o>=</span> <span class=s2>"bottom_left"</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22></a><a href=#__codelineno-0-22><span class=linenos data-linenos="22 "></span></a>    <span class=n>BOTTOM_RIGHT</span> <span class=o>=</span> <span class=s2>"bottom_right"</span>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23></a><a href=#__codelineno-0-23><span class=linenos data-linenos="23 "></span></a>    <span class=n>RANDOM</span> <span class=o>=</span> <span class=s2>"random"</span>
</span></code></pre></div> </details> <div class="doc doc-children"> </div> </div> </div> <div class="doc doc-object doc-method"> <h3 class="doc doc-heading" id=albumentations.augmentations.geometric.transforms.PadIfNeeded.apply> <code class="highlight language-python"><span class=n>apply</span> <span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>img</span><span class=p>,</span> <span class=n>pad_top</span><span class=p>,</span> <span class=n>pad_bottom</span><span class=p>,</span> <span class=n>pad_left</span><span class=p>,</span> <span class=n>pad_right</span><span class=p>,</span> <span class=o>**</span><span class=n>params</span><span class=p>)</span></code> <a class=headerlink href=#albumentations.augmentations.geometric.transforms.PadIfNeeded.apply title="Permanent link">¶</a></h3> <div class="doc doc-contents"> <p>Apply transform on image.</p> <details class=quote> <summary>Source code in <code>albumentations/augmentations/geometric/transforms.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=k>def</span> <span class=nf>apply</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>img</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>pad_top</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>pad_bottom</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>pad_left</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>pad_right</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>    <span class=k>return</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>pad_with_params</span><span class=p>(</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a>        <span class=n>img</span><span class=p>,</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a>        <span class=n>pad_top</span><span class=p>,</span>
</span><span id=__span-0-13><a href=#__codelineno-0-13 id=__codelineno-0-13 name=__codelineno-0-13></a>        <span class=n>pad_bottom</span><span class=p>,</span>
</span><span id=__span-0-14><a href=#__codelineno-0-14 id=__codelineno-0-14 name=__codelineno-0-14></a>        <span class=n>pad_left</span><span class=p>,</span>
</span><span id=__span-0-15><a href=#__codelineno-0-15 id=__codelineno-0-15 name=__codelineno-0-15></a>        <span class=n>pad_right</span><span class=p>,</span>
</span><span id=__span-0-16><a href=#__codelineno-0-16 id=__codelineno-0-16 name=__codelineno-0-16></a>        <span class=n>border_mode</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>border_mode</span><span class=p>,</span>
</span><span id=__span-0-17><a href=#__codelineno-0-17 id=__codelineno-0-17 name=__codelineno-0-17></a>        <span class=n>value</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>value</span><span class=p>,</span>
</span><span id=__span-0-18><a href=#__codelineno-0-18 id=__codelineno-0-18 name=__codelineno-0-18></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-method"> <h3 class="doc doc-heading" id=albumentations.augmentations.geometric.transforms.PadIfNeeded.get_transform_init_args_names> <code class="highlight language-python"><span class=n>get_transform_init_args_names</span> <span class=p>(</span><span class=bp>self</span><span class=p>)</span></code> <a class=headerlink href=#albumentations.augmentations.geometric.transforms.PadIfNeeded.get_transform_init_args_names title="Permanent link">¶</a></h3> <div class="doc doc-contents"> <p>Returns names of arguments that are used in <strong>init</strong> method of the transform</p> <details class=quote> <summary>Source code in <code>albumentations/augmentations/geometric/transforms.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=k>def</span> <span class=nf>get_transform_init_args_names</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=o>...</span><span class=p>]:</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=k>return</span> <span class=p>(</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>        <span class=s2>"min_height"</span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>        <span class=s2>"min_width"</span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>        <span class=s2>"pad_height_divisor"</span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>        <span class=s2>"pad_width_divisor"</span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>        <span class=s2>"position"</span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>        <span class=s2>"border_mode"</span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>        <span class=s2>"value"</span><span class=p>,</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>        <span class=s2>"mask_value"</span><span class=p>,</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-method"> <h3 class="doc doc-heading" id=albumentations.augmentations.geometric.transforms.PadIfNeeded.update_params> <code class="highlight language-python"><span class=n>update_params</span> <span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>params</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a class=headerlink href=#albumentations.augmentations.geometric.transforms.PadIfNeeded.update_params title="Permanent link">¶</a></h3> <div class="doc doc-contents"> <p>Update parameters with transform specific params</p> <details class=quote> <summary>Source code in <code>albumentations/augmentations/geometric/transforms.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=k>def</span> <span class=nf>update_params</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>params</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>],</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>:</span> <span class=n>Any</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>params</span> <span class=o>=</span> <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>update_params</span><span class=p>(</span><span class=n>params</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>rows</span> <span class=o>=</span> <span class=n>params</span><span class=p>[</span><span class=s2>"rows"</span><span class=p>]</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>cols</span> <span class=o>=</span> <span class=n>params</span><span class=p>[</span><span class=s2>"cols"</span><span class=p>]</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>min_height</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>        <span class=k>if</span> <span class=n>rows</span> <span class=o>&lt;</span> <span class=bp>self</span><span class=o>.</span><span class=n>min_height</span><span class=p>:</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>            <span class=n>h_pad_top</span> <span class=o>=</span> <span class=nb>int</span><span class=p>((</span><span class=bp>self</span><span class=o>.</span><span class=n>min_height</span> <span class=o>-</span> <span class=n>rows</span><span class=p>)</span> <span class=o>/</span> <span class=mf>2.0</span><span class=p>)</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>            <span class=n>h_pad_bottom</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>min_height</span> <span class=o>-</span> <span class=n>rows</span> <span class=o>-</span> <span class=n>h_pad_top</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a>            <span class=n>h_pad_top</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a>            <span class=n>h_pad_bottom</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-13><a href=#__codelineno-0-13 id=__codelineno-0-13 name=__codelineno-0-13></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-14><a href=#__codelineno-0-14 id=__codelineno-0-14 name=__codelineno-0-14></a>        <span class=n>pad_remained</span> <span class=o>=</span> <span class=n>rows</span> <span class=o>%</span> <span class=bp>self</span><span class=o>.</span><span class=n>pad_height_divisor</span>
</span><span id=__span-0-15><a href=#__codelineno-0-15 id=__codelineno-0-15 name=__codelineno-0-15></a>        <span class=n>pad_rows</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>pad_height_divisor</span> <span class=o>-</span> <span class=n>pad_remained</span> <span class=k>if</span> <span class=n>pad_remained</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=k>else</span> <span class=mi>0</span>
</span><span id=__span-0-16><a href=#__codelineno-0-16 id=__codelineno-0-16 name=__codelineno-0-16></a>
</span><span id=__span-0-17><a href=#__codelineno-0-17 id=__codelineno-0-17 name=__codelineno-0-17></a>        <span class=n>h_pad_top</span> <span class=o>=</span> <span class=n>pad_rows</span> <span class=o>//</span> <span class=mi>2</span>
</span><span id=__span-0-18><a href=#__codelineno-0-18 id=__codelineno-0-18 name=__codelineno-0-18></a>        <span class=n>h_pad_bottom</span> <span class=o>=</span> <span class=n>pad_rows</span> <span class=o>-</span> <span class=n>h_pad_top</span>
</span><span id=__span-0-19><a href=#__codelineno-0-19 id=__codelineno-0-19 name=__codelineno-0-19></a>
</span><span id=__span-0-20><a href=#__codelineno-0-20 id=__codelineno-0-20 name=__codelineno-0-20></a>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>min_width</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-21><a href=#__codelineno-0-21 id=__codelineno-0-21 name=__codelineno-0-21></a>        <span class=k>if</span> <span class=n>cols</span> <span class=o>&lt;</span> <span class=bp>self</span><span class=o>.</span><span class=n>min_width</span><span class=p>:</span>
</span><span id=__span-0-22><a href=#__codelineno-0-22 id=__codelineno-0-22 name=__codelineno-0-22></a>            <span class=n>w_pad_left</span> <span class=o>=</span> <span class=nb>int</span><span class=p>((</span><span class=bp>self</span><span class=o>.</span><span class=n>min_width</span> <span class=o>-</span> <span class=n>cols</span><span class=p>)</span> <span class=o>/</span> <span class=mf>2.0</span><span class=p>)</span>
</span><span id=__span-0-23><a href=#__codelineno-0-23 id=__codelineno-0-23 name=__codelineno-0-23></a>            <span class=n>w_pad_right</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>min_width</span> <span class=o>-</span> <span class=n>cols</span> <span class=o>-</span> <span class=n>w_pad_left</span>
</span><span id=__span-0-24><a href=#__codelineno-0-24 id=__codelineno-0-24 name=__codelineno-0-24></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-25><a href=#__codelineno-0-25 id=__codelineno-0-25 name=__codelineno-0-25></a>            <span class=n>w_pad_left</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-26><a href=#__codelineno-0-26 id=__codelineno-0-26 name=__codelineno-0-26></a>            <span class=n>w_pad_right</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-27><a href=#__codelineno-0-27 id=__codelineno-0-27 name=__codelineno-0-27></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-28><a href=#__codelineno-0-28 id=__codelineno-0-28 name=__codelineno-0-28></a>        <span class=n>pad_remainder</span> <span class=o>=</span> <span class=n>cols</span> <span class=o>%</span> <span class=bp>self</span><span class=o>.</span><span class=n>pad_width_divisor</span>
</span><span id=__span-0-29><a href=#__codelineno-0-29 id=__codelineno-0-29 name=__codelineno-0-29></a>        <span class=n>pad_cols</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>pad_width_divisor</span> <span class=o>-</span> <span class=n>pad_remainder</span> <span class=k>if</span> <span class=n>pad_remainder</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=k>else</span> <span class=mi>0</span>
</span><span id=__span-0-30><a href=#__codelineno-0-30 id=__codelineno-0-30 name=__codelineno-0-30></a>
</span><span id=__span-0-31><a href=#__codelineno-0-31 id=__codelineno-0-31 name=__codelineno-0-31></a>        <span class=n>w_pad_left</span> <span class=o>=</span> <span class=n>pad_cols</span> <span class=o>//</span> <span class=mi>2</span>
</span><span id=__span-0-32><a href=#__codelineno-0-32 id=__codelineno-0-32 name=__codelineno-0-32></a>        <span class=n>w_pad_right</span> <span class=o>=</span> <span class=n>pad_cols</span> <span class=o>-</span> <span class=n>w_pad_left</span>
</span><span id=__span-0-33><a href=#__codelineno-0-33 id=__codelineno-0-33 name=__codelineno-0-33></a>
</span><span id=__span-0-34><a href=#__codelineno-0-34 id=__codelineno-0-34 name=__codelineno-0-34></a>    <span class=n>h_pad_top</span><span class=p>,</span> <span class=n>h_pad_bottom</span><span class=p>,</span> <span class=n>w_pad_left</span><span class=p>,</span> <span class=n>w_pad_right</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>__update_position_params</span><span class=p>(</span>
</span><span id=__span-0-35><a href=#__codelineno-0-35 id=__codelineno-0-35 name=__codelineno-0-35></a>        <span class=n>h_top</span><span class=o>=</span><span class=n>h_pad_top</span><span class=p>,</span>
</span><span id=__span-0-36><a href=#__codelineno-0-36 id=__codelineno-0-36 name=__codelineno-0-36></a>        <span class=n>h_bottom</span><span class=o>=</span><span class=n>h_pad_bottom</span><span class=p>,</span>
</span><span id=__span-0-37><a href=#__codelineno-0-37 id=__codelineno-0-37 name=__codelineno-0-37></a>        <span class=n>w_left</span><span class=o>=</span><span class=n>w_pad_left</span><span class=p>,</span>
</span><span id=__span-0-38><a href=#__codelineno-0-38 id=__codelineno-0-38 name=__codelineno-0-38></a>        <span class=n>w_right</span><span class=o>=</span><span class=n>w_pad_right</span><span class=p>,</span>
</span><span id=__span-0-39><a href=#__codelineno-0-39 id=__codelineno-0-39 name=__codelineno-0-39></a>    <span class=p>)</span>
</span><span id=__span-0-40><a href=#__codelineno-0-40 id=__codelineno-0-40 name=__codelineno-0-40></a>
</span><span id=__span-0-41><a href=#__codelineno-0-41 id=__codelineno-0-41 name=__codelineno-0-41></a>    <span class=n>params</span><span class=o>.</span><span class=n>update</span><span class=p>(</span>
</span><span id=__span-0-42><a href=#__codelineno-0-42 id=__codelineno-0-42 name=__codelineno-0-42></a>        <span class=p>{</span>
</span><span id=__span-0-43><a href=#__codelineno-0-43 id=__codelineno-0-43 name=__codelineno-0-43></a>            <span class=s2>"pad_top"</span><span class=p>:</span> <span class=n>h_pad_top</span><span class=p>,</span>
</span><span id=__span-0-44><a href=#__codelineno-0-44 id=__codelineno-0-44 name=__codelineno-0-44></a>            <span class=s2>"pad_bottom"</span><span class=p>:</span> <span class=n>h_pad_bottom</span><span class=p>,</span>
</span><span id=__span-0-45><a href=#__codelineno-0-45 id=__codelineno-0-45 name=__codelineno-0-45></a>            <span class=s2>"pad_left"</span><span class=p>:</span> <span class=n>w_pad_left</span><span class=p>,</span>
</span><span id=__span-0-46><a href=#__codelineno-0-46 id=__codelineno-0-46 name=__codelineno-0-46></a>            <span class=s2>"pad_right"</span><span class=p>:</span> <span class=n>w_pad_right</span><span class=p>,</span>
</span><span id=__span-0-47><a href=#__codelineno-0-47 id=__codelineno-0-47 name=__codelineno-0-47></a>        <span class=p>},</span>
</span><span id=__span-0-48><a href=#__codelineno-0-48 id=__codelineno-0-48 name=__codelineno-0-48></a>    <span class=p>)</span>
</span><span id=__span-0-49><a href=#__codelineno-0-49 id=__codelineno-0-49 name=__codelineno-0-49></a>    <span class=k>return</span> <span class=n>params</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h2 class="doc doc-heading" data-toc-label=Perspective id=albumentations.augmentations.geometric.transforms.Perspective> <code>class <strong> Perspective</strong></code> <code> (scale=(0.05, 0.1), keep_size=True, pad_mode=0, pad_val=0, mask_pad_val=0, fit_output=False, interpolation=1, always_apply=None, p=0.5) </code> <span class=doc-github-link> <a href=https://github.com/albumentations-team/albumentations/blob/main/albumentations/augmentations/geometric/transforms.py#L261 target=_blank>[view source on GitHub]</a> </span><a class=headerlink href=#albumentations.augmentations.geometric.transforms.Perspective title="Permanent link">¶</a> </h2> <div class=class-signature> </div> <div class="doc doc-contents"> <p>Perform a random four point perspective transform of the input.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>scale</code></td> <td><code>Union[float, Tuple[float, float]]</code></td> <td><p>standard deviation of the normal distributions. These are used to sample the random distances of the subimage's corners from the full image's corners. If scale is a single float value, the range will be (0, scale). Default: (0.05, 0.1).</p></td> </tr> <tr> <td><code>keep_size</code></td> <td><code>bool</code></td> <td><p>Whether to resize image back to their original size after applying the perspective transform. If set to False, the resulting images may end up having different shapes and will always be a list, never an array. Default: True</p></td> </tr> <tr> <td><code>pad_mode</code></td> <td><code>OpenCV flag</code></td> <td><p>OpenCV border mode.</p></td> </tr> <tr> <td><code>pad_val</code></td> <td><code>int, float, list of int, list of float</code></td> <td><p>padding value if border_mode is cv2.BORDER_CONSTANT. Default: 0</p></td> </tr> <tr> <td><code>mask_pad_val</code></td> <td><code>int, float, list of int, list of float</code></td> <td><p>padding value for mask if border_mode is cv2.BORDER_CONSTANT. Default: 0</p></td> </tr> <tr> <td><code>fit_output</code></td> <td><code>bool</code></td> <td><p>If True, the image plane size and position will be adjusted to still capture the whole image after perspective transformation. (Followed by image resizing if keep_size is set to True.) Otherwise, parts of the transformed image may be outside of the image plane. This setting should not be set to True when using large scale values as it could lead to very large images. Default: False</p></td> </tr> <tr> <td><code>p</code></td> <td><code>float</code></td> <td><p>probability of applying the transform. Default: 0.5.</p></td> </tr> </tbody> </table> <div class="admonition targets"> <p class=admonition-title>Targets</p> <p>image, mask, keypoints, bboxes</p> </div> <p>Image types: uint8, float32</p> <div class="admonition info"> <p class=admonition-title><strong>Interactive Tool Available!</strong></p> <p> <strong>Explore this transform visually and adjust parameters interactively using this tool:</strong> </p> <p> <a class="md-button md-button--primary" href="https://huggingface.co/spaces/qubvel-hf/albumentations-demo?transform=Perspective" target=_blank>Open Tool</a> </p> </div> <details class=quote> <summary>Source code in <code>albumentations/augmentations/geometric/transforms.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1></a><a href=#__codelineno-0-1><span class=linenos data-linenos="  1 "></span></a><span class=k>class</span> <span class=nc>Perspective</span><span class=p>(</span><span class=n>DualTransform</span><span class=p>):</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2></a><a href=#__codelineno-0-2><span class=linenos data-linenos="  2 "></span></a><span class=w>    </span><span class=sd>"""Perform a random four point perspective transform of the input.</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3></a><a href=#__codelineno-0-3><span class=linenos data-linenos="  3 "></span></a>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4></a><a href=#__codelineno-0-4><span class=linenos data-linenos="  4 "></span></a><span class=sd>    Args:</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5></a><a href=#__codelineno-0-5><span class=linenos data-linenos="  5 "></span></a><span class=sd>        scale: standard deviation of the normal distributions. These are used to sample</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6></a><a href=#__codelineno-0-6><span class=linenos data-linenos="  6 "></span></a><span class=sd>            the random distances of the subimage's corners from the full image's corners.</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7></a><a href=#__codelineno-0-7><span class=linenos data-linenos="  7 "></span></a><span class=sd>            If scale is a single float value, the range will be (0, scale). Default: (0.05, 0.1).</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8></a><a href=#__codelineno-0-8><span class=linenos data-linenos="  8 "></span></a><span class=sd>        keep_size: Whether to resize image back to their original size after applying the perspective</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9></a><a href=#__codelineno-0-9><span class=linenos data-linenos="  9 "></span></a><span class=sd>            transform. If set to False, the resulting images may end up having different shapes</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10></a><a href=#__codelineno-0-10><span class=linenos data-linenos=" 10 "></span></a><span class=sd>            and will always be a list, never an array. Default: True</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11></a><a href=#__codelineno-0-11><span class=linenos data-linenos=" 11 "></span></a><span class=sd>        pad_mode (OpenCV flag): OpenCV border mode.</span>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12></a><a href=#__codelineno-0-12><span class=linenos data-linenos=" 12 "></span></a><span class=sd>        pad_val (int, float, list of int, list of float): padding value if border_mode is cv2.BORDER_CONSTANT.</span>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13></a><a href=#__codelineno-0-13><span class=linenos data-linenos=" 13 "></span></a><span class=sd>            Default: 0</span>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14></a><a href=#__codelineno-0-14><span class=linenos data-linenos=" 14 "></span></a><span class=sd>        mask_pad_val (int, float, list of int, list of float): padding value for mask</span>
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15></a><a href=#__codelineno-0-15><span class=linenos data-linenos=" 15 "></span></a><span class=sd>            if border_mode is cv2.BORDER_CONSTANT. Default: 0</span>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16></a><a href=#__codelineno-0-16><span class=linenos data-linenos=" 16 "></span></a><span class=sd>        fit_output (bool): If True, the image plane size and position will be adjusted to still capture</span>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17></a><a href=#__codelineno-0-17><span class=linenos data-linenos=" 17 "></span></a><span class=sd>            the whole image after perspective transformation. (Followed by image resizing if keep_size is set to True.)</span>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18></a><a href=#__codelineno-0-18><span class=linenos data-linenos=" 18 "></span></a><span class=sd>            Otherwise, parts of the transformed image may be outside of the image plane.</span>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19></a><a href=#__codelineno-0-19><span class=linenos data-linenos=" 19 "></span></a><span class=sd>            This setting should not be set to True when using large scale values as it could lead to very large images.</span>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20></a><a href=#__codelineno-0-20><span class=linenos data-linenos=" 20 "></span></a><span class=sd>            Default: False</span>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21></a><a href=#__codelineno-0-21><span class=linenos data-linenos=" 21 "></span></a><span class=sd>        p (float): probability of applying the transform. Default: 0.5.</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22></a><a href=#__codelineno-0-22><span class=linenos data-linenos=" 22 "></span></a>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23></a><a href=#__codelineno-0-23><span class=linenos data-linenos=" 23 "></span></a><span class=sd>    Targets:</span>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a><a href=#__codelineno-0-24><span class=linenos data-linenos=" 24 "></span></a><span class=sd>        image, mask, keypoints, bboxes</span>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a><a href=#__codelineno-0-25><span class=linenos data-linenos=" 25 "></span></a>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a><a href=#__codelineno-0-26><span class=linenos data-linenos=" 26 "></span></a><span class=sd>    Image types:</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a><a href=#__codelineno-0-27><span class=linenos data-linenos=" 27 "></span></a><span class=sd>        uint8, float32</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a><a href=#__codelineno-0-28><span class=linenos data-linenos=" 28 "></span></a>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a><a href=#__codelineno-0-29><span class=linenos data-linenos=" 29 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a><a href=#__codelineno-0-30><span class=linenos data-linenos=" 30 "></span></a>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a><a href=#__codelineno-0-31><span class=linenos data-linenos=" 31 "></span></a>    <span class=n>_targets</span> <span class=o>=</span> <span class=p>(</span><span class=n>Targets</span><span class=o>.</span><span class=n>IMAGE</span><span class=p>,</span> <span class=n>Targets</span><span class=o>.</span><span class=n>MASK</span><span class=p>,</span> <span class=n>Targets</span><span class=o>.</span><span class=n>KEYPOINTS</span><span class=p>,</span> <span class=n>Targets</span><span class=o>.</span><span class=n>BBOXES</span><span class=p>)</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a><a href=#__codelineno-0-32><span class=linenos data-linenos=" 32 "></span></a>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a><a href=#__codelineno-0-33><span class=linenos data-linenos=" 33 "></span></a>    <span class=k>class</span> <span class=nc>InitSchema</span><span class=p>(</span><span class=n>BaseTransformInitSchema</span><span class=p>):</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a><a href=#__codelineno-0-34><span class=linenos data-linenos=" 34 "></span></a>        <span class=n>scale</span><span class=p>:</span> <span class=n>NonNegativeFloatRangeType</span> <span class=o>=</span> <span class=p>(</span><span class=mf>0.05</span><span class=p>,</span> <span class=mf>0.1</span><span class=p>)</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a><a href=#__codelineno-0-35><span class=linenos data-linenos=" 35 "></span></a>        <span class=n>keep_size</span><span class=p>:</span> <span class=n>Annotated</span><span class=p>[</span><span class=nb>bool</span><span class=p>,</span> <span class=n>Field</span><span class=p>(</span><span class=n>default</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>"Keep size after transform."</span><span class=p>)]</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a><a href=#__codelineno-0-36><span class=linenos data-linenos=" 36 "></span></a>        <span class=n>pad_mode</span><span class=p>:</span> <span class=n>BorderModeType</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>BORDER_CONSTANT</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a><a href=#__codelineno-0-37><span class=linenos data-linenos=" 37 "></span></a>        <span class=n>pad_val</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>ColorType</span><span class=p>]</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a><a href=#__codelineno-0-38><span class=linenos data-linenos=" 38 "></span></a>            <span class=n>default</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a><a href=#__codelineno-0-39><span class=linenos data-linenos=" 39 "></span></a>            <span class=n>description</span><span class=o>=</span><span class=s2>"Padding value if border_mode is cv2.BORDER_CONSTANT."</span><span class=p>,</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a><a href=#__codelineno-0-40><span class=linenos data-linenos=" 40 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a><a href=#__codelineno-0-41><span class=linenos data-linenos=" 41 "></span></a>        <span class=n>mask_pad_val</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>ColorType</span><span class=p>]</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><a href=#__codelineno-0-42><span class=linenos data-linenos=" 42 "></span></a>            <span class=n>default</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos=" 43 "></span></a>            <span class=n>description</span><span class=o>=</span><span class=s2>"Mask padding value if border_mode is cv2.BORDER_CONSTANT."</span><span class=p>,</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos=" 44 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos=" 45 "></span></a>        <span class=n>fit_output</span><span class=p>:</span> <span class=n>Annotated</span><span class=p>[</span><span class=nb>bool</span><span class=p>,</span> <span class=n>Field</span><span class=p>(</span><span class=n>default</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>"Adjust image plane to capture whole image."</span><span class=p>)]</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos=" 46 "></span></a>        <span class=n>interpolation</span><span class=p>:</span> <span class=n>InterpolationType</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_LINEAR</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos=" 47 "></span></a>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos=" 48 "></span></a>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos=" 49 "></span></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos=" 50 "></span></a>        <span class=n>scale</span><span class=p>:</span> <span class=n>ScaleFloatType</span> <span class=o>=</span> <span class=p>(</span><span class=mf>0.05</span><span class=p>,</span> <span class=mf>0.1</span><span class=p>),</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos=" 51 "></span></a>        <span class=n>keep_size</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos=" 52 "></span></a>        <span class=n>pad_mode</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>BORDER_CONSTANT</span><span class=p>,</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a>        <span class=n>pad_val</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>ColorType</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a>        <span class=n>mask_pad_val</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>ColorType</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a>        <span class=n>fit_output</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a>        <span class=n>interpolation</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_LINEAR</span><span class=p>,</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a>        <span class=n>always_apply</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>bool</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a>        <span class=n>p</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.5</span><span class=p>,</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a>    <span class=p>):</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=n>always_apply</span><span class=p>,</span> <span class=n>p</span><span class=p>)</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>scale</span> <span class=o>=</span> <span class=n>cast</span><span class=p>(</span><span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>],</span> <span class=n>scale</span><span class=p>)</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>keep_size</span> <span class=o>=</span> <span class=n>keep_size</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>pad_mode</span> <span class=o>=</span> <span class=n>pad_mode</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>pad_val</span> <span class=o>=</span> <span class=n>pad_val</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>mask_pad_val</span> <span class=o>=</span> <span class=n>mask_pad_val</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>fit_output</span> <span class=o>=</span> <span class=n>fit_output</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>interpolation</span> <span class=o>=</span> <span class=n>interpolation</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a>    <span class=k>def</span> <span class=nf>apply</span><span class=p>(</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a>        <span class=n>img</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a>        <span class=n>matrix</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a>        <span class=n>max_height</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a>        <span class=n>max_width</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a>        <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>,</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a>        <span class=k>return</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>perspective</span><span class=p>(</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a>            <span class=n>img</span><span class=p>,</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a>            <span class=n>matrix</span><span class=p>,</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a>            <span class=n>max_width</span><span class=p>,</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a>            <span class=n>max_height</span><span class=p>,</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>pad_val</span><span class=p>,</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>pad_mode</span><span class=p>,</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>keep_size</span><span class=p>,</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a>            <span class=n>params</span><span class=p>[</span><span class=s2>"interpolation"</span><span class=p>],</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a>    <span class=k>def</span> <span class=nf>apply_to_bbox</span><span class=p>(</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a>        <span class=n>bbox</span><span class=p>:</span> <span class=n>BoxInternalType</span><span class=p>,</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a>        <span class=n>matrix</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a>        <span class=n>max_height</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a>        <span class=n>max_width</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a>        <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>,</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>BoxInternalType</span><span class=p>:</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a>        <span class=k>return</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>perspective_bbox</span><span class=p>(</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a>            <span class=n>bbox</span><span class=p>,</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a>            <span class=n>params</span><span class=p>[</span><span class=s2>"rows"</span><span class=p>],</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a>            <span class=n>params</span><span class=p>[</span><span class=s2>"cols"</span><span class=p>],</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a>            <span class=n>matrix</span><span class=p>,</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a>            <span class=n>max_width</span><span class=p>,</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a>            <span class=n>max_height</span><span class=p>,</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>keep_size</span><span class=p>,</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>    <span class=k>def</span> <span class=nf>apply_to_keypoint</span><span class=p>(</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>        <span class=n>keypoint</span><span class=p>:</span> <span class=n>KeypointInternalType</span><span class=p>,</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a>        <span class=n>matrix</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a>        <span class=n>max_height</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a>        <span class=n>max_width</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a>        <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>,</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a>        <span class=k>return</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>perspective_keypoint</span><span class=p>(</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a>            <span class=n>keypoint</span><span class=p>,</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a>            <span class=n>params</span><span class=p>[</span><span class=s2>"rows"</span><span class=p>],</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a>            <span class=n>params</span><span class=p>[</span><span class=s2>"cols"</span><span class=p>],</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a>            <span class=n>matrix</span><span class=p>,</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a>            <span class=n>max_width</span><span class=p>,</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a>            <span class=n>max_height</span><span class=p>,</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>keep_size</span><span class=p>,</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a>    <span class=nd>@property</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a>    <span class=k>def</span> <span class=nf>targets_as_params</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]:</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a>        <span class=k>return</span> <span class=p>[</span><span class=s2>"image"</span><span class=p>]</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a>    <span class=k>def</span> <span class=nf>get_params_dependent_on_targets</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>params</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a>        <span class=n>height</span><span class=p>,</span> <span class=n>width</span> <span class=o>=</span> <span class=n>params</span><span class=p>[</span><span class=s2>"image"</span><span class=p>]</span><span class=o>.</span><span class=n>shape</span><span class=p>[:</span><span class=mi>2</span><span class=p>]</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a>        <span class=n>scale</span> <span class=o>=</span> <span class=n>random</span><span class=o>.</span><span class=n>uniform</span><span class=p>(</span><span class=o>*</span><span class=bp>self</span><span class=o>.</span><span class=n>scale</span><span class=p>)</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a>        <span class=n>points</span> <span class=o>=</span> <span class=n>random_utils</span><span class=o>.</span><span class=n>normal</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>scale</span><span class=p>,</span> <span class=p>[</span><span class=mi>4</span><span class=p>,</span> <span class=mi>2</span><span class=p>])</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a>        <span class=n>points</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>mod</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>points</span><span class=p>),</span> <span class=mf>0.32</span><span class=p>)</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a>        <span class=c1># top left -- no changes needed, just use jitter</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a>        <span class=c1># top right</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a>        <span class=n>points</span><span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mf>1.0</span> <span class=o>-</span> <span class=n>points</span><span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>]</span>  <span class=c1># w = 1.0 - jitter</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a>        <span class=c1># bottom right</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a>        <span class=n>points</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=mf>1.0</span> <span class=o>-</span> <span class=n>points</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span>  <span class=c1># w = 1.0 - jitt</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a>        <span class=c1># bottom left</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a>        <span class=n>points</span><span class=p>[</span><span class=mi>3</span><span class=p>,</span> <span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=mf>1.0</span> <span class=o>-</span> <span class=n>points</span><span class=p>[</span><span class=mi>3</span><span class=p>,</span> <span class=mi>1</span><span class=p>]</span>  <span class=c1># h = 1.0 - jitter</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a>        <span class=n>points</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>]</span> <span class=o>*=</span> <span class=n>width</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a>        <span class=n>points</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>]</span> <span class=o>*=</span> <span class=n>height</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a>        <span class=c1># Obtain a consistent order of the points and unpack them individually.</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a>        <span class=c1># Warning: don't just do (tl, tr, br, bl) = _order_points(...)</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a>        <span class=c1># here, because the reordered points is used further below.</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a>        <span class=n>points</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_order_points</span><span class=p>(</span><span class=n>points</span><span class=p>)</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a>        <span class=n>tl</span><span class=p>,</span> <span class=n>tr</span><span class=p>,</span> <span class=n>br</span><span class=p>,</span> <span class=n>bl</span> <span class=o>=</span> <span class=n>points</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><a href=#__codelineno-0-152><span class=linenos data-linenos="152 "></span></a>        <span class=c1># compute the width of the new image, which will be the</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><a href=#__codelineno-0-153><span class=linenos data-linenos="153 "></span></a>        <span class=c1># maximum distance between bottom-right and bottom-left</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><a href=#__codelineno-0-154><span class=linenos data-linenos="154 "></span></a>        <span class=c1># x-coordiates or the top-right and top-left x-coordinates</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><a href=#__codelineno-0-155><span class=linenos data-linenos="155 "></span></a>        <span class=n>min_width</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><a href=#__codelineno-0-156><span class=linenos data-linenos="156 "></span></a>        <span class=n>max_width</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><a href=#__codelineno-0-157><span class=linenos data-linenos="157 "></span></a>        <span class=k>while</span> <span class=n>min_width</span> <span class=ow>is</span> <span class=kc>None</span> <span class=ow>or</span> <span class=n>min_width</span> <span class=o>&lt;</span> <span class=n>TWO</span><span class=p>:</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><a href=#__codelineno-0-158><span class=linenos data-linenos="158 "></span></a>            <span class=n>width_top</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(((</span><span class=n>tr</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>-</span> <span class=n>tl</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span> <span class=o>**</span> <span class=mi>2</span><span class=p>)</span> <span class=o>+</span> <span class=p>((</span><span class=n>tr</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=n>tl</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span> <span class=o>**</span> <span class=mi>2</span><span class=p>))</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><a href=#__codelineno-0-159><span class=linenos data-linenos="159 "></span></a>            <span class=n>width_bottom</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(((</span><span class=n>br</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>-</span> <span class=n>bl</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span> <span class=o>**</span> <span class=mi>2</span><span class=p>)</span> <span class=o>+</span> <span class=p>((</span><span class=n>br</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=n>bl</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span> <span class=o>**</span> <span class=mi>2</span><span class=p>))</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><a href=#__codelineno-0-160><span class=linenos data-linenos="160 "></span></a>            <span class=n>max_width</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=nb>max</span><span class=p>(</span><span class=n>width_top</span><span class=p>,</span> <span class=n>width_bottom</span><span class=p>))</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><a href=#__codelineno-0-161><span class=linenos data-linenos="161 "></span></a>            <span class=n>min_width</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=nb>min</span><span class=p>(</span><span class=n>width_top</span><span class=p>,</span> <span class=n>width_bottom</span><span class=p>))</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><a href=#__codelineno-0-162><span class=linenos data-linenos="162 "></span></a>            <span class=k>if</span> <span class=n>min_width</span> <span class=o>&lt;</span> <span class=n>TWO</span><span class=p>:</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><a href=#__codelineno-0-163><span class=linenos data-linenos="163 "></span></a>                <span class=n>step_size</span> <span class=o>=</span> <span class=p>(</span><span class=mi>2</span> <span class=o>-</span> <span class=n>min_width</span><span class=p>)</span> <span class=o>/</span> <span class=mi>2</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><a href=#__codelineno-0-164><span class=linenos data-linenos="164 "></span></a>                <span class=n>tl</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>-=</span> <span class=n>step_size</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><a href=#__codelineno-0-165><span class=linenos data-linenos="165 "></span></a>                <span class=n>tr</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>+=</span> <span class=n>step_size</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><a href=#__codelineno-0-166><span class=linenos data-linenos="166 "></span></a>                <span class=n>bl</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>-=</span> <span class=n>step_size</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><a href=#__codelineno-0-167><span class=linenos data-linenos="167 "></span></a>                <span class=n>br</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>+=</span> <span class=n>step_size</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><a href=#__codelineno-0-168><span class=linenos data-linenos="168 "></span></a>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a><a href=#__codelineno-0-169><span class=linenos data-linenos="169 "></span></a>        <span class=c1># compute the height of the new image, which will be the maximum distance between the top-right</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a><a href=#__codelineno-0-170><span class=linenos data-linenos="170 "></span></a>        <span class=c1># and bottom-right y-coordinates or the top-left and bottom-left y-coordinates</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a><a href=#__codelineno-0-171><span class=linenos data-linenos="171 "></span></a>        <span class=n>min_height</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a><a href=#__codelineno-0-172><span class=linenos data-linenos="172 "></span></a>        <span class=n>max_height</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a><a href=#__codelineno-0-173><span class=linenos data-linenos="173 "></span></a>        <span class=k>while</span> <span class=n>min_height</span> <span class=ow>is</span> <span class=kc>None</span> <span class=ow>or</span> <span class=n>min_height</span> <span class=o>&lt;</span> <span class=n>TWO</span><span class=p>:</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a><a href=#__codelineno-0-174><span class=linenos data-linenos="174 "></span></a>            <span class=n>height_right</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(((</span><span class=n>tr</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>-</span> <span class=n>br</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span> <span class=o>**</span> <span class=mi>2</span><span class=p>)</span> <span class=o>+</span> <span class=p>((</span><span class=n>tr</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=n>br</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span> <span class=o>**</span> <span class=mi>2</span><span class=p>))</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a><a href=#__codelineno-0-175><span class=linenos data-linenos="175 "></span></a>            <span class=n>height_left</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(((</span><span class=n>tl</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>-</span> <span class=n>bl</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span> <span class=o>**</span> <span class=mi>2</span><span class=p>)</span> <span class=o>+</span> <span class=p>((</span><span class=n>tl</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=n>bl</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span> <span class=o>**</span> <span class=mi>2</span><span class=p>))</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a><a href=#__codelineno-0-176><span class=linenos data-linenos="176 "></span></a>            <span class=n>max_height</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=nb>max</span><span class=p>(</span><span class=n>height_right</span><span class=p>,</span> <span class=n>height_left</span><span class=p>))</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a><a href=#__codelineno-0-177><span class=linenos data-linenos="177 "></span></a>            <span class=n>min_height</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=nb>min</span><span class=p>(</span><span class=n>height_right</span><span class=p>,</span> <span class=n>height_left</span><span class=p>))</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a><a href=#__codelineno-0-178><span class=linenos data-linenos="178 "></span></a>            <span class=k>if</span> <span class=n>min_height</span> <span class=o>&lt;</span> <span class=n>TWO</span><span class=p>:</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a><a href=#__codelineno-0-179><span class=linenos data-linenos="179 "></span></a>                <span class=n>step_size</span> <span class=o>=</span> <span class=p>(</span><span class=mi>2</span> <span class=o>-</span> <span class=n>min_height</span><span class=p>)</span> <span class=o>/</span> <span class=mi>2</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a><a href=#__codelineno-0-180><span class=linenos data-linenos="180 "></span></a>                <span class=n>tl</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>-=</span> <span class=n>step_size</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a><a href=#__codelineno-0-181><span class=linenos data-linenos="181 "></span></a>                <span class=n>tr</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>-=</span> <span class=n>step_size</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a><a href=#__codelineno-0-182><span class=linenos data-linenos="182 "></span></a>                <span class=n>bl</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>+=</span> <span class=n>step_size</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a><a href=#__codelineno-0-183><span class=linenos data-linenos="183 "></span></a>                <span class=n>br</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>+=</span> <span class=n>step_size</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a><a href=#__codelineno-0-184><span class=linenos data-linenos="184 "></span></a>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a><a href=#__codelineno-0-185><span class=linenos data-linenos="185 "></span></a>        <span class=c1># now that we have the dimensions of the new image, construct</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a><a href=#__codelineno-0-186><span class=linenos data-linenos="186 "></span></a>        <span class=c1># the set of destination points to obtain a "birds eye view",</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a><a href=#__codelineno-0-187><span class=linenos data-linenos="187 "></span></a>        <span class=c1># (i.e. top-down view) of the image, again specifying points</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a><a href=#__codelineno-0-188><span class=linenos data-linenos="188 "></span></a>        <span class=c1># in the top-left, top-right, bottom-right, and bottom-left order</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a><a href=#__codelineno-0-189><span class=linenos data-linenos="189 "></span></a>        <span class=c1># do not use width-1 or height-1 here, as for e.g. width=3, height=2</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a><a href=#__codelineno-0-190><span class=linenos data-linenos="190 "></span></a>        <span class=c1># the bottom right coordinate is at (3.0, 2.0) and not (2.0, 1.0)</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a><a href=#__codelineno-0-191><span class=linenos data-linenos="191 "></span></a>        <span class=n>dst</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span> <span class=p>[</span><span class=n>max_width</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span> <span class=p>[</span><span class=n>max_width</span><span class=p>,</span> <span class=n>max_height</span><span class=p>],</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=n>max_height</span><span class=p>]],</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>float32</span><span class=p>)</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a><a href=#__codelineno-0-192><span class=linenos data-linenos="192 "></span></a>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a><a href=#__codelineno-0-193><span class=linenos data-linenos="193 "></span></a>        <span class=c1># compute the perspective transform matrix and then apply it</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a><a href=#__codelineno-0-194><span class=linenos data-linenos="194 "></span></a>        <span class=n>m</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>getPerspectiveTransform</span><span class=p>(</span><span class=n>points</span><span class=p>,</span> <span class=n>dst</span><span class=p>)</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a><a href=#__codelineno-0-195><span class=linenos data-linenos="195 "></span></a>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a><a href=#__codelineno-0-196><span class=linenos data-linenos="196 "></span></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>fit_output</span><span class=p>:</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a><a href=#__codelineno-0-197><span class=linenos data-linenos="197 "></span></a>            <span class=n>m</span><span class=p>,</span> <span class=n>max_width</span><span class=p>,</span> <span class=n>max_height</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_expand_transform</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=p>(</span><span class=n>height</span><span class=p>,</span> <span class=n>width</span><span class=p>))</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a><a href=#__codelineno-0-198><span class=linenos data-linenos="198 "></span></a>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a><a href=#__codelineno-0-199><span class=linenos data-linenos="199 "></span></a>        <span class=k>return</span> <span class=p>{</span><span class=s2>"matrix"</span><span class=p>:</span> <span class=n>m</span><span class=p>,</span> <span class=s2>"max_height"</span><span class=p>:</span> <span class=n>max_height</span><span class=p>,</span> <span class=s2>"max_width"</span><span class=p>:</span> <span class=n>max_width</span><span class=p>,</span> <span class=s2>"interpolation"</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>interpolation</span><span class=p>}</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a><a href=#__codelineno-0-200><span class=linenos data-linenos="200 "></span></a>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a><a href=#__codelineno-0-201><span class=linenos data-linenos="201 "></span></a>    <span class=nd>@classmethod</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a><a href=#__codelineno-0-202><span class=linenos data-linenos="202 "></span></a>    <span class=k>def</span> <span class=nf>_expand_transform</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>matrix</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>shape</span><span class=p>:</span> <span class=n>SizeType</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=nb>int</span><span class=p>,</span> <span class=nb>int</span><span class=p>]:</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a><a href=#__codelineno-0-203><span class=linenos data-linenos="203 "></span></a>        <span class=n>height</span><span class=p>,</span> <span class=n>width</span> <span class=o>=</span> <span class=n>shape</span><span class=p>[:</span><span class=mi>2</span><span class=p>]</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a><a href=#__codelineno-0-204><span class=linenos data-linenos="204 "></span></a>        <span class=c1># do not use width-1 or height-1 here, as for e.g. width=3, height=2, max_height</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a><a href=#__codelineno-0-205><span class=linenos data-linenos="205 "></span></a>        <span class=c1># the bottom right coordinate is at (3.0, 2.0) and not (2.0, 1.0)</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a><a href=#__codelineno-0-206><span class=linenos data-linenos="206 "></span></a>        <span class=n>rect</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span> <span class=p>[</span><span class=n>width</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span> <span class=p>[</span><span class=n>width</span><span class=p>,</span> <span class=n>height</span><span class=p>],</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=n>height</span><span class=p>]],</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>float32</span><span class=p>)</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a><a href=#__codelineno-0-207><span class=linenos data-linenos="207 "></span></a>        <span class=n>dst</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>perspectiveTransform</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=n>rect</span><span class=p>]),</span> <span class=n>matrix</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a><a href=#__codelineno-0-208><span class=linenos data-linenos="208 "></span></a>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a><a href=#__codelineno-0-209><span class=linenos data-linenos="209 "></span></a>        <span class=c1># get min x, y over transformed 4 points</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a><a href=#__codelineno-0-210><span class=linenos data-linenos="210 "></span></a>        <span class=c1># then modify target points by subtracting these minima  =&gt; shift to (0, 0)</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a><a href=#__codelineno-0-211><span class=linenos data-linenos="211 "></span></a>        <span class=n>dst</span> <span class=o>-=</span> <span class=n>dst</span><span class=o>.</span><span class=n>min</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>keepdims</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a><a href=#__codelineno-0-212><span class=linenos data-linenos="212 "></span></a>        <span class=n>dst</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>around</span><span class=p>(</span><span class=n>dst</span><span class=p>,</span> <span class=n>decimals</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a><a href=#__codelineno-0-213><span class=linenos data-linenos="213 "></span></a>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a><a href=#__codelineno-0-214><span class=linenos data-linenos="214 "></span></a>        <span class=n>matrix_expanded</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>getPerspectiveTransform</span><span class=p>(</span><span class=n>rect</span><span class=p>,</span> <span class=n>dst</span><span class=p>)</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a><a href=#__codelineno-0-215><span class=linenos data-linenos="215 "></span></a>        <span class=n>max_width</span><span class=p>,</span> <span class=n>max_height</span> <span class=o>=</span> <span class=n>dst</span><span class=o>.</span><span class=n>max</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a><a href=#__codelineno-0-216><span class=linenos data-linenos="216 "></span></a>        <span class=k>return</span> <span class=n>matrix_expanded</span><span class=p>,</span> <span class=nb>int</span><span class=p>(</span><span class=n>max_width</span><span class=p>),</span> <span class=nb>int</span><span class=p>(</span><span class=n>max_height</span><span class=p>)</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a><a href=#__codelineno-0-217><span class=linenos data-linenos="217 "></span></a>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a><a href=#__codelineno-0-218><span class=linenos data-linenos="218 "></span></a>    <span class=nd>@staticmethod</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a><a href=#__codelineno-0-219><span class=linenos data-linenos="219 "></span></a>    <span class=k>def</span> <span class=nf>_order_points</span><span class=p>(</span><span class=n>pts</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a><a href=#__codelineno-0-220><span class=linenos data-linenos="220 "></span></a>        <span class=n>pts</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=nb>sorted</span><span class=p>(</span><span class=n>pts</span><span class=p>,</span> <span class=n>key</span><span class=o>=</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=mi>0</span><span class=p>]))</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a><a href=#__codelineno-0-221><span class=linenos data-linenos="221 "></span></a>        <span class=n>left</span> <span class=o>=</span> <span class=n>pts</span><span class=p>[:</span><span class=mi>2</span><span class=p>]</span>  <span class=c1># points with smallest x coordinate - left points</span>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a><a href=#__codelineno-0-222><span class=linenos data-linenos="222 "></span></a>        <span class=n>right</span> <span class=o>=</span> <span class=n>pts</span><span class=p>[</span><span class=mi>2</span><span class=p>:]</span>  <span class=c1># points with greatest x coordinate - right points</span>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a><a href=#__codelineno-0-223><span class=linenos data-linenos="223 "></span></a>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a><a href=#__codelineno-0-224><span class=linenos data-linenos="224 "></span></a>        <span class=k>if</span> <span class=n>left</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=mi>1</span><span class=p>]</span> <span class=o>&lt;</span> <span class=n>left</span><span class=p>[</span><span class=mi>1</span><span class=p>][</span><span class=mi>1</span><span class=p>]:</span>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a><a href=#__codelineno-0-225><span class=linenos data-linenos="225 "></span></a>            <span class=n>tl</span><span class=p>,</span> <span class=n>bl</span> <span class=o>=</span> <span class=n>left</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a><a href=#__codelineno-0-226><span class=linenos data-linenos="226 "></span></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a><a href=#__codelineno-0-227><span class=linenos data-linenos="227 "></span></a>            <span class=n>bl</span><span class=p>,</span> <span class=n>tl</span> <span class=o>=</span> <span class=n>left</span>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a><a href=#__codelineno-0-228><span class=linenos data-linenos="228 "></span></a>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a><a href=#__codelineno-0-229><span class=linenos data-linenos="229 "></span></a>        <span class=k>if</span> <span class=n>right</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=mi>1</span><span class=p>]</span> <span class=o>&lt;</span> <span class=n>right</span><span class=p>[</span><span class=mi>1</span><span class=p>][</span><span class=mi>1</span><span class=p>]:</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a><a href=#__codelineno-0-230><span class=linenos data-linenos="230 "></span></a>            <span class=n>tr</span><span class=p>,</span> <span class=n>br</span> <span class=o>=</span> <span class=n>right</span>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a><a href=#__codelineno-0-231><span class=linenos data-linenos="231 "></span></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a><a href=#__codelineno-0-232><span class=linenos data-linenos="232 "></span></a>            <span class=n>br</span><span class=p>,</span> <span class=n>tr</span> <span class=o>=</span> <span class=n>right</span>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a><a href=#__codelineno-0-233><span class=linenos data-linenos="233 "></span></a>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a><a href=#__codelineno-0-234><span class=linenos data-linenos="234 "></span></a>        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=n>tl</span><span class=p>,</span> <span class=n>tr</span><span class=p>,</span> <span class=n>br</span><span class=p>,</span> <span class=n>bl</span><span class=p>],</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>float32</span><span class=p>)</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a><a href=#__codelineno-0-235><span class=linenos data-linenos="235 "></span></a>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a><a href=#__codelineno-0-236><span class=linenos data-linenos="236 "></span></a>    <span class=k>def</span> <span class=nf>get_transform_init_args_names</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=o>...</span><span class=p>]:</span>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a><a href=#__codelineno-0-237><span class=linenos data-linenos="237 "></span></a>        <span class=k>return</span> <span class=s2>"scale"</span><span class=p>,</span> <span class=s2>"keep_size"</span><span class=p>,</span> <span class=s2>"pad_mode"</span><span class=p>,</span> <span class=s2>"pad_val"</span><span class=p>,</span> <span class=s2>"mask_pad_val"</span><span class=p>,</span> <span class=s2>"fit_output"</span><span class=p>,</span> <span class=s2>"interpolation"</span>
</span></code></pre></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-attribute"> <h3 class="doc doc-heading" id=albumentations.augmentations.geometric.transforms.Perspective.targets_as_params> <code class="highlight language-python"><span class=n>targets_as_params</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span></code> <span class="doc doc-properties"> <small class="doc doc-property doc-property-property"><code>property</code></small> <small class="doc doc-property doc-property-readonly"><code>readonly</code></small> </span> <a class=headerlink href=#albumentations.augmentations.geometric.transforms.Perspective.targets_as_params title="Permanent link">¶</a></h3> <div class="doc doc-contents"> <p>Targets used to get params</p> </div> </div> <div class="doc doc-object doc-method"> <h3 class="doc doc-heading" id=albumentations.augmentations.geometric.transforms.Perspective.apply> <code class="highlight language-python"><span class=n>apply</span> <span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>img</span><span class=p>,</span> <span class=n>matrix</span><span class=p>,</span> <span class=n>max_height</span><span class=p>,</span> <span class=n>max_width</span><span class=p>,</span> <span class=o>**</span><span class=n>params</span><span class=p>)</span></code> <a class=headerlink href=#albumentations.augmentations.geometric.transforms.Perspective.apply title="Permanent link">¶</a></h3> <div class="doc doc-contents"> <p>Apply transform on image.</p> <details class=quote> <summary>Source code in <code>albumentations/augmentations/geometric/transforms.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=k>def</span> <span class=nf>apply</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>img</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>matrix</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>max_height</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>max_width</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>    <span class=k>return</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>perspective</span><span class=p>(</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>        <span class=n>img</span><span class=p>,</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a>        <span class=n>matrix</span><span class=p>,</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a>        <span class=n>max_width</span><span class=p>,</span>
</span><span id=__span-0-13><a href=#__codelineno-0-13 id=__codelineno-0-13 name=__codelineno-0-13></a>        <span class=n>max_height</span><span class=p>,</span>
</span><span id=__span-0-14><a href=#__codelineno-0-14 id=__codelineno-0-14 name=__codelineno-0-14></a>        <span class=bp>self</span><span class=o>.</span><span class=n>pad_val</span><span class=p>,</span>
</span><span id=__span-0-15><a href=#__codelineno-0-15 id=__codelineno-0-15 name=__codelineno-0-15></a>        <span class=bp>self</span><span class=o>.</span><span class=n>pad_mode</span><span class=p>,</span>
</span><span id=__span-0-16><a href=#__codelineno-0-16 id=__codelineno-0-16 name=__codelineno-0-16></a>        <span class=bp>self</span><span class=o>.</span><span class=n>keep_size</span><span class=p>,</span>
</span><span id=__span-0-17><a href=#__codelineno-0-17 id=__codelineno-0-17 name=__codelineno-0-17></a>        <span class=n>params</span><span class=p>[</span><span class=s2>"interpolation"</span><span class=p>],</span>
</span><span id=__span-0-18><a href=#__codelineno-0-18 id=__codelineno-0-18 name=__codelineno-0-18></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-method"> <h3 class="doc doc-heading" id=albumentations.augmentations.geometric.transforms.Perspective.get_params_dependent_on_targets> <code class="highlight language-python"><span class=n>get_params_dependent_on_targets</span> <span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>params</span><span class=p>)</span></code> <a class=headerlink href=#albumentations.augmentations.geometric.transforms.Perspective.get_params_dependent_on_targets title="Permanent link">¶</a></h3> <div class="doc doc-contents"> <p>Returns parameters dependent on targets. Dependent target is defined in <code>self.targets_as_params</code></p> <details class=quote> <summary>Source code in <code>albumentations/augmentations/geometric/transforms.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=k>def</span> <span class=nf>get_params_dependent_on_targets</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>params</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>height</span><span class=p>,</span> <span class=n>width</span> <span class=o>=</span> <span class=n>params</span><span class=p>[</span><span class=s2>"image"</span><span class=p>]</span><span class=o>.</span><span class=n>shape</span><span class=p>[:</span><span class=mi>2</span><span class=p>]</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>scale</span> <span class=o>=</span> <span class=n>random</span><span class=o>.</span><span class=n>uniform</span><span class=p>(</span><span class=o>*</span><span class=bp>self</span><span class=o>.</span><span class=n>scale</span><span class=p>)</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>points</span> <span class=o>=</span> <span class=n>random_utils</span><span class=o>.</span><span class=n>normal</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>scale</span><span class=p>,</span> <span class=p>[</span><span class=mi>4</span><span class=p>,</span> <span class=mi>2</span><span class=p>])</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>points</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>mod</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>points</span><span class=p>),</span> <span class=mf>0.32</span><span class=p>)</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=c1># top left -- no changes needed, just use jitter</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>    <span class=c1># top right</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>    <span class=n>points</span><span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mf>1.0</span> <span class=o>-</span> <span class=n>points</span><span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>]</span>  <span class=c1># w = 1.0 - jitter</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a>    <span class=c1># bottom right</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a>    <span class=n>points</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=mf>1.0</span> <span class=o>-</span> <span class=n>points</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span>  <span class=c1># w = 1.0 - jitt</span>
</span><span id=__span-0-13><a href=#__codelineno-0-13 id=__codelineno-0-13 name=__codelineno-0-13></a>    <span class=c1># bottom left</span>
</span><span id=__span-0-14><a href=#__codelineno-0-14 id=__codelineno-0-14 name=__codelineno-0-14></a>    <span class=n>points</span><span class=p>[</span><span class=mi>3</span><span class=p>,</span> <span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=mf>1.0</span> <span class=o>-</span> <span class=n>points</span><span class=p>[</span><span class=mi>3</span><span class=p>,</span> <span class=mi>1</span><span class=p>]</span>  <span class=c1># h = 1.0 - jitter</span>
</span><span id=__span-0-15><a href=#__codelineno-0-15 id=__codelineno-0-15 name=__codelineno-0-15></a>
</span><span id=__span-0-16><a href=#__codelineno-0-16 id=__codelineno-0-16 name=__codelineno-0-16></a>    <span class=n>points</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>]</span> <span class=o>*=</span> <span class=n>width</span>
</span><span id=__span-0-17><a href=#__codelineno-0-17 id=__codelineno-0-17 name=__codelineno-0-17></a>    <span class=n>points</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>]</span> <span class=o>*=</span> <span class=n>height</span>
</span><span id=__span-0-18><a href=#__codelineno-0-18 id=__codelineno-0-18 name=__codelineno-0-18></a>
</span><span id=__span-0-19><a href=#__codelineno-0-19 id=__codelineno-0-19 name=__codelineno-0-19></a>    <span class=c1># Obtain a consistent order of the points and unpack them individually.</span>
</span><span id=__span-0-20><a href=#__codelineno-0-20 id=__codelineno-0-20 name=__codelineno-0-20></a>    <span class=c1># Warning: don't just do (tl, tr, br, bl) = _order_points(...)</span>
</span><span id=__span-0-21><a href=#__codelineno-0-21 id=__codelineno-0-21 name=__codelineno-0-21></a>    <span class=c1># here, because the reordered points is used further below.</span>
</span><span id=__span-0-22><a href=#__codelineno-0-22 id=__codelineno-0-22 name=__codelineno-0-22></a>    <span class=n>points</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_order_points</span><span class=p>(</span><span class=n>points</span><span class=p>)</span>
</span><span id=__span-0-23><a href=#__codelineno-0-23 id=__codelineno-0-23 name=__codelineno-0-23></a>    <span class=n>tl</span><span class=p>,</span> <span class=n>tr</span><span class=p>,</span> <span class=n>br</span><span class=p>,</span> <span class=n>bl</span> <span class=o>=</span> <span class=n>points</span>
</span><span id=__span-0-24><a href=#__codelineno-0-24 id=__codelineno-0-24 name=__codelineno-0-24></a>
</span><span id=__span-0-25><a href=#__codelineno-0-25 id=__codelineno-0-25 name=__codelineno-0-25></a>    <span class=c1># compute the width of the new image, which will be the</span>
</span><span id=__span-0-26><a href=#__codelineno-0-26 id=__codelineno-0-26 name=__codelineno-0-26></a>    <span class=c1># maximum distance between bottom-right and bottom-left</span>
</span><span id=__span-0-27><a href=#__codelineno-0-27 id=__codelineno-0-27 name=__codelineno-0-27></a>    <span class=c1># x-coordiates or the top-right and top-left x-coordinates</span>
</span><span id=__span-0-28><a href=#__codelineno-0-28 id=__codelineno-0-28 name=__codelineno-0-28></a>    <span class=n>min_width</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-29><a href=#__codelineno-0-29 id=__codelineno-0-29 name=__codelineno-0-29></a>    <span class=n>max_width</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-30><a href=#__codelineno-0-30 id=__codelineno-0-30 name=__codelineno-0-30></a>    <span class=k>while</span> <span class=n>min_width</span> <span class=ow>is</span> <span class=kc>None</span> <span class=ow>or</span> <span class=n>min_width</span> <span class=o>&lt;</span> <span class=n>TWO</span><span class=p>:</span>
</span><span id=__span-0-31><a href=#__codelineno-0-31 id=__codelineno-0-31 name=__codelineno-0-31></a>        <span class=n>width_top</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(((</span><span class=n>tr</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>-</span> <span class=n>tl</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span> <span class=o>**</span> <span class=mi>2</span><span class=p>)</span> <span class=o>+</span> <span class=p>((</span><span class=n>tr</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=n>tl</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span> <span class=o>**</span> <span class=mi>2</span><span class=p>))</span>
</span><span id=__span-0-32><a href=#__codelineno-0-32 id=__codelineno-0-32 name=__codelineno-0-32></a>        <span class=n>width_bottom</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(((</span><span class=n>br</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>-</span> <span class=n>bl</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span> <span class=o>**</span> <span class=mi>2</span><span class=p>)</span> <span class=o>+</span> <span class=p>((</span><span class=n>br</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=n>bl</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span> <span class=o>**</span> <span class=mi>2</span><span class=p>))</span>
</span><span id=__span-0-33><a href=#__codelineno-0-33 id=__codelineno-0-33 name=__codelineno-0-33></a>        <span class=n>max_width</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=nb>max</span><span class=p>(</span><span class=n>width_top</span><span class=p>,</span> <span class=n>width_bottom</span><span class=p>))</span>
</span><span id=__span-0-34><a href=#__codelineno-0-34 id=__codelineno-0-34 name=__codelineno-0-34></a>        <span class=n>min_width</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=nb>min</span><span class=p>(</span><span class=n>width_top</span><span class=p>,</span> <span class=n>width_bottom</span><span class=p>))</span>
</span><span id=__span-0-35><a href=#__codelineno-0-35 id=__codelineno-0-35 name=__codelineno-0-35></a>        <span class=k>if</span> <span class=n>min_width</span> <span class=o>&lt;</span> <span class=n>TWO</span><span class=p>:</span>
</span><span id=__span-0-36><a href=#__codelineno-0-36 id=__codelineno-0-36 name=__codelineno-0-36></a>            <span class=n>step_size</span> <span class=o>=</span> <span class=p>(</span><span class=mi>2</span> <span class=o>-</span> <span class=n>min_width</span><span class=p>)</span> <span class=o>/</span> <span class=mi>2</span>
</span><span id=__span-0-37><a href=#__codelineno-0-37 id=__codelineno-0-37 name=__codelineno-0-37></a>            <span class=n>tl</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>-=</span> <span class=n>step_size</span>
</span><span id=__span-0-38><a href=#__codelineno-0-38 id=__codelineno-0-38 name=__codelineno-0-38></a>            <span class=n>tr</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>+=</span> <span class=n>step_size</span>
</span><span id=__span-0-39><a href=#__codelineno-0-39 id=__codelineno-0-39 name=__codelineno-0-39></a>            <span class=n>bl</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>-=</span> <span class=n>step_size</span>
</span><span id=__span-0-40><a href=#__codelineno-0-40 id=__codelineno-0-40 name=__codelineno-0-40></a>            <span class=n>br</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>+=</span> <span class=n>step_size</span>
</span><span id=__span-0-41><a href=#__codelineno-0-41 id=__codelineno-0-41 name=__codelineno-0-41></a>
</span><span id=__span-0-42><a href=#__codelineno-0-42 id=__codelineno-0-42 name=__codelineno-0-42></a>    <span class=c1># compute the height of the new image, which will be the maximum distance between the top-right</span>
</span><span id=__span-0-43><a href=#__codelineno-0-43 id=__codelineno-0-43 name=__codelineno-0-43></a>    <span class=c1># and bottom-right y-coordinates or the top-left and bottom-left y-coordinates</span>
</span><span id=__span-0-44><a href=#__codelineno-0-44 id=__codelineno-0-44 name=__codelineno-0-44></a>    <span class=n>min_height</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-45><a href=#__codelineno-0-45 id=__codelineno-0-45 name=__codelineno-0-45></a>    <span class=n>max_height</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-46><a href=#__codelineno-0-46 id=__codelineno-0-46 name=__codelineno-0-46></a>    <span class=k>while</span> <span class=n>min_height</span> <span class=ow>is</span> <span class=kc>None</span> <span class=ow>or</span> <span class=n>min_height</span> <span class=o>&lt;</span> <span class=n>TWO</span><span class=p>:</span>
</span><span id=__span-0-47><a href=#__codelineno-0-47 id=__codelineno-0-47 name=__codelineno-0-47></a>        <span class=n>height_right</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(((</span><span class=n>tr</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>-</span> <span class=n>br</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span> <span class=o>**</span> <span class=mi>2</span><span class=p>)</span> <span class=o>+</span> <span class=p>((</span><span class=n>tr</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=n>br</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span> <span class=o>**</span> <span class=mi>2</span><span class=p>))</span>
</span><span id=__span-0-48><a href=#__codelineno-0-48 id=__codelineno-0-48 name=__codelineno-0-48></a>        <span class=n>height_left</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(((</span><span class=n>tl</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>-</span> <span class=n>bl</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span> <span class=o>**</span> <span class=mi>2</span><span class=p>)</span> <span class=o>+</span> <span class=p>((</span><span class=n>tl</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=n>bl</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span> <span class=o>**</span> <span class=mi>2</span><span class=p>))</span>
</span><span id=__span-0-49><a href=#__codelineno-0-49 id=__codelineno-0-49 name=__codelineno-0-49></a>        <span class=n>max_height</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=nb>max</span><span class=p>(</span><span class=n>height_right</span><span class=p>,</span> <span class=n>height_left</span><span class=p>))</span>
</span><span id=__span-0-50><a href=#__codelineno-0-50 id=__codelineno-0-50 name=__codelineno-0-50></a>        <span class=n>min_height</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=nb>min</span><span class=p>(</span><span class=n>height_right</span><span class=p>,</span> <span class=n>height_left</span><span class=p>))</span>
</span><span id=__span-0-51><a href=#__codelineno-0-51 id=__codelineno-0-51 name=__codelineno-0-51></a>        <span class=k>if</span> <span class=n>min_height</span> <span class=o>&lt;</span> <span class=n>TWO</span><span class=p>:</span>
</span><span id=__span-0-52><a href=#__codelineno-0-52 id=__codelineno-0-52 name=__codelineno-0-52></a>            <span class=n>step_size</span> <span class=o>=</span> <span class=p>(</span><span class=mi>2</span> <span class=o>-</span> <span class=n>min_height</span><span class=p>)</span> <span class=o>/</span> <span class=mi>2</span>
</span><span id=__span-0-53><a href=#__codelineno-0-53 id=__codelineno-0-53 name=__codelineno-0-53></a>            <span class=n>tl</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>-=</span> <span class=n>step_size</span>
</span><span id=__span-0-54><a href=#__codelineno-0-54 id=__codelineno-0-54 name=__codelineno-0-54></a>            <span class=n>tr</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>-=</span> <span class=n>step_size</span>
</span><span id=__span-0-55><a href=#__codelineno-0-55 id=__codelineno-0-55 name=__codelineno-0-55></a>            <span class=n>bl</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>+=</span> <span class=n>step_size</span>
</span><span id=__span-0-56><a href=#__codelineno-0-56 id=__codelineno-0-56 name=__codelineno-0-56></a>            <span class=n>br</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>+=</span> <span class=n>step_size</span>
</span><span id=__span-0-57><a href=#__codelineno-0-57 id=__codelineno-0-57 name=__codelineno-0-57></a>
</span><span id=__span-0-58><a href=#__codelineno-0-58 id=__codelineno-0-58 name=__codelineno-0-58></a>    <span class=c1># now that we have the dimensions of the new image, construct</span>
</span><span id=__span-0-59><a href=#__codelineno-0-59 id=__codelineno-0-59 name=__codelineno-0-59></a>    <span class=c1># the set of destination points to obtain a "birds eye view",</span>
</span><span id=__span-0-60><a href=#__codelineno-0-60 id=__codelineno-0-60 name=__codelineno-0-60></a>    <span class=c1># (i.e. top-down view) of the image, again specifying points</span>
</span><span id=__span-0-61><a href=#__codelineno-0-61 id=__codelineno-0-61 name=__codelineno-0-61></a>    <span class=c1># in the top-left, top-right, bottom-right, and bottom-left order</span>
</span><span id=__span-0-62><a href=#__codelineno-0-62 id=__codelineno-0-62 name=__codelineno-0-62></a>    <span class=c1># do not use width-1 or height-1 here, as for e.g. width=3, height=2</span>
</span><span id=__span-0-63><a href=#__codelineno-0-63 id=__codelineno-0-63 name=__codelineno-0-63></a>    <span class=c1># the bottom right coordinate is at (3.0, 2.0) and not (2.0, 1.0)</span>
</span><span id=__span-0-64><a href=#__codelineno-0-64 id=__codelineno-0-64 name=__codelineno-0-64></a>    <span class=n>dst</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span> <span class=p>[</span><span class=n>max_width</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span> <span class=p>[</span><span class=n>max_width</span><span class=p>,</span> <span class=n>max_height</span><span class=p>],</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=n>max_height</span><span class=p>]],</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>float32</span><span class=p>)</span>
</span><span id=__span-0-65><a href=#__codelineno-0-65 id=__codelineno-0-65 name=__codelineno-0-65></a>
</span><span id=__span-0-66><a href=#__codelineno-0-66 id=__codelineno-0-66 name=__codelineno-0-66></a>    <span class=c1># compute the perspective transform matrix and then apply it</span>
</span><span id=__span-0-67><a href=#__codelineno-0-67 id=__codelineno-0-67 name=__codelineno-0-67></a>    <span class=n>m</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>getPerspectiveTransform</span><span class=p>(</span><span class=n>points</span><span class=p>,</span> <span class=n>dst</span><span class=p>)</span>
</span><span id=__span-0-68><a href=#__codelineno-0-68 id=__codelineno-0-68 name=__codelineno-0-68></a>
</span><span id=__span-0-69><a href=#__codelineno-0-69 id=__codelineno-0-69 name=__codelineno-0-69></a>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>fit_output</span><span class=p>:</span>
</span><span id=__span-0-70><a href=#__codelineno-0-70 id=__codelineno-0-70 name=__codelineno-0-70></a>        <span class=n>m</span><span class=p>,</span> <span class=n>max_width</span><span class=p>,</span> <span class=n>max_height</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_expand_transform</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=p>(</span><span class=n>height</span><span class=p>,</span> <span class=n>width</span><span class=p>))</span>
</span><span id=__span-0-71><a href=#__codelineno-0-71 id=__codelineno-0-71 name=__codelineno-0-71></a>
</span><span id=__span-0-72><a href=#__codelineno-0-72 id=__codelineno-0-72 name=__codelineno-0-72></a>    <span class=k>return</span> <span class=p>{</span><span class=s2>"matrix"</span><span class=p>:</span> <span class=n>m</span><span class=p>,</span> <span class=s2>"max_height"</span><span class=p>:</span> <span class=n>max_height</span><span class=p>,</span> <span class=s2>"max_width"</span><span class=p>:</span> <span class=n>max_width</span><span class=p>,</span> <span class=s2>"interpolation"</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>interpolation</span><span class=p>}</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-method"> <h3 class="doc doc-heading" id=albumentations.augmentations.geometric.transforms.Perspective.get_transform_init_args_names> <code class="highlight language-python"><span class=n>get_transform_init_args_names</span> <span class=p>(</span><span class=bp>self</span><span class=p>)</span></code> <a class=headerlink href=#albumentations.augmentations.geometric.transforms.Perspective.get_transform_init_args_names title="Permanent link">¶</a></h3> <div class="doc doc-contents"> <p>Returns names of arguments that are used in <strong>init</strong> method of the transform</p> <details class=quote> <summary>Source code in <code>albumentations/augmentations/geometric/transforms.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=k>def</span> <span class=nf>get_transform_init_args_names</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=o>...</span><span class=p>]:</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=k>return</span> <span class=s2>"scale"</span><span class=p>,</span> <span class=s2>"keep_size"</span><span class=p>,</span> <span class=s2>"pad_mode"</span><span class=p>,</span> <span class=s2>"pad_val"</span><span class=p>,</span> <span class=s2>"mask_pad_val"</span><span class=p>,</span> <span class=s2>"fit_output"</span><span class=p>,</span> <span class=s2>"interpolation"</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h2 class="doc doc-heading" data-toc-label=PiecewiseAffine id=albumentations.augmentations.geometric.transforms.PiecewiseAffine> <code>class <strong> PiecewiseAffine</strong></code> <code> (scale=(0.03, 0.05), nb_rows=4, nb_cols=4, interpolation=1, mask_interpolation=0, cval=0, cval_mask=0, mode='constant', absolute_scale=False, always_apply=None, keypoints_threshold=0.01, p=0.5) </code> <span class=doc-github-link> <a href=https://github.com/albumentations-team/albumentations/blob/main/albumentations/augmentations/geometric/transforms.py#L1083 target=_blank>[view source on GitHub]</a> </span><a class=headerlink href=#albumentations.augmentations.geometric.transforms.PiecewiseAffine title="Permanent link">¶</a> </h2> <div class=class-signature> </div> <div class="doc doc-contents"> <p>Apply affine transformations that differ between local neighborhoods. This augmentation places a regular grid of points on an image and randomly moves the neighborhood of these point around via affine transformations. This leads to local distortions.</p> <p>This is mostly a wrapper around scikit-image's <code>PiecewiseAffine</code>. See also <code>Affine</code> for a similar technique.</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>This augmenter is very slow. Try to use <code>ElasticTransformation</code> instead, which is at least 10x faster.</p> </div> <div class="admonition note"> <p class=admonition-title>Note</p> <p>For coordinate-based inputs (keypoints, bounding boxes, polygons, ...), this augmenter still has to perform an image-based augmentation, which will make it significantly slower and not fully correct for such inputs than other transforms.</p> </div> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>scale</code></td> <td><code>float, tuple of float</code></td> <td><p>Each point on the regular grid is moved around via a normal distribution. This scale factor is equivalent to the normal distribution's sigma. Note that the jitter (how far each point is moved in which direction) is multiplied by the height/width of the image if <code>absolute_scale=False</code> (default), so this scale can be the same for different sized images. Recommended values are in the range <code>0.01</code> to <code>0.05</code> (weak to strong augmentations). * If a single <code>float</code>, then that value will always be used as the scale. * If a tuple <code>(a, b)</code> of <code>float</code> s, then a random value will be uniformly sampled per image from the interval <code>[a, b]</code>.</p></td> </tr> <tr> <td><code>nb_rows</code></td> <td><code>int, tuple of int</code></td> <td><p>Number of rows of points that the regular grid should have. Must be at least <code>2</code>. For large images, you might want to pick a higher value than <code>4</code>. You might have to then adjust scale to lower values. * If a single <code>int</code>, then that value will always be used as the number of rows. * If a tuple <code>(a, b)</code>, then a value from the discrete interval <code>[a..b]</code> will be uniformly sampled per image.</p></td> </tr> <tr> <td><code>nb_cols</code></td> <td><code>int, tuple of int</code></td> <td><p>Number of columns. Analogous to <code>nb_rows</code>.</p></td> </tr> <tr> <td><code>interpolation</code></td> <td><code>int</code></td> <td><p>The order of interpolation. The order has to be in the range 0-5: - 0: Nearest-neighbor - 1: Bi-linear (default) - 2: Bi-quadratic - 3: Bi-cubic - 4: Bi-quartic - 5: Bi-quintic</p></td> </tr> <tr> <td><code>mask_interpolation</code></td> <td><code>int</code></td> <td><p>same as interpolation but for mask.</p></td> </tr> <tr> <td><code>cval</code></td> <td><code>number</code></td> <td><p>The constant value to use when filling in newly created pixels.</p></td> </tr> <tr> <td><code>cval_mask</code></td> <td><code>number</code></td> <td><p>Same as cval but only for masks.</p></td> </tr> <tr> <td><code>mode</code></td> <td><code>str</code></td> <td><p>{'constant', 'edge', 'symmetric', 'reflect', 'wrap'}, optional Points outside the boundaries of the input are filled according to the given mode. Modes match the behaviour of <code>numpy.pad</code>.</p></td> </tr> <tr> <td><code>absolute_scale</code></td> <td><code>bool</code></td> <td><p>Take <code>scale</code> as an absolute value rather than a relative value.</p></td> </tr> <tr> <td><code>keypoints_threshold</code></td> <td><code>float</code></td> <td><p>Used as threshold in conversion from distance maps to keypoints. The search for keypoints works by searching for the argmin (non-inverted) or argmax (inverted) in each channel. This parameters contains the maximum (non-inverted) or minimum (inverted) value to accept in order to view a hit as a keypoint. Use <code>None</code> to use no min/max. Default: 0.01</p></td> </tr> </tbody> </table> <div class="admonition targets"> <p class=admonition-title>Targets</p> <p>image, mask, keypoints, bboxes</p> </div> <p>Image types: uint8, float32</p> <div class="admonition info"> <p class=admonition-title><strong>Interactive Tool Available!</strong></p> <p> <strong>Explore this transform visually and adjust parameters interactively using this tool:</strong> </p> <p> <a class="md-button md-button--primary" href="https://huggingface.co/spaces/qubvel-hf/albumentations-demo?transform=PiecewiseAffine" target=_blank>Open Tool</a> </p> </div> <details class=quote> <summary>Source code in <code>albumentations/augmentations/geometric/transforms.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1></a><a href=#__codelineno-0-1><span class=linenos data-linenos="  1 "></span></a><span class=k>class</span> <span class=nc>PiecewiseAffine</span><span class=p>(</span><span class=n>DualTransform</span><span class=p>):</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2></a><a href=#__codelineno-0-2><span class=linenos data-linenos="  2 "></span></a><span class=w>    </span><span class=sd>"""Apply affine transformations that differ between local neighborhoods.</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3></a><a href=#__codelineno-0-3><span class=linenos data-linenos="  3 "></span></a><span class=sd>    This augmentation places a regular grid of points on an image and randomly moves the neighborhood of these point</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4></a><a href=#__codelineno-0-4><span class=linenos data-linenos="  4 "></span></a><span class=sd>    around via affine transformations. This leads to local distortions.</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5></a><a href=#__codelineno-0-5><span class=linenos data-linenos="  5 "></span></a>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6></a><a href=#__codelineno-0-6><span class=linenos data-linenos="  6 "></span></a><span class=sd>    This is mostly a wrapper around scikit-image's ``PiecewiseAffine``.</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7></a><a href=#__codelineno-0-7><span class=linenos data-linenos="  7 "></span></a><span class=sd>    See also ``Affine`` for a similar technique.</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8></a><a href=#__codelineno-0-8><span class=linenos data-linenos="  8 "></span></a>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9></a><a href=#__codelineno-0-9><span class=linenos data-linenos="  9 "></span></a><span class=sd>    Note:</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10></a><a href=#__codelineno-0-10><span class=linenos data-linenos=" 10 "></span></a><span class=sd>        This augmenter is very slow. Try to use ``ElasticTransformation`` instead, which is at least 10x faster.</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11></a><a href=#__codelineno-0-11><span class=linenos data-linenos=" 11 "></span></a>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12></a><a href=#__codelineno-0-12><span class=linenos data-linenos=" 12 "></span></a><span class=sd>    Note:</span>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13></a><a href=#__codelineno-0-13><span class=linenos data-linenos=" 13 "></span></a><span class=sd>        For coordinate-based inputs (keypoints, bounding boxes, polygons, ...),</span>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14></a><a href=#__codelineno-0-14><span class=linenos data-linenos=" 14 "></span></a><span class=sd>        this augmenter still has to perform an image-based augmentation,</span>
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15></a><a href=#__codelineno-0-15><span class=linenos data-linenos=" 15 "></span></a><span class=sd>        which will make it significantly slower and not fully correct for such inputs than other transforms.</span>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16></a><a href=#__codelineno-0-16><span class=linenos data-linenos=" 16 "></span></a>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17></a><a href=#__codelineno-0-17><span class=linenos data-linenos=" 17 "></span></a><span class=sd>    Args:</span>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18></a><a href=#__codelineno-0-18><span class=linenos data-linenos=" 18 "></span></a><span class=sd>        scale (float, tuple of float): Each point on the regular grid is moved around via a normal distribution.</span>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19></a><a href=#__codelineno-0-19><span class=linenos data-linenos=" 19 "></span></a><span class=sd>            This scale factor is equivalent to the normal distribution's sigma.</span>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20></a><a href=#__codelineno-0-20><span class=linenos data-linenos=" 20 "></span></a><span class=sd>            Note that the jitter (how far each point is moved in which direction) is multiplied by the height/width of</span>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21></a><a href=#__codelineno-0-21><span class=linenos data-linenos=" 21 "></span></a><span class=sd>            the image if ``absolute_scale=False`` (default), so this scale can be the same for different sized images.</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22></a><a href=#__codelineno-0-22><span class=linenos data-linenos=" 22 "></span></a><span class=sd>            Recommended values are in the range ``0.01`` to ``0.05`` (weak to strong augmentations).</span>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23></a><a href=#__codelineno-0-23><span class=linenos data-linenos=" 23 "></span></a><span class=sd>                * If a single ``float``, then that value will always be used as the scale.</span>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a><a href=#__codelineno-0-24><span class=linenos data-linenos=" 24 "></span></a><span class=sd>                * If a tuple ``(a, b)`` of ``float`` s, then a random value will</span>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a><a href=#__codelineno-0-25><span class=linenos data-linenos=" 25 "></span></a><span class=sd>                  be uniformly sampled per image from the interval ``[a, b]``.</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a><a href=#__codelineno-0-26><span class=linenos data-linenos=" 26 "></span></a><span class=sd>        nb_rows (int, tuple of int): Number of rows of points that the regular grid should have.</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a><a href=#__codelineno-0-27><span class=linenos data-linenos=" 27 "></span></a><span class=sd>            Must be at least ``2``. For large images, you might want to pick a higher value than ``4``.</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a><a href=#__codelineno-0-28><span class=linenos data-linenos=" 28 "></span></a><span class=sd>            You might have to then adjust scale to lower values.</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a><a href=#__codelineno-0-29><span class=linenos data-linenos=" 29 "></span></a><span class=sd>                * If a single ``int``, then that value will always be used as the number of rows.</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a><a href=#__codelineno-0-30><span class=linenos data-linenos=" 30 "></span></a><span class=sd>                * If a tuple ``(a, b)``, then a value from the discrete interval</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a><a href=#__codelineno-0-31><span class=linenos data-linenos=" 31 "></span></a><span class=sd>                  ``[a..b]`` will be uniformly sampled per image.</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a><a href=#__codelineno-0-32><span class=linenos data-linenos=" 32 "></span></a><span class=sd>        nb_cols (int, tuple of int): Number of columns. Analogous to `nb_rows`.</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a><a href=#__codelineno-0-33><span class=linenos data-linenos=" 33 "></span></a><span class=sd>        interpolation (int): The order of interpolation. The order has to be in the range 0-5:</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a><a href=#__codelineno-0-34><span class=linenos data-linenos=" 34 "></span></a><span class=sd>             - 0: Nearest-neighbor</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a><a href=#__codelineno-0-35><span class=linenos data-linenos=" 35 "></span></a><span class=sd>             - 1: Bi-linear (default)</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a><a href=#__codelineno-0-36><span class=linenos data-linenos=" 36 "></span></a><span class=sd>             - 2: Bi-quadratic</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a><a href=#__codelineno-0-37><span class=linenos data-linenos=" 37 "></span></a><span class=sd>             - 3: Bi-cubic</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a><a href=#__codelineno-0-38><span class=linenos data-linenos=" 38 "></span></a><span class=sd>             - 4: Bi-quartic</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a><a href=#__codelineno-0-39><span class=linenos data-linenos=" 39 "></span></a><span class=sd>             - 5: Bi-quintic</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a><a href=#__codelineno-0-40><span class=linenos data-linenos=" 40 "></span></a><span class=sd>        mask_interpolation (int): same as interpolation but for mask.</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a><a href=#__codelineno-0-41><span class=linenos data-linenos=" 41 "></span></a><span class=sd>        cval (number): The constant value to use when filling in newly created pixels.</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><a href=#__codelineno-0-42><span class=linenos data-linenos=" 42 "></span></a><span class=sd>        cval_mask (number): Same as cval but only for masks.</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos=" 43 "></span></a><span class=sd>        mode (str): {'constant', 'edge', 'symmetric', 'reflect', 'wrap'}, optional</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos=" 44 "></span></a><span class=sd>            Points outside the boundaries of the input are filled according</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos=" 45 "></span></a><span class=sd>            to the given mode.  Modes match the behaviour of `numpy.pad`.</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos=" 46 "></span></a><span class=sd>        absolute_scale (bool): Take `scale` as an absolute value rather than a relative value.</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos=" 47 "></span></a><span class=sd>        keypoints_threshold (float): Used as threshold in conversion from distance maps to keypoints.</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos=" 48 "></span></a><span class=sd>            The search for keypoints works by searching for the</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos=" 49 "></span></a><span class=sd>            argmin (non-inverted) or argmax (inverted) in each channel. This</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos=" 50 "></span></a><span class=sd>            parameters contains the maximum (non-inverted) or minimum (inverted) value to accept in order to view a hit</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos=" 51 "></span></a><span class=sd>            as a keypoint. Use ``None`` to use no min/max. Default: 0.01</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos=" 52 "></span></a>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a><span class=sd>    Targets:</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a><span class=sd>        image, mask, keypoints, bboxes</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a><span class=sd>    Image types:</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a><span class=sd>        uint8, float32</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a>    <span class=n>_targets</span> <span class=o>=</span> <span class=p>(</span><span class=n>Targets</span><span class=o>.</span><span class=n>IMAGE</span><span class=p>,</span> <span class=n>Targets</span><span class=o>.</span><span class=n>MASK</span><span class=p>,</span> <span class=n>Targets</span><span class=o>.</span><span class=n>BBOXES</span><span class=p>,</span> <span class=n>Targets</span><span class=o>.</span><span class=n>KEYPOINTS</span><span class=p>)</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a>    <span class=k>class</span> <span class=nc>InitSchema</span><span class=p>(</span><span class=n>BaseTransformInitSchema</span><span class=p>):</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a>        <span class=n>scale</span><span class=p>:</span> <span class=n>NonNegativeFloatRangeType</span> <span class=o>=</span> <span class=p>(</span><span class=mf>0.03</span><span class=p>,</span> <span class=mf>0.05</span><span class=p>)</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a>        <span class=n>nb_rows</span><span class=p>:</span> <span class=n>ScaleIntType</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=n>default</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>"Number of rows in the regular grid."</span><span class=p>)</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a>        <span class=n>nb_cols</span><span class=p>:</span> <span class=n>ScaleIntType</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=n>default</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>"Number of columns in the regular grid."</span><span class=p>)</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a>        <span class=n>interpolation</span><span class=p>:</span> <span class=n>InterpolationType</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_LINEAR</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a>        <span class=n>mask_interpolation</span><span class=p>:</span> <span class=n>InterpolationType</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_NEAREST</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a>        <span class=n>cval</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=n>default</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>"Constant value used for newly created pixels."</span><span class=p>)</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a>        <span class=n>cval_mask</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=n>default</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>"Constant value used for newly created mask pixels."</span><span class=p>)</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a>        <span class=n>mode</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>"constant"</span><span class=p>,</span> <span class=s2>"edge"</span><span class=p>,</span> <span class=s2>"symmetric"</span><span class=p>,</span> <span class=s2>"reflect"</span><span class=p>,</span> <span class=s2>"wrap"</span><span class=p>]</span> <span class=o>=</span> <span class=s2>"constant"</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a>        <span class=n>absolute_scale</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a>            <span class=n>default</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a>            <span class=n>description</span><span class=o>=</span><span class=s2>"Whether scale is an absolute value rather than relative."</span><span class=p>,</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a>        <span class=n>keypoints_threshold</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a>            <span class=n>default</span><span class=o>=</span><span class=mf>0.01</span><span class=p>,</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a>            <span class=n>description</span><span class=o>=</span><span class=s2>"Threshold for conversion from distance maps to keypoints."</span><span class=p>,</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a>        <span class=nd>@field_validator</span><span class=p>(</span><span class=s2>"nb_rows"</span><span class=p>,</span> <span class=s2>"nb_cols"</span><span class=p>)</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a>        <span class=nd>@classmethod</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a>        <span class=k>def</span> <span class=nf>process_range</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>value</span><span class=p>:</span> <span class=n>ScaleFloatType</span><span class=p>,</span> <span class=n>info</span><span class=p>:</span> <span class=n>ValidationInfo</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>]:</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a>            <span class=n>bounds</span> <span class=o>=</span> <span class=mi>2</span><span class=p>,</span> <span class=n>BIG_INTEGER</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a>            <span class=n>result</span> <span class=o>=</span> <span class=n>to_tuple</span><span class=p>(</span><span class=n>value</span><span class=p>,</span> <span class=n>value</span><span class=p>)</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a>            <span class=n>check_range</span><span class=p>(</span><span class=n>result</span><span class=p>,</span> <span class=o>*</span><span class=n>bounds</span><span class=p>,</span> <span class=n>info</span><span class=o>.</span><span class=n>field_name</span><span class=p>)</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a>            <span class=k>return</span> <span class=n>result</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a>        <span class=n>scale</span><span class=p>:</span> <span class=n>ScaleFloatType</span> <span class=o>=</span> <span class=p>(</span><span class=mf>0.03</span><span class=p>,</span> <span class=mf>0.05</span><span class=p>),</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a>        <span class=n>nb_rows</span><span class=p>:</span> <span class=n>ScaleIntType</span> <span class=o>=</span> <span class=mi>4</span><span class=p>,</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a>        <span class=n>nb_cols</span><span class=p>:</span> <span class=n>ScaleIntType</span> <span class=o>=</span> <span class=mi>4</span><span class=p>,</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a>        <span class=n>interpolation</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_LINEAR</span><span class=p>,</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a>        <span class=n>mask_interpolation</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_NEAREST</span><span class=p>,</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a>        <span class=n>cval</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a>        <span class=n>cval_mask</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a>        <span class=n>mode</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>"constant"</span><span class=p>,</span> <span class=s2>"edge"</span><span class=p>,</span> <span class=s2>"symmetric"</span><span class=p>,</span> <span class=s2>"reflect"</span><span class=p>,</span> <span class=s2>"wrap"</span><span class=p>]</span> <span class=o>=</span> <span class=s2>"constant"</span><span class=p>,</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a>        <span class=n>absolute_scale</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a>        <span class=n>always_apply</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>bool</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a>        <span class=n>keypoints_threshold</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.01</span><span class=p>,</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a>        <span class=n>p</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.5</span><span class=p>,</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a>    <span class=p>):</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=n>always_apply</span><span class=p>,</span> <span class=n>p</span><span class=p>)</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>        <span class=n>warn</span><span class=p>(</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>            <span class=s2>"This augmenter is very slow. Try to use ``ElasticTransformation`` instead, which is at least 10x faster."</span><span class=p>,</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>            <span class=n>stacklevel</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>scale</span> <span class=o>=</span> <span class=n>cast</span><span class=p>(</span><span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>],</span> <span class=n>scale</span><span class=p>)</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>nb_rows</span> <span class=o>=</span> <span class=n>cast</span><span class=p>(</span><span class=n>Tuple</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=nb>int</span><span class=p>],</span> <span class=n>nb_rows</span><span class=p>)</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>nb_cols</span> <span class=o>=</span> <span class=n>cast</span><span class=p>(</span><span class=n>Tuple</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=nb>int</span><span class=p>],</span> <span class=n>nb_cols</span><span class=p>)</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>interpolation</span> <span class=o>=</span> <span class=n>interpolation</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>mask_interpolation</span> <span class=o>=</span> <span class=n>mask_interpolation</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>cval</span> <span class=o>=</span> <span class=n>cval</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>cval_mask</span> <span class=o>=</span> <span class=n>cval_mask</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>mode</span> <span class=o>=</span> <span class=n>mode</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>absolute_scale</span> <span class=o>=</span> <span class=n>absolute_scale</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>keypoints_threshold</span> <span class=o>=</span> <span class=n>keypoints_threshold</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a>    <span class=k>def</span> <span class=nf>get_transform_init_args_names</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=o>...</span><span class=p>]:</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a>        <span class=k>return</span> <span class=p>(</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a>            <span class=s2>"scale"</span><span class=p>,</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a>            <span class=s2>"nb_rows"</span><span class=p>,</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a>            <span class=s2>"nb_cols"</span><span class=p>,</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a>            <span class=s2>"interpolation"</span><span class=p>,</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a>            <span class=s2>"mask_interpolation"</span><span class=p>,</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a>            <span class=s2>"cval"</span><span class=p>,</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a>            <span class=s2>"cval_mask"</span><span class=p>,</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a>            <span class=s2>"mode"</span><span class=p>,</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a>            <span class=s2>"absolute_scale"</span><span class=p>,</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a>            <span class=s2>"keypoints_threshold"</span><span class=p>,</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a>    <span class=nd>@property</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a>    <span class=k>def</span> <span class=nf>targets_as_params</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]:</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a>        <span class=k>return</span> <span class=p>[</span><span class=s2>"image"</span><span class=p>]</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a>    <span class=k>def</span> <span class=nf>get_params_dependent_on_targets</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>params</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a>        <span class=n>height</span><span class=p>,</span> <span class=n>width</span> <span class=o>=</span> <span class=n>params</span><span class=p>[</span><span class=s2>"image"</span><span class=p>]</span><span class=o>.</span><span class=n>shape</span><span class=p>[:</span><span class=mi>2</span><span class=p>]</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a>        <span class=n>nb_rows</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>clip</span><span class=p>(</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=o>*</span><span class=bp>self</span><span class=o>.</span><span class=n>nb_rows</span><span class=p>),</span> <span class=mi>2</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a>        <span class=n>nb_cols</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>clip</span><span class=p>(</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=o>*</span><span class=bp>self</span><span class=o>.</span><span class=n>nb_cols</span><span class=p>),</span> <span class=mi>2</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a>        <span class=n>nb_cells</span> <span class=o>=</span> <span class=n>nb_cols</span> <span class=o>*</span> <span class=n>nb_rows</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a>        <span class=n>scale</span> <span class=o>=</span> <span class=n>random</span><span class=o>.</span><span class=n>uniform</span><span class=p>(</span><span class=o>*</span><span class=bp>self</span><span class=o>.</span><span class=n>scale</span><span class=p>)</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a>        <span class=n>jitter</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span> <span class=o>=</span> <span class=n>random_utils</span><span class=o>.</span><span class=n>normal</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>scale</span><span class=p>,</span> <span class=p>(</span><span class=n>nb_cells</span><span class=p>,</span> <span class=mi>2</span><span class=p>))</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>np</span><span class=o>.</span><span class=n>any</span><span class=p>(</span><span class=n>jitter</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>):</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a>            <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>10</span><span class=p>):</span>  <span class=c1># See: https://github.com/albumentations-team/albumentations/issues/1442</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a>                <span class=n>jitter</span> <span class=o>=</span> <span class=n>random_utils</span><span class=o>.</span><span class=n>normal</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>scale</span><span class=p>,</span> <span class=p>(</span><span class=n>nb_cells</span><span class=p>,</span> <span class=mi>2</span><span class=p>))</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><a href=#__codelineno-0-152><span class=linenos data-linenos="152 "></span></a>                <span class=k>if</span> <span class=n>np</span><span class=o>.</span><span class=n>any</span><span class=p>(</span><span class=n>jitter</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>):</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><a href=#__codelineno-0-153><span class=linenos data-linenos="153 "></span></a>                    <span class=k>break</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><a href=#__codelineno-0-154><span class=linenos data-linenos="154 "></span></a>            <span class=k>if</span> <span class=ow>not</span> <span class=n>np</span><span class=o>.</span><span class=n>any</span><span class=p>(</span><span class=n>jitter</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>):</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><a href=#__codelineno-0-155><span class=linenos data-linenos="155 "></span></a>                <span class=k>return</span> <span class=p>{</span><span class=s2>"matrix"</span><span class=p>:</span> <span class=kc>None</span><span class=p>}</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><a href=#__codelineno-0-156><span class=linenos data-linenos="156 "></span></a>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><a href=#__codelineno-0-157><span class=linenos data-linenos="157 "></span></a>        <span class=n>y</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>height</span><span class=p>,</span> <span class=n>nb_rows</span><span class=p>)</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><a href=#__codelineno-0-158><span class=linenos data-linenos="158 "></span></a>        <span class=n>x</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>width</span><span class=p>,</span> <span class=n>nb_cols</span><span class=p>)</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><a href=#__codelineno-0-159><span class=linenos data-linenos="159 "></span></a>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><a href=#__codelineno-0-160><span class=linenos data-linenos="160 "></span></a>        <span class=c1># (H, W) and (H, W) for H=rows, W=cols</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><a href=#__codelineno-0-161><span class=linenos data-linenos="161 "></span></a>        <span class=n>xx_src</span><span class=p>,</span> <span class=n>yy_src</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>meshgrid</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><a href=#__codelineno-0-162><span class=linenos data-linenos="162 "></span></a>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><a href=#__codelineno-0-163><span class=linenos data-linenos="163 "></span></a>        <span class=c1># (1, HW, 2) =&gt; (HW, 2) for H=rows, W=cols</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><a href=#__codelineno-0-164><span class=linenos data-linenos="164 "></span></a>        <span class=n>points_src</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>dstack</span><span class=p>([</span><span class=n>yy_src</span><span class=o>.</span><span class=n>flat</span><span class=p>,</span> <span class=n>xx_src</span><span class=o>.</span><span class=n>flat</span><span class=p>])[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><a href=#__codelineno-0-165><span class=linenos data-linenos="165 "></span></a>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><a href=#__codelineno-0-166><span class=linenos data-linenos="166 "></span></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>absolute_scale</span><span class=p>:</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><a href=#__codelineno-0-167><span class=linenos data-linenos="167 "></span></a>            <span class=n>jitter</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=n>jitter</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>]</span> <span class=o>/</span> <span class=n>height</span> <span class=k>if</span> <span class=n>height</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=k>else</span> <span class=mf>0.0</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><a href=#__codelineno-0-168><span class=linenos data-linenos="168 "></span></a>            <span class=n>jitter</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>jitter</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>]</span> <span class=o>/</span> <span class=n>width</span> <span class=k>if</span> <span class=n>width</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=k>else</span> <span class=mf>0.0</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a><a href=#__codelineno-0-169><span class=linenos data-linenos="169 "></span></a>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a><a href=#__codelineno-0-170><span class=linenos data-linenos="170 "></span></a>        <span class=n>jitter</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=n>jitter</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>]</span> <span class=o>*</span> <span class=n>height</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a><a href=#__codelineno-0-171><span class=linenos data-linenos="171 "></span></a>        <span class=n>jitter</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>jitter</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>]</span> <span class=o>*</span> <span class=n>width</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a><a href=#__codelineno-0-172><span class=linenos data-linenos="172 "></span></a>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a><a href=#__codelineno-0-173><span class=linenos data-linenos="173 "></span></a>        <span class=n>points_dest</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>copy</span><span class=p>(</span><span class=n>points_src</span><span class=p>)</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a><a href=#__codelineno-0-174><span class=linenos data-linenos="174 "></span></a>        <span class=n>points_dest</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=n>points_dest</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>]</span> <span class=o>+</span> <span class=n>jitter</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>]</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a><a href=#__codelineno-0-175><span class=linenos data-linenos="175 "></span></a>        <span class=n>points_dest</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>points_dest</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=n>jitter</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>]</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a><a href=#__codelineno-0-176><span class=linenos data-linenos="176 "></span></a>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a><a href=#__codelineno-0-177><span class=linenos data-linenos="177 "></span></a>        <span class=c1># Restrict all destination points to be inside the image plane.</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a><a href=#__codelineno-0-178><span class=linenos data-linenos="178 "></span></a>        <span class=c1># This is necessary, as otherwise keypoints could be augmented</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a><a href=#__codelineno-0-179><span class=linenos data-linenos="179 "></span></a>        <span class=c1># outside of the image plane and these would be replaced by</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a><a href=#__codelineno-0-180><span class=linenos data-linenos="180 "></span></a>        <span class=c1># (-1, -1), which would not conform with the behaviour of the other augmenters.</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a><a href=#__codelineno-0-181><span class=linenos data-linenos="181 "></span></a>        <span class=n>points_dest</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>clip</span><span class=p>(</span><span class=n>points_dest</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>],</span> <span class=mi>0</span><span class=p>,</span> <span class=n>height</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a><a href=#__codelineno-0-182><span class=linenos data-linenos="182 "></span></a>        <span class=n>points_dest</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>clip</span><span class=p>(</span><span class=n>points_dest</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>],</span> <span class=mi>0</span><span class=p>,</span> <span class=n>width</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a><a href=#__codelineno-0-183><span class=linenos data-linenos="183 "></span></a>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a><a href=#__codelineno-0-184><span class=linenos data-linenos="184 "></span></a>        <span class=n>matrix</span> <span class=o>=</span> <span class=n>skimage</span><span class=o>.</span><span class=n>transform</span><span class=o>.</span><span class=n>PiecewiseAffineTransform</span><span class=p>()</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a><a href=#__codelineno-0-185><span class=linenos data-linenos="185 "></span></a>        <span class=n>matrix</span><span class=o>.</span><span class=n>estimate</span><span class=p>(</span><span class=n>points_src</span><span class=p>[:,</span> <span class=p>::</span><span class=o>-</span><span class=mi>1</span><span class=p>],</span> <span class=n>points_dest</span><span class=p>[:,</span> <span class=p>::</span><span class=o>-</span><span class=mi>1</span><span class=p>])</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a><a href=#__codelineno-0-186><span class=linenos data-linenos="186 "></span></a>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a><a href=#__codelineno-0-187><span class=linenos data-linenos="187 "></span></a>        <span class=k>return</span> <span class=p>{</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a><a href=#__codelineno-0-188><span class=linenos data-linenos="188 "></span></a>            <span class=s2>"matrix"</span><span class=p>:</span> <span class=n>matrix</span><span class=p>,</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a><a href=#__codelineno-0-189><span class=linenos data-linenos="189 "></span></a>        <span class=p>}</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a><a href=#__codelineno-0-190><span class=linenos data-linenos="190 "></span></a>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a><a href=#__codelineno-0-191><span class=linenos data-linenos="191 "></span></a>    <span class=k>def</span> <span class=nf>apply</span><span class=p>(</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a><a href=#__codelineno-0-192><span class=linenos data-linenos="192 "></span></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a><a href=#__codelineno-0-193><span class=linenos data-linenos="193 "></span></a>        <span class=n>img</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a><a href=#__codelineno-0-194><span class=linenos data-linenos="194 "></span></a>        <span class=n>matrix</span><span class=p>:</span> <span class=n>skimage</span><span class=o>.</span><span class=n>transform</span><span class=o>.</span><span class=n>PiecewiseAffineTransform</span><span class=p>,</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a><a href=#__codelineno-0-195><span class=linenos data-linenos="195 "></span></a>        <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>,</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a><a href=#__codelineno-0-196><span class=linenos data-linenos="196 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a><a href=#__codelineno-0-197><span class=linenos data-linenos="197 "></span></a>        <span class=k>return</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>piecewise_affine</span><span class=p>(</span><span class=n>img</span><span class=p>,</span> <span class=n>matrix</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>interpolation</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>mode</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>cval</span><span class=p>)</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a><a href=#__codelineno-0-198><span class=linenos data-linenos="198 "></span></a>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a><a href=#__codelineno-0-199><span class=linenos data-linenos="199 "></span></a>    <span class=k>def</span> <span class=nf>apply_to_mask</span><span class=p>(</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a><a href=#__codelineno-0-200><span class=linenos data-linenos="200 "></span></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a><a href=#__codelineno-0-201><span class=linenos data-linenos="201 "></span></a>        <span class=n>mask</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a><a href=#__codelineno-0-202><span class=linenos data-linenos="202 "></span></a>        <span class=n>matrix</span><span class=p>:</span> <span class=n>skimage</span><span class=o>.</span><span class=n>transform</span><span class=o>.</span><span class=n>PiecewiseAffineTransform</span><span class=p>,</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a><a href=#__codelineno-0-203><span class=linenos data-linenos="203 "></span></a>        <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>,</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a><a href=#__codelineno-0-204><span class=linenos data-linenos="204 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a><a href=#__codelineno-0-205><span class=linenos data-linenos="205 "></span></a>        <span class=k>return</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>piecewise_affine</span><span class=p>(</span><span class=n>mask</span><span class=p>,</span> <span class=n>matrix</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>mask_interpolation</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>mode</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>cval_mask</span><span class=p>)</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a><a href=#__codelineno-0-206><span class=linenos data-linenos="206 "></span></a>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a><a href=#__codelineno-0-207><span class=linenos data-linenos="207 "></span></a>    <span class=k>def</span> <span class=nf>apply_to_bbox</span><span class=p>(</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a><a href=#__codelineno-0-208><span class=linenos data-linenos="208 "></span></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a><a href=#__codelineno-0-209><span class=linenos data-linenos="209 "></span></a>        <span class=n>bbox</span><span class=p>:</span> <span class=n>BoxInternalType</span><span class=p>,</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a><a href=#__codelineno-0-210><span class=linenos data-linenos="210 "></span></a>        <span class=n>rows</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a><a href=#__codelineno-0-211><span class=linenos data-linenos="211 "></span></a>        <span class=n>cols</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a><a href=#__codelineno-0-212><span class=linenos data-linenos="212 "></span></a>        <span class=n>matrix</span><span class=p>:</span> <span class=n>skimage</span><span class=o>.</span><span class=n>transform</span><span class=o>.</span><span class=n>PiecewiseAffineTransform</span><span class=p>,</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a><a href=#__codelineno-0-213><span class=linenos data-linenos="213 "></span></a>        <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>,</span>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a><a href=#__codelineno-0-214><span class=linenos data-linenos="214 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>BoxInternalType</span><span class=p>:</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a><a href=#__codelineno-0-215><span class=linenos data-linenos="215 "></span></a>        <span class=k>return</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>bbox_piecewise_affine</span><span class=p>(</span><span class=n>bbox</span><span class=p>,</span> <span class=n>matrix</span><span class=p>,</span> <span class=n>rows</span><span class=p>,</span> <span class=n>cols</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>keypoints_threshold</span><span class=p>)</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a><a href=#__codelineno-0-216><span class=linenos data-linenos="216 "></span></a>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a><a href=#__codelineno-0-217><span class=linenos data-linenos="217 "></span></a>    <span class=k>def</span> <span class=nf>apply_to_keypoint</span><span class=p>(</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a><a href=#__codelineno-0-218><span class=linenos data-linenos="218 "></span></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a><a href=#__codelineno-0-219><span class=linenos data-linenos="219 "></span></a>        <span class=n>keypoint</span><span class=p>:</span> <span class=n>KeypointInternalType</span><span class=p>,</span>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a><a href=#__codelineno-0-220><span class=linenos data-linenos="220 "></span></a>        <span class=n>rows</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a><a href=#__codelineno-0-221><span class=linenos data-linenos="221 "></span></a>        <span class=n>cols</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a><a href=#__codelineno-0-222><span class=linenos data-linenos="222 "></span></a>        <span class=n>matrix</span><span class=p>:</span> <span class=n>skimage</span><span class=o>.</span><span class=n>transform</span><span class=o>.</span><span class=n>PiecewiseAffineTransform</span><span class=p>,</span>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a><a href=#__codelineno-0-223><span class=linenos data-linenos="223 "></span></a>        <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>,</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a><a href=#__codelineno-0-224><span class=linenos data-linenos="224 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>KeypointInternalType</span><span class=p>:</span>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a><a href=#__codelineno-0-225><span class=linenos data-linenos="225 "></span></a>        <span class=k>return</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>keypoint_piecewise_affine</span><span class=p>(</span><span class=n>keypoint</span><span class=p>,</span> <span class=n>matrix</span><span class=p>,</span> <span class=n>rows</span><span class=p>,</span> <span class=n>cols</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>keypoints_threshold</span><span class=p>)</span>
</span></code></pre></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-attribute"> <h3 class="doc doc-heading" id=albumentations.augmentations.geometric.transforms.PiecewiseAffine.targets_as_params> <code class="highlight language-python"><span class=n>targets_as_params</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span></code> <span class="doc doc-properties"> <small class="doc doc-property doc-property-property"><code>property</code></small> <small class="doc doc-property doc-property-readonly"><code>readonly</code></small> </span> <a class=headerlink href=#albumentations.augmentations.geometric.transforms.PiecewiseAffine.targets_as_params title="Permanent link">¶</a></h3> <div class="doc doc-contents"> <p>Targets used to get params</p> </div> </div> <div class="doc doc-object doc-method"> <h3 class="doc doc-heading" id=albumentations.augmentations.geometric.transforms.PiecewiseAffine.apply> <code class="highlight language-python"><span class=n>apply</span> <span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>img</span><span class=p>,</span> <span class=n>matrix</span><span class=p>,</span> <span class=o>**</span><span class=n>params</span><span class=p>)</span></code> <a class=headerlink href=#albumentations.augmentations.geometric.transforms.PiecewiseAffine.apply title="Permanent link">¶</a></h3> <div class="doc doc-contents"> <p>Apply transform on image.</p> <details class=quote> <summary>Source code in <code>albumentations/augmentations/geometric/transforms.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=k>def</span> <span class=nf>apply</span><span class=p>(</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>img</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>matrix</span><span class=p>:</span> <span class=n>skimage</span><span class=o>.</span><span class=n>transform</span><span class=o>.</span><span class=n>PiecewiseAffineTransform</span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=k>return</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>piecewise_affine</span><span class=p>(</span><span class=n>img</span><span class=p>,</span> <span class=n>matrix</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>interpolation</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>mode</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>cval</span><span class=p>)</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-method"> <h3 class="doc doc-heading" id=albumentations.augmentations.geometric.transforms.PiecewiseAffine.get_params_dependent_on_targets> <code class="highlight language-python"><span class=n>get_params_dependent_on_targets</span> <span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>params</span><span class=p>)</span></code> <a class=headerlink href=#albumentations.augmentations.geometric.transforms.PiecewiseAffine.get_params_dependent_on_targets title="Permanent link">¶</a></h3> <div class="doc doc-contents"> <p>Returns parameters dependent on targets. Dependent target is defined in <code>self.targets_as_params</code></p> <details class=quote> <summary>Source code in <code>albumentations/augmentations/geometric/transforms.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=k>def</span> <span class=nf>get_params_dependent_on_targets</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>params</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>height</span><span class=p>,</span> <span class=n>width</span> <span class=o>=</span> <span class=n>params</span><span class=p>[</span><span class=s2>"image"</span><span class=p>]</span><span class=o>.</span><span class=n>shape</span><span class=p>[:</span><span class=mi>2</span><span class=p>]</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>nb_rows</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>clip</span><span class=p>(</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=o>*</span><span class=bp>self</span><span class=o>.</span><span class=n>nb_rows</span><span class=p>),</span> <span class=mi>2</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>    <span class=n>nb_cols</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>clip</span><span class=p>(</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=o>*</span><span class=bp>self</span><span class=o>.</span><span class=n>nb_cols</span><span class=p>),</span> <span class=mi>2</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=n>nb_cells</span> <span class=o>=</span> <span class=n>nb_cols</span> <span class=o>*</span> <span class=n>nb_rows</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>scale</span> <span class=o>=</span> <span class=n>random</span><span class=o>.</span><span class=n>uniform</span><span class=p>(</span><span class=o>*</span><span class=bp>self</span><span class=o>.</span><span class=n>scale</span><span class=p>)</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>    <span class=n>jitter</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span> <span class=o>=</span> <span class=n>random_utils</span><span class=o>.</span><span class=n>normal</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>scale</span><span class=p>,</span> <span class=p>(</span><span class=n>nb_cells</span><span class=p>,</span> <span class=mi>2</span><span class=p>))</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>np</span><span class=o>.</span><span class=n>any</span><span class=p>(</span><span class=n>jitter</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>):</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a>        <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>10</span><span class=p>):</span>  <span class=c1># See: https://github.com/albumentations-team/albumentations/issues/1442</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a>            <span class=n>jitter</span> <span class=o>=</span> <span class=n>random_utils</span><span class=o>.</span><span class=n>normal</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>scale</span><span class=p>,</span> <span class=p>(</span><span class=n>nb_cells</span><span class=p>,</span> <span class=mi>2</span><span class=p>))</span>
</span><span id=__span-0-13><a href=#__codelineno-0-13 id=__codelineno-0-13 name=__codelineno-0-13></a>            <span class=k>if</span> <span class=n>np</span><span class=o>.</span><span class=n>any</span><span class=p>(</span><span class=n>jitter</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>):</span>
</span><span id=__span-0-14><a href=#__codelineno-0-14 id=__codelineno-0-14 name=__codelineno-0-14></a>                <span class=k>break</span>
</span><span id=__span-0-15><a href=#__codelineno-0-15 id=__codelineno-0-15 name=__codelineno-0-15></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>np</span><span class=o>.</span><span class=n>any</span><span class=p>(</span><span class=n>jitter</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>):</span>
</span><span id=__span-0-16><a href=#__codelineno-0-16 id=__codelineno-0-16 name=__codelineno-0-16></a>            <span class=k>return</span> <span class=p>{</span><span class=s2>"matrix"</span><span class=p>:</span> <span class=kc>None</span><span class=p>}</span>
</span><span id=__span-0-17><a href=#__codelineno-0-17 id=__codelineno-0-17 name=__codelineno-0-17></a>
</span><span id=__span-0-18><a href=#__codelineno-0-18 id=__codelineno-0-18 name=__codelineno-0-18></a>    <span class=n>y</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>height</span><span class=p>,</span> <span class=n>nb_rows</span><span class=p>)</span>
</span><span id=__span-0-19><a href=#__codelineno-0-19 id=__codelineno-0-19 name=__codelineno-0-19></a>    <span class=n>x</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>width</span><span class=p>,</span> <span class=n>nb_cols</span><span class=p>)</span>
</span><span id=__span-0-20><a href=#__codelineno-0-20 id=__codelineno-0-20 name=__codelineno-0-20></a>
</span><span id=__span-0-21><a href=#__codelineno-0-21 id=__codelineno-0-21 name=__codelineno-0-21></a>    <span class=c1># (H, W) and (H, W) for H=rows, W=cols</span>
</span><span id=__span-0-22><a href=#__codelineno-0-22 id=__codelineno-0-22 name=__codelineno-0-22></a>    <span class=n>xx_src</span><span class=p>,</span> <span class=n>yy_src</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>meshgrid</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
</span><span id=__span-0-23><a href=#__codelineno-0-23 id=__codelineno-0-23 name=__codelineno-0-23></a>
</span><span id=__span-0-24><a href=#__codelineno-0-24 id=__codelineno-0-24 name=__codelineno-0-24></a>    <span class=c1># (1, HW, 2) =&gt; (HW, 2) for H=rows, W=cols</span>
</span><span id=__span-0-25><a href=#__codelineno-0-25 id=__codelineno-0-25 name=__codelineno-0-25></a>    <span class=n>points_src</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>dstack</span><span class=p>([</span><span class=n>yy_src</span><span class=o>.</span><span class=n>flat</span><span class=p>,</span> <span class=n>xx_src</span><span class=o>.</span><span class=n>flat</span><span class=p>])[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-0-26><a href=#__codelineno-0-26 id=__codelineno-0-26 name=__codelineno-0-26></a>
</span><span id=__span-0-27><a href=#__codelineno-0-27 id=__codelineno-0-27 name=__codelineno-0-27></a>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>absolute_scale</span><span class=p>:</span>
</span><span id=__span-0-28><a href=#__codelineno-0-28 id=__codelineno-0-28 name=__codelineno-0-28></a>        <span class=n>jitter</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=n>jitter</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>]</span> <span class=o>/</span> <span class=n>height</span> <span class=k>if</span> <span class=n>height</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=k>else</span> <span class=mf>0.0</span>
</span><span id=__span-0-29><a href=#__codelineno-0-29 id=__codelineno-0-29 name=__codelineno-0-29></a>        <span class=n>jitter</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>jitter</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>]</span> <span class=o>/</span> <span class=n>width</span> <span class=k>if</span> <span class=n>width</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=k>else</span> <span class=mf>0.0</span>
</span><span id=__span-0-30><a href=#__codelineno-0-30 id=__codelineno-0-30 name=__codelineno-0-30></a>
</span><span id=__span-0-31><a href=#__codelineno-0-31 id=__codelineno-0-31 name=__codelineno-0-31></a>    <span class=n>jitter</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=n>jitter</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>]</span> <span class=o>*</span> <span class=n>height</span>
</span><span id=__span-0-32><a href=#__codelineno-0-32 id=__codelineno-0-32 name=__codelineno-0-32></a>    <span class=n>jitter</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>jitter</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>]</span> <span class=o>*</span> <span class=n>width</span>
</span><span id=__span-0-33><a href=#__codelineno-0-33 id=__codelineno-0-33 name=__codelineno-0-33></a>
</span><span id=__span-0-34><a href=#__codelineno-0-34 id=__codelineno-0-34 name=__codelineno-0-34></a>    <span class=n>points_dest</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>copy</span><span class=p>(</span><span class=n>points_src</span><span class=p>)</span>
</span><span id=__span-0-35><a href=#__codelineno-0-35 id=__codelineno-0-35 name=__codelineno-0-35></a>    <span class=n>points_dest</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=n>points_dest</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>]</span> <span class=o>+</span> <span class=n>jitter</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>]</span>
</span><span id=__span-0-36><a href=#__codelineno-0-36 id=__codelineno-0-36 name=__codelineno-0-36></a>    <span class=n>points_dest</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>points_dest</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=n>jitter</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>]</span>
</span><span id=__span-0-37><a href=#__codelineno-0-37 id=__codelineno-0-37 name=__codelineno-0-37></a>
</span><span id=__span-0-38><a href=#__codelineno-0-38 id=__codelineno-0-38 name=__codelineno-0-38></a>    <span class=c1># Restrict all destination points to be inside the image plane.</span>
</span><span id=__span-0-39><a href=#__codelineno-0-39 id=__codelineno-0-39 name=__codelineno-0-39></a>    <span class=c1># This is necessary, as otherwise keypoints could be augmented</span>
</span><span id=__span-0-40><a href=#__codelineno-0-40 id=__codelineno-0-40 name=__codelineno-0-40></a>    <span class=c1># outside of the image plane and these would be replaced by</span>
</span><span id=__span-0-41><a href=#__codelineno-0-41 id=__codelineno-0-41 name=__codelineno-0-41></a>    <span class=c1># (-1, -1), which would not conform with the behaviour of the other augmenters.</span>
</span><span id=__span-0-42><a href=#__codelineno-0-42 id=__codelineno-0-42 name=__codelineno-0-42></a>    <span class=n>points_dest</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>clip</span><span class=p>(</span><span class=n>points_dest</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>],</span> <span class=mi>0</span><span class=p>,</span> <span class=n>height</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span>
</span><span id=__span-0-43><a href=#__codelineno-0-43 id=__codelineno-0-43 name=__codelineno-0-43></a>    <span class=n>points_dest</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>clip</span><span class=p>(</span><span class=n>points_dest</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>],</span> <span class=mi>0</span><span class=p>,</span> <span class=n>width</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span>
</span><span id=__span-0-44><a href=#__codelineno-0-44 id=__codelineno-0-44 name=__codelineno-0-44></a>
</span><span id=__span-0-45><a href=#__codelineno-0-45 id=__codelineno-0-45 name=__codelineno-0-45></a>    <span class=n>matrix</span> <span class=o>=</span> <span class=n>skimage</span><span class=o>.</span><span class=n>transform</span><span class=o>.</span><span class=n>PiecewiseAffineTransform</span><span class=p>()</span>
</span><span id=__span-0-46><a href=#__codelineno-0-46 id=__codelineno-0-46 name=__codelineno-0-46></a>    <span class=n>matrix</span><span class=o>.</span><span class=n>estimate</span><span class=p>(</span><span class=n>points_src</span><span class=p>[:,</span> <span class=p>::</span><span class=o>-</span><span class=mi>1</span><span class=p>],</span> <span class=n>points_dest</span><span class=p>[:,</span> <span class=p>::</span><span class=o>-</span><span class=mi>1</span><span class=p>])</span>
</span><span id=__span-0-47><a href=#__codelineno-0-47 id=__codelineno-0-47 name=__codelineno-0-47></a>
</span><span id=__span-0-48><a href=#__codelineno-0-48 id=__codelineno-0-48 name=__codelineno-0-48></a>    <span class=k>return</span> <span class=p>{</span>
</span><span id=__span-0-49><a href=#__codelineno-0-49 id=__codelineno-0-49 name=__codelineno-0-49></a>        <span class=s2>"matrix"</span><span class=p>:</span> <span class=n>matrix</span><span class=p>,</span>
</span><span id=__span-0-50><a href=#__codelineno-0-50 id=__codelineno-0-50 name=__codelineno-0-50></a>    <span class=p>}</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-method"> <h3 class="doc doc-heading" id=albumentations.augmentations.geometric.transforms.PiecewiseAffine.get_transform_init_args_names> <code class="highlight language-python"><span class=n>get_transform_init_args_names</span> <span class=p>(</span><span class=bp>self</span><span class=p>)</span></code> <a class=headerlink href=#albumentations.augmentations.geometric.transforms.PiecewiseAffine.get_transform_init_args_names title="Permanent link">¶</a></h3> <div class="doc doc-contents"> <p>Returns names of arguments that are used in <strong>init</strong> method of the transform</p> <details class=quote> <summary>Source code in <code>albumentations/augmentations/geometric/transforms.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=k>def</span> <span class=nf>get_transform_init_args_names</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=o>...</span><span class=p>]:</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=k>return</span> <span class=p>(</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>        <span class=s2>"scale"</span><span class=p>,</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>        <span class=s2>"nb_rows"</span><span class=p>,</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>        <span class=s2>"nb_cols"</span><span class=p>,</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>        <span class=s2>"interpolation"</span><span class=p>,</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>        <span class=s2>"mask_interpolation"</span><span class=p>,</span>
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>        <span class=s2>"cval"</span><span class=p>,</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>        <span class=s2>"cval_mask"</span><span class=p>,</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>        <span class=s2>"mode"</span><span class=p>,</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a>        <span class=s2>"absolute_scale"</span><span class=p>,</span>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a>        <span class=s2>"keypoints_threshold"</span><span class=p>,</span>
</span><span id=__span-0-13><a href=#__codelineno-0-13 id=__codelineno-0-13 name=__codelineno-0-13></a>    <span class=p>)</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h2 class="doc doc-heading" data-toc-label=ShiftScaleRotate id=albumentations.augmentations.geometric.transforms.ShiftScaleRotate> <code>class <strong> ShiftScaleRotate</strong></code> <code> (shift_limit=(-0.0625, 0.0625), scale_limit=(-0.1, 0.1), rotate_limit=(-45, 45), interpolation=1, border_mode=4, value=0, mask_value=0, shift_limit_x=None, shift_limit_y=None, rotate_method='largest_box', always_apply=None, p=0.5) </code> <span class=doc-github-link> <a href=https://github.com/albumentations-team/albumentations/blob/main/albumentations/augmentations/geometric/transforms.py#L934 target=_blank>[view source on GitHub]</a> </span><a class=headerlink href=#albumentations.augmentations.geometric.transforms.ShiftScaleRotate title="Permanent link">¶</a> </h2> <div class=class-signature> </div> <div class="doc doc-contents"> <p>Randomly apply affine transforms: translate, scale and rotate the input.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>shift_limit</code></td> <td><code>float, float) or float</code></td> <td><p>shift factor range for both height and width. If shift_limit is a single float value, the range will be (-shift_limit, shift_limit). Absolute values for lower and upper bounds should lie in range [-1, 1]. Default: (-0.0625, 0.0625).</p></td> </tr> <tr> <td><code>scale_limit</code></td> <td><code>float, float) or float</code></td> <td><p>scaling factor range. If scale_limit is a single float value, the range will be (-scale_limit, scale_limit). Note that the scale_limit will be biased by 1. If scale_limit is a tuple, like (low, high), sampling will be done from the range (1 + low, 1 + high). Default: (-0.1, 0.1).</p></td> </tr> <tr> <td><code>rotate_limit</code></td> <td><code>int, int) or int</code></td> <td><p>rotation range. If rotate_limit is a single int value, the range will be (-rotate_limit, rotate_limit). Default: (-45, 45).</p></td> </tr> <tr> <td><code>interpolation</code></td> <td><code>OpenCV flag</code></td> <td><p>flag that is used to specify the interpolation algorithm. Should be one of: cv2.INTER_NEAREST, cv2.INTER_LINEAR, cv2.INTER_CUBIC, cv2.INTER_AREA, cv2.INTER_LANCZOS4. Default: cv2.INTER_LINEAR.</p></td> </tr> <tr> <td><code>border_mode</code></td> <td><code>OpenCV flag</code></td> <td><p>flag that is used to specify the pixel extrapolation method. Should be one of: cv2.BORDER_CONSTANT, cv2.BORDER_REPLICATE, cv2.BORDER_REFLECT, cv2.BORDER_WRAP, cv2.BORDER_REFLECT_101. Default: cv2.BORDER_REFLECT_101</p></td> </tr> <tr> <td><code>value</code></td> <td><code>int, float, list of int, list of float</code></td> <td><p>padding value if border_mode is cv2.BORDER_CONSTANT.</p></td> </tr> <tr> <td><code>mask_value</code></td> <td><code>int, float, list of int, list of float</code></td> <td><p>padding value if border_mode is cv2.BORDER_CONSTANT applied for masks.</p></td> </tr> <tr> <td><code>shift_limit_x</code></td> <td><code>float, float) or float</code></td> <td><p>shift factor range for width. If it is set then this value instead of shift_limit will be used for shifting width. If shift_limit_x is a single float value, the range will be (-shift_limit_x, shift_limit_x). Absolute values for lower and upper bounds should lie in the range [-1, 1]. Default: None.</p></td> </tr> <tr> <td><code>shift_limit_y</code></td> <td><code>float, float) or float</code></td> <td><p>shift factor range for height. If it is set then this value instead of shift_limit will be used for shifting height. If shift_limit_y is a single float value, the range will be (-shift_limit_y, shift_limit_y). Absolute values for lower and upper bounds should lie in the range [-, 1]. Default: None.</p></td> </tr> <tr> <td><code>rotate_method</code></td> <td><code>str</code></td> <td><p>rotation method used for the bounding boxes. Should be one of "largest_box" or "ellipse". Default: "largest_box"</p></td> </tr> <tr> <td><code>p</code></td> <td><code>float</code></td> <td><p>probability of applying the transform. Default: 0.5.</p></td> </tr> </tbody> </table> <div class="admonition targets"> <p class=admonition-title>Targets</p> <p>image, mask, keypoints, bboxes</p> </div> <p>Image types: uint8, float32</p> <div class="admonition info"> <p class=admonition-title><strong>Interactive Tool Available!</strong></p> <p> <strong>Explore this transform visually and adjust parameters interactively using this tool:</strong> </p> <p> <a class="md-button md-button--primary" href="https://huggingface.co/spaces/qubvel-hf/albumentations-demo?transform=ShiftScaleRotate" target=_blank>Open Tool</a> </p> </div> <details class=quote> <summary>Source code in <code>albumentations/augmentations/geometric/transforms.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1></a><a href=#__codelineno-0-1><span class=linenos data-linenos="  1 "></span></a><span class=k>class</span> <span class=nc>ShiftScaleRotate</span><span class=p>(</span><span class=n>Affine</span><span class=p>):</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2></a><a href=#__codelineno-0-2><span class=linenos data-linenos="  2 "></span></a><span class=w>    </span><span class=sd>"""Randomly apply affine transforms: translate, scale and rotate the input.</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3></a><a href=#__codelineno-0-3><span class=linenos data-linenos="  3 "></span></a>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4></a><a href=#__codelineno-0-4><span class=linenos data-linenos="  4 "></span></a><span class=sd>    Args:</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5></a><a href=#__codelineno-0-5><span class=linenos data-linenos="  5 "></span></a><span class=sd>        shift_limit ((float, float) or float): shift factor range for both height and width. If shift_limit</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6></a><a href=#__codelineno-0-6><span class=linenos data-linenos="  6 "></span></a><span class=sd>            is a single float value, the range will be (-shift_limit, shift_limit). Absolute values for lower and</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7></a><a href=#__codelineno-0-7><span class=linenos data-linenos="  7 "></span></a><span class=sd>            upper bounds should lie in range [-1, 1]. Default: (-0.0625, 0.0625).</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8></a><a href=#__codelineno-0-8><span class=linenos data-linenos="  8 "></span></a><span class=sd>        scale_limit ((float, float) or float): scaling factor range. If scale_limit is a single float value, the</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9></a><a href=#__codelineno-0-9><span class=linenos data-linenos="  9 "></span></a><span class=sd>            range will be (-scale_limit, scale_limit). Note that the scale_limit will be biased by 1.</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10></a><a href=#__codelineno-0-10><span class=linenos data-linenos=" 10 "></span></a><span class=sd>            If scale_limit is a tuple, like (low, high), sampling will be done from the range (1 + low, 1 + high).</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11></a><a href=#__codelineno-0-11><span class=linenos data-linenos=" 11 "></span></a><span class=sd>            Default: (-0.1, 0.1).</span>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12></a><a href=#__codelineno-0-12><span class=linenos data-linenos=" 12 "></span></a><span class=sd>        rotate_limit ((int, int) or int): rotation range. If rotate_limit is a single int value, the</span>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13></a><a href=#__codelineno-0-13><span class=linenos data-linenos=" 13 "></span></a><span class=sd>            range will be (-rotate_limit, rotate_limit). Default: (-45, 45).</span>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14></a><a href=#__codelineno-0-14><span class=linenos data-linenos=" 14 "></span></a><span class=sd>        interpolation (OpenCV flag): flag that is used to specify the interpolation algorithm. Should be one of:</span>
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15></a><a href=#__codelineno-0-15><span class=linenos data-linenos=" 15 "></span></a><span class=sd>            cv2.INTER_NEAREST, cv2.INTER_LINEAR, cv2.INTER_CUBIC, cv2.INTER_AREA, cv2.INTER_LANCZOS4.</span>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16></a><a href=#__codelineno-0-16><span class=linenos data-linenos=" 16 "></span></a><span class=sd>            Default: cv2.INTER_LINEAR.</span>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17></a><a href=#__codelineno-0-17><span class=linenos data-linenos=" 17 "></span></a><span class=sd>        border_mode (OpenCV flag): flag that is used to specify the pixel extrapolation method. Should be one of:</span>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18></a><a href=#__codelineno-0-18><span class=linenos data-linenos=" 18 "></span></a><span class=sd>            cv2.BORDER_CONSTANT, cv2.BORDER_REPLICATE, cv2.BORDER_REFLECT, cv2.BORDER_WRAP, cv2.BORDER_REFLECT_101.</span>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19></a><a href=#__codelineno-0-19><span class=linenos data-linenos=" 19 "></span></a><span class=sd>            Default: cv2.BORDER_REFLECT_101</span>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20></a><a href=#__codelineno-0-20><span class=linenos data-linenos=" 20 "></span></a><span class=sd>        value (int, float, list of int, list of float): padding value if border_mode is cv2.BORDER_CONSTANT.</span>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21></a><a href=#__codelineno-0-21><span class=linenos data-linenos=" 21 "></span></a><span class=sd>        mask_value (int, float,</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22></a><a href=#__codelineno-0-22><span class=linenos data-linenos=" 22 "></span></a><span class=sd>                    list of int,</span>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23></a><a href=#__codelineno-0-23><span class=linenos data-linenos=" 23 "></span></a><span class=sd>                    list of float): padding value if border_mode is cv2.BORDER_CONSTANT applied for masks.</span>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a><a href=#__codelineno-0-24><span class=linenos data-linenos=" 24 "></span></a><span class=sd>        shift_limit_x ((float, float) or float): shift factor range for width. If it is set then this value</span>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a><a href=#__codelineno-0-25><span class=linenos data-linenos=" 25 "></span></a><span class=sd>            instead of shift_limit will be used for shifting width.  If shift_limit_x is a single float value,</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a><a href=#__codelineno-0-26><span class=linenos data-linenos=" 26 "></span></a><span class=sd>            the range will be (-shift_limit_x, shift_limit_x). Absolute values for lower and upper bounds should lie in</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a><a href=#__codelineno-0-27><span class=linenos data-linenos=" 27 "></span></a><span class=sd>            the range [-1, 1]. Default: None.</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a><a href=#__codelineno-0-28><span class=linenos data-linenos=" 28 "></span></a><span class=sd>        shift_limit_y ((float, float) or float): shift factor range for height. If it is set then this value</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a><a href=#__codelineno-0-29><span class=linenos data-linenos=" 29 "></span></a><span class=sd>            instead of shift_limit will be used for shifting height.  If shift_limit_y is a single float value,</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a><a href=#__codelineno-0-30><span class=linenos data-linenos=" 30 "></span></a><span class=sd>            the range will be (-shift_limit_y, shift_limit_y). Absolute values for lower and upper bounds should lie</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a><a href=#__codelineno-0-31><span class=linenos data-linenos=" 31 "></span></a><span class=sd>            in the range [-, 1]. Default: None.</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a><a href=#__codelineno-0-32><span class=linenos data-linenos=" 32 "></span></a><span class=sd>        rotate_method (str): rotation method used for the bounding boxes. Should be one of "largest_box" or "ellipse".</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a><a href=#__codelineno-0-33><span class=linenos data-linenos=" 33 "></span></a><span class=sd>            Default: "largest_box"</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a><a href=#__codelineno-0-34><span class=linenos data-linenos=" 34 "></span></a><span class=sd>        p (float): probability of applying the transform. Default: 0.5.</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a><a href=#__codelineno-0-35><span class=linenos data-linenos=" 35 "></span></a>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a><a href=#__codelineno-0-36><span class=linenos data-linenos=" 36 "></span></a><span class=sd>    Targets:</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a><a href=#__codelineno-0-37><span class=linenos data-linenos=" 37 "></span></a><span class=sd>        image, mask, keypoints, bboxes</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a><a href=#__codelineno-0-38><span class=linenos data-linenos=" 38 "></span></a>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a><a href=#__codelineno-0-39><span class=linenos data-linenos=" 39 "></span></a><span class=sd>    Image types:</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a><a href=#__codelineno-0-40><span class=linenos data-linenos=" 40 "></span></a><span class=sd>        uint8, float32</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a><a href=#__codelineno-0-41><span class=linenos data-linenos=" 41 "></span></a>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><a href=#__codelineno-0-42><span class=linenos data-linenos=" 42 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos=" 43 "></span></a>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos=" 44 "></span></a>    <span class=n>_targets</span> <span class=o>=</span> <span class=p>(</span><span class=n>Targets</span><span class=o>.</span><span class=n>IMAGE</span><span class=p>,</span> <span class=n>Targets</span><span class=o>.</span><span class=n>MASK</span><span class=p>,</span> <span class=n>Targets</span><span class=o>.</span><span class=n>KEYPOINTS</span><span class=p>,</span> <span class=n>Targets</span><span class=o>.</span><span class=n>BBOXES</span><span class=p>)</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos=" 45 "></span></a>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos=" 46 "></span></a>    <span class=k>class</span> <span class=nc>InitSchema</span><span class=p>(</span><span class=n>BaseTransformInitSchema</span><span class=p>):</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos=" 47 "></span></a>        <span class=n>shift_limit</span><span class=p>:</span> <span class=n>SymmetricRangeType</span> <span class=o>=</span> <span class=p>(</span><span class=o>-</span><span class=mf>0.0625</span><span class=p>,</span> <span class=mf>0.0625</span><span class=p>)</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos=" 48 "></span></a>        <span class=n>scale_limit</span><span class=p>:</span> <span class=n>SymmetricRangeType</span> <span class=o>=</span> <span class=p>(</span><span class=o>-</span><span class=mf>0.1</span><span class=p>,</span> <span class=mf>0.1</span><span class=p>)</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos=" 49 "></span></a>        <span class=n>rotate_limit</span><span class=p>:</span> <span class=n>SymmetricRangeType</span> <span class=o>=</span> <span class=p>(</span><span class=o>-</span><span class=mi>45</span><span class=p>,</span> <span class=mi>45</span><span class=p>)</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos=" 50 "></span></a>        <span class=n>interpolation</span><span class=p>:</span> <span class=n>InterpolationType</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_LINEAR</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos=" 51 "></span></a>        <span class=n>border_mode</span><span class=p>:</span> <span class=n>BorderModeType</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>BORDER_REFLECT_101</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos=" 52 "></span></a>        <span class=n>value</span><span class=p>:</span> <span class=n>ColorType</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a>        <span class=n>mask_value</span><span class=p>:</span> <span class=n>ColorType</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a>        <span class=n>shift_limit_x</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>ScaleFloatType</span><span class=p>]</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=n>default</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a>        <span class=n>shift_limit_y</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>ScaleFloatType</span><span class=p>]</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=n>default</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a>        <span class=n>rotate_method</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>"largest_box"</span><span class=p>,</span> <span class=s2>"ellipse"</span><span class=p>]</span> <span class=o>=</span> <span class=s2>"largest_box"</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a>        <span class=nd>@model_validator</span><span class=p>(</span><span class=n>mode</span><span class=o>=</span><span class=s2>"after"</span><span class=p>)</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a>        <span class=k>def</span> <span class=nf>check_shift_limit</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Self</span><span class=p>:</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a>            <span class=n>bounds</span> <span class=o>=</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>shift_limit_x</span> <span class=o>=</span> <span class=n>to_tuple</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>shift_limit_x</span> <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>shift_limit_x</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=k>else</span> <span class=bp>self</span><span class=o>.</span><span class=n>shift_limit</span><span class=p>)</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a>            <span class=n>check_range</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>shift_limit_x</span><span class=p>,</span> <span class=o>*</span><span class=n>bounds</span><span class=p>,</span> <span class=s2>"shift_limit_x"</span><span class=p>)</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>shift_limit_y</span> <span class=o>=</span> <span class=n>to_tuple</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>shift_limit_y</span> <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>shift_limit_y</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=k>else</span> <span class=bp>self</span><span class=o>.</span><span class=n>shift_limit</span><span class=p>)</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a>            <span class=n>check_range</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>shift_limit_y</span><span class=p>,</span> <span class=o>*</span><span class=n>bounds</span><span class=p>,</span> <span class=s2>"shift_limit_y"</span><span class=p>)</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a>            <span class=k>return</span> <span class=bp>self</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a>        <span class=nd>@field_validator</span><span class=p>(</span><span class=s2>"scale_limit"</span><span class=p>)</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a>        <span class=nd>@classmethod</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a>        <span class=k>def</span> <span class=nf>check_scale_limit</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>value</span><span class=p>:</span> <span class=n>ScaleFloatType</span><span class=p>,</span> <span class=n>info</span><span class=p>:</span> <span class=n>ValidationInfo</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>ScaleFloatType</span><span class=p>:</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a>            <span class=n>bounds</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=nb>float</span><span class=p>(</span><span class=s2>"inf"</span><span class=p>)</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a>            <span class=n>result</span> <span class=o>=</span> <span class=n>to_tuple</span><span class=p>(</span><span class=n>value</span><span class=p>,</span> <span class=n>bias</span><span class=o>=</span><span class=mf>1.0</span><span class=p>)</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a>            <span class=n>check_range</span><span class=p>(</span><span class=n>result</span><span class=p>,</span> <span class=o>*</span><span class=n>bounds</span><span class=p>,</span> <span class=nb>str</span><span class=p>(</span><span class=n>info</span><span class=o>.</span><span class=n>field_name</span><span class=p>))</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a>            <span class=k>return</span> <span class=n>result</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a>        <span class=n>shift_limit</span><span class=p>:</span> <span class=n>ScaleFloatType</span> <span class=o>=</span> <span class=p>(</span><span class=o>-</span><span class=mf>0.0625</span><span class=p>,</span> <span class=mf>0.0625</span><span class=p>),</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a>        <span class=n>scale_limit</span><span class=p>:</span> <span class=n>ScaleFloatType</span> <span class=o>=</span> <span class=p>(</span><span class=o>-</span><span class=mf>0.1</span><span class=p>,</span> <span class=mf>0.1</span><span class=p>),</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a>        <span class=n>rotate_limit</span><span class=p>:</span> <span class=n>ScaleFloatType</span> <span class=o>=</span> <span class=p>(</span><span class=o>-</span><span class=mi>45</span><span class=p>,</span> <span class=mi>45</span><span class=p>),</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a>        <span class=n>interpolation</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>INTER_LINEAR</span><span class=p>,</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a>        <span class=n>border_mode</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>BORDER_REFLECT_101</span><span class=p>,</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a>        <span class=n>value</span><span class=p>:</span> <span class=n>ColorType</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a>        <span class=n>mask_value</span><span class=p>:</span> <span class=n>ColorType</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a>        <span class=n>shift_limit_x</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>ScaleFloatType</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a>        <span class=n>shift_limit_y</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>ScaleFloatType</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a>        <span class=n>rotate_method</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>"largest_box"</span><span class=p>,</span> <span class=s2>"ellipse"</span><span class=p>]</span> <span class=o>=</span> <span class=s2>"largest_box"</span><span class=p>,</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a>        <span class=n>always_apply</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>bool</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a>        <span class=n>p</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.5</span><span class=p>,</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a>    <span class=p>):</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a>            <span class=n>scale</span><span class=o>=</span><span class=n>scale_limit</span><span class=p>,</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a>            <span class=n>translate_percent</span><span class=o>=</span><span class=p>{</span><span class=s2>"x"</span><span class=p>:</span> <span class=n>shift_limit_x</span><span class=p>,</span> <span class=s2>"y"</span><span class=p>:</span> <span class=n>shift_limit_y</span><span class=p>},</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a>            <span class=n>rotate</span><span class=o>=</span><span class=n>rotate_limit</span><span class=p>,</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a>            <span class=n>shear</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a>            <span class=n>interpolation</span><span class=o>=</span><span class=n>interpolation</span><span class=p>,</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a>            <span class=n>mask_interpolation</span><span class=o>=</span><span class=n>cv2</span><span class=o>.</span><span class=n>INTER_NEAREST</span><span class=p>,</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a>            <span class=n>cval</span><span class=o>=</span><span class=n>value</span><span class=p>,</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a>            <span class=n>cval_mask</span><span class=o>=</span><span class=n>mask_value</span><span class=p>,</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a>            <span class=n>mode</span><span class=o>=</span><span class=n>border_mode</span><span class=p>,</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a>            <span class=n>fit_output</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a>            <span class=n>keep_ratio</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a>            <span class=n>rotate_method</span><span class=o>=</span><span class=n>rotate_method</span><span class=p>,</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a>            <span class=n>always_apply</span><span class=o>=</span><span class=n>always_apply</span><span class=p>,</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a>            <span class=n>p</span><span class=o>=</span><span class=n>p</span><span class=p>,</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>        <span class=n>warn</span><span class=p>(</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>            <span class=s2>"ShiftScaleRotate is deprecated. Please use Affine transform instead ."</span><span class=p>,</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>            <span class=ne>DeprecationWarning</span><span class=p>,</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a>            <span class=n>stacklevel</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>shift_limit_x</span> <span class=o>=</span> <span class=n>cast</span><span class=p>(</span><span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>],</span> <span class=n>shift_limit_x</span><span class=p>)</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>shift_limit_y</span> <span class=o>=</span> <span class=n>cast</span><span class=p>(</span><span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>],</span> <span class=n>shift_limit_y</span><span class=p>)</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>scale_limit</span> <span class=o>=</span> <span class=n>cast</span><span class=p>(</span><span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>],</span> <span class=n>scale_limit</span><span class=p>)</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>rotate_limit</span> <span class=o>=</span> <span class=n>cast</span><span class=p>(</span><span class=n>Tuple</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=nb>int</span><span class=p>],</span> <span class=n>rotate_limit</span><span class=p>)</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>border_mode</span> <span class=o>=</span> <span class=n>border_mode</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>value</span> <span class=o>=</span> <span class=n>value</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>mask_value</span> <span class=o>=</span> <span class=n>mask_value</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a>    <span class=k>def</span> <span class=nf>get_transform_init_args</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a>        <span class=k>return</span> <span class=p>{</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a>            <span class=s2>"shift_limit_x"</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>shift_limit_x</span><span class=p>,</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a>            <span class=s2>"shift_limit_y"</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>shift_limit_y</span><span class=p>,</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a>            <span class=s2>"scale_limit"</span><span class=p>:</span> <span class=n>to_tuple</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>scale_limit</span><span class=p>,</span> <span class=n>bias</span><span class=o>=-</span><span class=mf>1.0</span><span class=p>),</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a>            <span class=s2>"rotate_limit"</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>rotate_limit</span><span class=p>,</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a>            <span class=s2>"interpolation"</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>interpolation</span><span class=p>,</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a>            <span class=s2>"border_mode"</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>border_mode</span><span class=p>,</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a>            <span class=s2>"value"</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>value</span><span class=p>,</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a>            <span class=s2>"mask_value"</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>mask_value</span><span class=p>,</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a>            <span class=s2>"rotate_method"</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>rotate_method</span><span class=p>,</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a>        <span class=p>}</span>
</span></code></pre></div> </details> <div class="doc doc-children"> </div> </div> </div> <div class="doc doc-object doc-class"> <h2 class="doc doc-heading" data-toc-label=Transpose id=albumentations.augmentations.geometric.transforms.Transpose> <code>class <strong> Transpose</strong></code> <code> </code> <span class=doc-github-link> <a href=https://github.com/albumentations-team/albumentations/blob/main/albumentations/augmentations/geometric/transforms.py#L1653 target=_blank>[view source on GitHub]</a> </span><a class=headerlink href=#albumentations.augmentations.geometric.transforms.Transpose title="Permanent link">¶</a> </h2> <div class=class-signature> </div> <div class="doc doc-contents"> <p>Transpose the input by swapping rows and columns.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>p</code></td> <td><code>float</code></td> <td><p>probability of applying the transform. Default: 0.5.</p></td> </tr> </tbody> </table> <div class="admonition targets"> <p class=admonition-title>Targets</p> <p>image, mask, bboxes, keypoints</p> </div> <p>Image types: uint8, float32</p> <div class="admonition info"> <p class=admonition-title><strong>Interactive Tool Available!</strong></p> <p> <strong>Explore this transform visually and adjust parameters interactively using this tool:</strong> </p> <p> <a class="md-button md-button--primary" href="https://huggingface.co/spaces/qubvel-hf/albumentations-demo?transform=Transpose" target=_blank>Open Tool</a> </p> </div> <details class=quote> <summary>Source code in <code>albumentations/augmentations/geometric/transforms.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1></a><a href=#__codelineno-0-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>class</span> <span class=nc>Transpose</span><span class=p>(</span><span class=n>DualTransform</span><span class=p>):</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2></a><a href=#__codelineno-0-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>    </span><span class=sd>"""Transpose the input by swapping rows and columns.</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3></a><a href=#__codelineno-0-3><span class=linenos data-linenos=" 3 "></span></a>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4></a><a href=#__codelineno-0-4><span class=linenos data-linenos=" 4 "></span></a><span class=sd>    Args:</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5></a><a href=#__codelineno-0-5><span class=linenos data-linenos=" 5 "></span></a><span class=sd>        p (float): probability of applying the transform. Default: 0.5.</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6></a><a href=#__codelineno-0-6><span class=linenos data-linenos=" 6 "></span></a>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7></a><a href=#__codelineno-0-7><span class=linenos data-linenos=" 7 "></span></a><span class=sd>    Targets:</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8></a><a href=#__codelineno-0-8><span class=linenos data-linenos=" 8 "></span></a><span class=sd>        image, mask, bboxes, keypoints</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9></a><a href=#__codelineno-0-9><span class=linenos data-linenos=" 9 "></span></a>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10></a><a href=#__codelineno-0-10><span class=linenos data-linenos="10 "></span></a><span class=sd>    Image types:</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11></a><a href=#__codelineno-0-11><span class=linenos data-linenos="11 "></span></a><span class=sd>        uint8, float32</span>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12></a><a href=#__codelineno-0-12><span class=linenos data-linenos="12 "></span></a>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13></a><a href=#__codelineno-0-13><span class=linenos data-linenos="13 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14></a><a href=#__codelineno-0-14><span class=linenos data-linenos="14 "></span></a>
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15></a><a href=#__codelineno-0-15><span class=linenos data-linenos="15 "></span></a>    <span class=n>_targets</span> <span class=o>=</span> <span class=p>(</span><span class=n>Targets</span><span class=o>.</span><span class=n>IMAGE</span><span class=p>,</span> <span class=n>Targets</span><span class=o>.</span><span class=n>MASK</span><span class=p>,</span> <span class=n>Targets</span><span class=o>.</span><span class=n>BBOXES</span><span class=p>,</span> <span class=n>Targets</span><span class=o>.</span><span class=n>KEYPOINTS</span><span class=p>)</span>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16></a><a href=#__codelineno-0-16><span class=linenos data-linenos="16 "></span></a>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17></a><a href=#__codelineno-0-17><span class=linenos data-linenos="17 "></span></a>    <span class=k>def</span> <span class=nf>apply</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>img</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18></a><a href=#__codelineno-0-18><span class=linenos data-linenos="18 "></span></a>        <span class=k>return</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>transpose</span><span class=p>(</span><span class=n>img</span><span class=p>)</span>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19></a><a href=#__codelineno-0-19><span class=linenos data-linenos="19 "></span></a>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20></a><a href=#__codelineno-0-20><span class=linenos data-linenos="20 "></span></a>    <span class=k>def</span> <span class=nf>apply_to_bbox</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>bbox</span><span class=p>:</span> <span class=n>BoxInternalType</span><span class=p>,</span> <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>BoxInternalType</span><span class=p>:</span>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21></a><a href=#__codelineno-0-21><span class=linenos data-linenos="21 "></span></a>        <span class=k>return</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>bbox_transpose</span><span class=p>(</span><span class=n>bbox</span><span class=p>,</span> <span class=o>**</span><span class=n>params</span><span class=p>)</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22></a><a href=#__codelineno-0-22><span class=linenos data-linenos="22 "></span></a>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23></a><a href=#__codelineno-0-23><span class=linenos data-linenos="23 "></span></a>    <span class=k>def</span> <span class=nf>apply_to_keypoint</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>keypoint</span><span class=p>:</span> <span class=n>KeypointInternalType</span><span class=p>,</span> <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>KeypointInternalType</span><span class=p>:</span>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a><a href=#__codelineno-0-24><span class=linenos data-linenos="24 "></span></a>        <span class=k>return</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>keypoint_transpose</span><span class=p>(</span><span class=n>keypoint</span><span class=p>,</span> <span class=o>**</span><span class=n>params</span><span class=p>)</span>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a><a href=#__codelineno-0-25><span class=linenos data-linenos="25 "></span></a>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a><a href=#__codelineno-0-26><span class=linenos data-linenos="26 "></span></a>    <span class=k>def</span> <span class=nf>get_transform_init_args_names</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[()]:</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a><a href=#__codelineno-0-27><span class=linenos data-linenos="27 "></span></a>        <span class=k>return</span> <span class=p>()</span>
</span></code></pre></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-method"> <h3 class="doc doc-heading" id=albumentations.augmentations.geometric.transforms.Transpose.apply> <code class="highlight language-python"><span class=n>apply</span> <span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>img</span><span class=p>,</span> <span class=o>**</span><span class=n>params</span><span class=p>)</span></code> <a class=headerlink href=#albumentations.augmentations.geometric.transforms.Transpose.apply title="Permanent link">¶</a></h3> <div class="doc doc-contents"> <p>Apply transform on image.</p> <details class=quote> <summary>Source code in <code>albumentations/augmentations/geometric/transforms.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=k>def</span> <span class=nf>apply</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>img</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=k>return</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>transpose</span><span class=p>(</span><span class=n>img</span><span class=p>)</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-method"> <h3 class="doc doc-heading" id=albumentations.augmentations.geometric.transforms.Transpose.get_transform_init_args_names> <code class="highlight language-python"><span class=n>get_transform_init_args_names</span> <span class=p>(</span><span class=bp>self</span><span class=p>)</span></code> <a class=headerlink href=#albumentations.augmentations.geometric.transforms.Transpose.get_transform_init_args_names title="Permanent link">¶</a></h3> <div class="doc doc-contents"> <p>Returns names of arguments that are used in <strong>init</strong> method of the transform</p> <details class=quote> <summary>Source code in <code>albumentations/augmentations/geometric/transforms.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=k>def</span> <span class=nf>get_transform_init_args_names</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[()]:</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=k>return</span> <span class=p>()</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h2 class="doc doc-heading" data-toc-label=VerticalFlip id=albumentations.augmentations.geometric.transforms.VerticalFlip> <code>class <strong> VerticalFlip</strong></code> <code> </code> <span class=doc-github-link> <a href=https://github.com/albumentations-team/albumentations/blob/main/albumentations/augmentations/geometric/transforms.py#L1552 target=_blank>[view source on GitHub]</a> </span><a class=headerlink href=#albumentations.augmentations.geometric.transforms.VerticalFlip title="Permanent link">¶</a> </h2> <div class=class-signature> </div> <div class="doc doc-contents"> <p>Flip the input vertically around the x-axis.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>p</code></td> <td><code>float</code></td> <td><p>probability of applying the transform. Default: 0.5.</p></td> </tr> </tbody> </table> <div class="admonition targets"> <p class=admonition-title>Targets</p> <p>image, mask, bboxes, keypoints</p> </div> <p>Image types: uint8, float32</p> <div class="admonition info"> <p class=admonition-title><strong>Interactive Tool Available!</strong></p> <p> <strong>Explore this transform visually and adjust parameters interactively using this tool:</strong> </p> <p> <a class="md-button md-button--primary" href="https://huggingface.co/spaces/qubvel-hf/albumentations-demo?transform=VerticalFlip" target=_blank>Open Tool</a> </p> </div> <details class=quote> <summary>Source code in <code>albumentations/augmentations/geometric/transforms.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1></a><a href=#__codelineno-0-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>class</span> <span class=nc>VerticalFlip</span><span class=p>(</span><span class=n>DualTransform</span><span class=p>):</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2></a><a href=#__codelineno-0-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>    </span><span class=sd>"""Flip the input vertically around the x-axis.</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3></a><a href=#__codelineno-0-3><span class=linenos data-linenos=" 3 "></span></a>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4></a><a href=#__codelineno-0-4><span class=linenos data-linenos=" 4 "></span></a><span class=sd>    Args:</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5></a><a href=#__codelineno-0-5><span class=linenos data-linenos=" 5 "></span></a><span class=sd>        p (float): probability of applying the transform. Default: 0.5.</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6></a><a href=#__codelineno-0-6><span class=linenos data-linenos=" 6 "></span></a>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7></a><a href=#__codelineno-0-7><span class=linenos data-linenos=" 7 "></span></a><span class=sd>    Targets:</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8></a><a href=#__codelineno-0-8><span class=linenos data-linenos=" 8 "></span></a><span class=sd>        image, mask, bboxes, keypoints</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9></a><a href=#__codelineno-0-9><span class=linenos data-linenos=" 9 "></span></a>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10></a><a href=#__codelineno-0-10><span class=linenos data-linenos="10 "></span></a><span class=sd>    Image types:</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11></a><a href=#__codelineno-0-11><span class=linenos data-linenos="11 "></span></a><span class=sd>        uint8, float32</span>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12></a><a href=#__codelineno-0-12><span class=linenos data-linenos="12 "></span></a>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13></a><a href=#__codelineno-0-13><span class=linenos data-linenos="13 "></span></a><span class=sd>    """</span>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14></a><a href=#__codelineno-0-14><span class=linenos data-linenos="14 "></span></a>
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15></a><a href=#__codelineno-0-15><span class=linenos data-linenos="15 "></span></a>    <span class=n>_targets</span> <span class=o>=</span> <span class=p>(</span><span class=n>Targets</span><span class=o>.</span><span class=n>IMAGE</span><span class=p>,</span> <span class=n>Targets</span><span class=o>.</span><span class=n>MASK</span><span class=p>,</span> <span class=n>Targets</span><span class=o>.</span><span class=n>BBOXES</span><span class=p>,</span> <span class=n>Targets</span><span class=o>.</span><span class=n>KEYPOINTS</span><span class=p>)</span>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16></a><a href=#__codelineno-0-16><span class=linenos data-linenos="16 "></span></a>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17></a><a href=#__codelineno-0-17><span class=linenos data-linenos="17 "></span></a>    <span class=k>def</span> <span class=nf>apply</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>img</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18></a><a href=#__codelineno-0-18><span class=linenos data-linenos="18 "></span></a>        <span class=k>return</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>vflip</span><span class=p>(</span><span class=n>img</span><span class=p>)</span>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19></a><a href=#__codelineno-0-19><span class=linenos data-linenos="19 "></span></a>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20></a><a href=#__codelineno-0-20><span class=linenos data-linenos="20 "></span></a>    <span class=k>def</span> <span class=nf>apply_to_bbox</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>bbox</span><span class=p>:</span> <span class=n>BoxInternalType</span><span class=p>,</span> <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>BoxInternalType</span><span class=p>:</span>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21></a><a href=#__codelineno-0-21><span class=linenos data-linenos="21 "></span></a>        <span class=k>return</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>bbox_vflip</span><span class=p>(</span><span class=n>bbox</span><span class=p>,</span> <span class=o>**</span><span class=n>params</span><span class=p>)</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22></a><a href=#__codelineno-0-22><span class=linenos data-linenos="22 "></span></a>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23></a><a href=#__codelineno-0-23><span class=linenos data-linenos="23 "></span></a>    <span class=k>def</span> <span class=nf>apply_to_keypoint</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>keypoint</span><span class=p>:</span> <span class=n>KeypointInternalType</span><span class=p>,</span> <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>KeypointInternalType</span><span class=p>:</span>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a><a href=#__codelineno-0-24><span class=linenos data-linenos="24 "></span></a>        <span class=k>return</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>keypoint_vflip</span><span class=p>(</span><span class=n>keypoint</span><span class=p>,</span> <span class=o>**</span><span class=n>params</span><span class=p>)</span>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a><a href=#__codelineno-0-25><span class=linenos data-linenos="25 "></span></a>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a><a href=#__codelineno-0-26><span class=linenos data-linenos="26 "></span></a>    <span class=k>def</span> <span class=nf>get_transform_init_args_names</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[()]:</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a><a href=#__codelineno-0-27><span class=linenos data-linenos="27 "></span></a>        <span class=k>return</span> <span class=p>()</span>
</span></code></pre></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-method"> <h3 class="doc doc-heading" id=albumentations.augmentations.geometric.transforms.VerticalFlip.apply> <code class="highlight language-python"><span class=n>apply</span> <span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>img</span><span class=p>,</span> <span class=o>**</span><span class=n>params</span><span class=p>)</span></code> <a class=headerlink href=#albumentations.augmentations.geometric.transforms.VerticalFlip.apply title="Permanent link">¶</a></h3> <div class="doc doc-contents"> <p>Apply transform on image.</p> <details class=quote> <summary>Source code in <code>albumentations/augmentations/geometric/transforms.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=k>def</span> <span class=nf>apply</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>img</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=k>return</span> <span class=n>fgeometric</span><span class=o>.</span><span class=n>vflip</span><span class=p>(</span><span class=n>img</span><span class=p>)</span>
</span></code></pre></div> </details> </div> </div> <div class="doc doc-object doc-method"> <h3 class="doc doc-heading" id=albumentations.augmentations.geometric.transforms.VerticalFlip.get_transform_init_args_names> <code class="highlight language-python"><span class=n>get_transform_init_args_names</span> <span class=p>(</span><span class=bp>self</span><span class=p>)</span></code> <a class=headerlink href=#albumentations.augmentations.geometric.transforms.VerticalFlip.get_transform_init_args_names title="Permanent link">¶</a></h3> <div class="doc doc-contents"> <p>Returns names of arguments that are used in <strong>init</strong> method of the transform</p> <details class=quote> <summary>Source code in <code>albumentations/augmentations/geometric/transforms.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=k>def</span> <span class=nf>get_transform_init_args_names</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[()]:</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=k>return</span> <span class=p>()</span>
</span></code></pre></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../rotate/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Rotation transforms (augmentations.geometric.functional)"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> Rotation transforms (augmentations.geometric.functional) </div> </div> </a> <a href=../../mixing/ class="md-footer__link md-footer__link--next" aria-label="Next: Index"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> Index </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> </div> <div class=md-social> <a href=https://twitter.com/albumentations target=_blank rel=noopener title=twitter.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9L389.2 48zm-24.8 373.8h39.1L151.1 88h-42l255.3 333.8z"/></svg> </a> <a href=https://www.linkedin.com/company/100504475/ target=_blank rel=noopener title=www.linkedin.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg> </a> <a href=https://discord.com/invite/AKPrrDYNAt target=_blank rel=noopener title=discord.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 640 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M524.531 69.836a1.5 1.5 0 0 0-.764-.7A485.065 485.065 0 0 0 404.081 32.03a1.816 1.816 0 0 0-1.923.91 337.461 337.461 0 0 0-14.9 30.6 447.848 447.848 0 0 0-134.426 0 309.541 309.541 0 0 0-15.135-30.6 1.89 1.89 0 0 0-1.924-.91 483.689 483.689 0 0 0-119.688 37.107 1.712 1.712 0 0 0-.788.676C39.068 183.651 18.186 294.69 28.43 404.354a2.016 2.016 0 0 0 .765 1.375 487.666 487.666 0 0 0 146.825 74.189 1.9 1.9 0 0 0 2.063-.676A348.2 348.2 0 0 0 208.12 430.4a1.86 1.86 0 0 0-1.019-2.588 321.173 321.173 0 0 1-45.868-21.853 1.885 1.885 0 0 1-.185-3.126 251.047 251.047 0 0 0 9.109-7.137 1.819 1.819 0 0 1 1.9-.256c96.229 43.917 200.41 43.917 295.5 0a1.812 1.812 0 0 1 1.924.233 234.533 234.533 0 0 0 9.132 7.16 1.884 1.884 0 0 1-.162 3.126 301.407 301.407 0 0 1-45.89 21.83 1.875 1.875 0 0 0-1 2.611 391.055 391.055 0 0 0 30.014 48.815 1.864 1.864 0 0 0 2.063.7A486.048 486.048 0 0 0 610.7 405.729a1.882 1.882 0 0 0 .765-1.352c12.264-126.783-20.532-236.912-86.934-334.541ZM222.491 337.58c-28.972 0-52.844-26.587-52.844-59.239s23.409-59.241 52.844-59.241c29.665 0 53.306 26.82 52.843 59.239 0 32.654-23.41 59.241-52.843 59.241Zm195.38 0c-28.971 0-52.843-26.587-52.843-59.239s23.409-59.241 52.843-59.241c29.667 0 53.307 26.82 52.844 59.239 0 32.654-23.177 59.241-52.844 59.241Z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <script id=__config type=application/json>{"base": "../../../..", "features": ["navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.instant.preview", "navigation.sections", "navigation.path", "navigation.prune", "navigation.expand", "navigation.indexes", "navigation.footer", "navigation.top", "search.suggest", "search.highlight", "search.share", "toc.follow", "toc.integrate", "announce.dismiss"], "search": "../../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../../../../assets/javascripts/bundle.ad660dcc.min.js></script> <script src=https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/MathJax.js?config=TeX-MML-AM_CHTML"></script> <script src=../../../../js/extra.js></script> </body> </html>