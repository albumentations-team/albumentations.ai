services:
  website:
    container_name: website
    build:
      context: .
      dockerfile: ./website/Dockerfile
      target: builder
      args:
        - GOOGLE_ANALYTICS_ID=${GOOGLE_ANALYTICS_ID}
        - GITHUB_TOKEN=${GITHUB_TOKEN}
    volumes:
       - ./website/build:/website/build


  docs:
    container_name: docs
    build:
      context: .
      dockerfile: ./docs/Dockerfile
    ports:
      - "127.0.0.1:${MKDOCS_PORT}:8000"
    tty: true
    environment:
      - GOOGLE_ANALYTICS_ID=${GOOGLE_ANALYTICS_ID}
      - CONFIG_FILE=/docs/src/mkdocs.yml
    command:
      serve --dev-addr 0.0.0.0:8000
    volumes:
      - ./_build:/_build
      - ./_cache:/_cache


volumes:
  _build:
    driver: local
  _cache:
    driver: local
